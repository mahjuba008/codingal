;/*FB_PKG_DELIM*/

__d("ArmadilloCutoverClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("699");b=d("FalcoLoggerInternal").create("armadillo_cutover_client",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupdDYIFileSaver",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("file-saver").__setRef("EncryptedBackupdDYIFileSaver");function a(a,b){h.onReadyImmediately(function(c){c=c.saveAs;c(b,a)})}g.saveFile=a}),98);
__d("KeyframesPerformanceLog",["performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i=60;a=function(){function a(a,b){this.$1=0,this.$2=-1,this.$3=-1,this.$6=a,this.$5=b,this.$6=a,this.reset()}var b=a.prototype;b.onNextFrame=function(a){this.$7=a};b.start=function(){if(this.$2<0||this.$3>=0){var a=(h||(h=c("performanceNow")))();this.$2<0?this.$2=a:this.$3>=0&&(this.$2+=a-this.$3,this.$3=-1);this.$5&&this.$5("start")}};b.pause=function(){this.$3<0&&this.$2>=0&&(this.$3=(h||(h=c("performanceNow")))(),this.$5&&this.$5("pause"))};b.reset=function(){this.$1=0,this.$4={one:0,two:0,four:0,eight:0},this.$3=-1,this.$2=-1};b.addFrame=function(){this.$1+=1,this.$7&&(this.$7(),this.$7=null)};b.addFrameDrop=function(a){a>=8?this.$4.eight+=1:a>=4?this.$4.four+=1:a>=2?this.$4.two+=1:a>=1&&(this.$4.one+=1)};b.finish=function(){if(this.$2>=0){var a=(h||(h=c("performanceNow")))(),b=this.$3>=0?a-this.$3:0;a=Math.max(Math.floor(a-this.$2-b),1);b=this.$1?this.$1/a*1e3:i;this.$6({animation_duration:a,display_refresh_rate:i,eight_frame_drop_count:this.$4.eight,four_frame_drop_count:this.$4.four,frame_rate:b,one_frame_drop_count:this.$4.one,two_frame_drop_count:this.$4.two});this.reset()}};return a}();g["default"]=a}),98);
__d("KeyframesPluginsLoader",["Bootloader","KeyframesPluginLogger","Promise","flatbuffers"],(function(a,b,c,d,e,f,g){"use strict";var h,i={DynamicProperties:function(a){return c("Bootloader").loadModules(["KeyframesPluginDynamicProperties","KeyframesPluginDynamicPropertiesSchema"],a,"KeyframesPluginsLoader")},LayerName:function(a){return c("Bootloader").loadModules(["KeyframesPluginLayerName","KeyframesPluginLayerNameSchema"],a,"KeyframesPluginsLoader")},LayerTags:function(a){return c("Bootloader").loadModules(["KeyframesPluginLayerTags","KeyframesPluginLayerTagsSchema"],a,"KeyframesPluginsLoader")},RandomSubdocument:function(a){return c("Bootloader").loadModules(["KeyframesPluginRandomSubdocument","KeyframesPluginRandomSubdocumentSchema"],a,"KeyframesPluginsLoader")},Sound:function(a){return c("Bootloader").loadModules(["KeyframesPluginSound","KeyframesPluginSoundSchema"],a,"KeyframesPluginsLoader")},SubdocumentSwap:function(a){return c("Bootloader").loadModules(["KeyframesPluginSubdocumentSwap","KeyframesPluginSubdocumentSwapSchema"],a,"KeyframesPluginsLoader")},TrimPath:function(a){return c("Bootloader").loadModules(["KeyframesPluginTrimPath","KeyframesPluginTrimPathSchema"],a,"KeyframesPluginsLoader")}};function j(a,b){return i[a]?i[a](b):null}function k(a){a=a.map(function(a){return new(h||(h=b("Promise")))(function(b,c){var d=j(a,function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];b(c)});d||c("Unknown plugin "+a)})});return(h||(h=b("Promise"))).all(a)}a=function(){a.fromPluginTable=function(b){d("KeyframesPluginLogger").KeyframesPluginLogger.log(b);return k(b).then(function(c){return new a(b,c)})};a.getSupportedPlugins=function(){return i};function a(a,b){this.instances=[],this.$1={},this.$2={},this.$4=a,this.$3=b}var b=a.prototype;b.getPluginTable=function(){return this.$4};b.getPluginsForLayer=function(a){return this.$1[a]};b.maybeInstantiatePluginsForLayer=function(a){var b=a.id();if(!this.$2[b]){var c=a.pluginsLength();if(c)for(var e=0;e<c;e++){var f=a.plugins(e),g=new(d("flatbuffers").ByteBuffer)(f.contentArray());f=f.index();if(this.$3[f]){var h=this.$3[f],i=h[0];h=h[1];f="getRootAsPlugin"+this.$4[f];h=h[f](g);f=new i(h,a);this.$1[b]||(this.$1[b]=[]);this.$1[b].push(f);this.instances.push(f);f.animationDidLoad()}}this.$2[b]=!0}};return a}();g["default"]=a}),98);
__d("KeyframesVersion",[],(function(a,b,c,d,e,f){"use strict";var g="2.0.0";function a(){return g}f.getCurrentVersion=a}),66);
__d("FBKeyframesLoggedSession",["BanzaiLogger","CurrentUser","FunnelLogger","KeyframesPerformanceLog","KeyframesPluginsLoader","KeyframesVersion","once","performanceNow","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;a=!1;var i="KEYFRAMES_FUNNEL",j="KeyframesFramePerfLoggerConfig",k=2,l=9e18,m={appid:256281040558,appversion:null,connection_class:null,country:null,deviceid:null,extras:null,isemployee:c("CurrentUser").isEmployee()?1:0,name:"keyframes_frame_perf_report",vc:null,year_class:null};function n(a){return parseInt(a.match(/[a-f0-9]+$/gi),16)}function o(){var a=(h||(h=c("performanceNow")))();return function(){return Math.floor((h||(h=c("performanceNow")))()-a)}}function p(){return{value:Date.now()}}b=function(){function a(b,e){var f=this;this.$2=!1;this.$3=0;this.$5=1;this.$11=d("KeyframesVersion").getCurrentVersion();this.$15=function(b){f.$13("play_ended");f.$3++;if(f.$3===f.$5){b=babelHelpers["extends"]({},b,m,{animation_duration:String(b.animation_duration),asset_id:f.$6.assetID||null,asset_name:f.$6.assetID?null:f.$6.assetName,display_refresh_rate:String(b.display_refresh_rate),keyframes_version:f.$11,project_name:f.$6.projectName,session_id:f.$9});a.performanceLoggingMethod(b);f.$5<l&&(f.$5*=k)}};this.$16=function(a){switch(a){case"start":f.$13("play_started");return;case"pause":f.$13("play_ended");return}};this.$10=e||p();this.$6=b;this.$9=c("uuidv4")();this.$4=n(this.$9)}a.performanceLoggingMethod=function(a){c("BanzaiLogger").log(j,a)};var b=a.prototype;b.startDecode=function(a){var b=this;if(!this.$1){this.$12();this.$13("asset_decode_started",a);var d=o();this.$1=c("once")(function(a,c){b.$13("asset_decode_ended",a,{"time_since:asset_decode_started":d(),plugins_decoded:c||[]})})}return this.$1};b.error=function(a){this.$12(),this.$1?this.$14("asset_decode_failed",a):this.$14("asset_request_failed",a)};b.getUUID=function(){return this.$9};b.getInstanceID=function(){return this.$4};b.getPerformanceLogIfEnabled=function(){var a=this;if(!this.$7){var b=this.$12(),d=new(c("KeyframesPerformanceLog"))(this.$15,this.$16);d.onNextFrame(function(){return a.$13("first_frame_rendered",p(),{"time_since:session_started":b()})});this.$7=d}return this.$7};b.$12=function(){this.$8||(d("FunnelLogger").startFunnelAtTime(i,this.$10.value,this.$4),this.$13("session_started",this.$10,{supported_plugins:Object.keys(c("KeyframesPluginsLoader").getSupportedPlugins())}),this.$8=o());return this.$8};b.$13=function(a,b,c){b=b||p(),this.$2||d("FunnelLogger").appendActionAtTimeWithPayload(i,b.value,this.$4,a,babelHelpers["extends"]({},this.$17(),c))};b.$14=function(a,b){b=b||p(),this.$2||(this.$13("session_failed",b,{fail_reason:a}),d("FunnelLogger").endFunnelAtTime(i,b.value,this.$4),this.$2=!0)};b.$17=function(){return{asset_id:this.$6.assetID||null,asset_name:this.$6.assetID?null:this.$6.assetName,asset_source:"network",keyframes_version:this.$11,project_name:this.$6.projectName,session_id:this.$9}};return a}();g["default"]=b}),98);
__d("FDSMenuItemCheckbox.react",["ix","FDSIcon.react","FDSMenuItemBase.react","FDSMenuItemIcon.react","FDSSwitch.react","UNTRANSLATED_STRING_FIXME","fbicon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k={"switch":{marginBottom:"x4vbgl9",$$css:!0}};b=j.forwardRef(a);function a(a,b){var e=d("react-compiler-runtime").c(28),f;e[0]!==a?(f=babelHelpers["extends"]({},a),e[0]=a,e[1]=f):f=e[1];if(e[2]!==f){a=f;a.asSwitch;var g=a.disabled,i=a.icon,l=a.iconColor,m=a.iconSize,n=a.iconStyle,o=a.isSelected,p=a.radioStyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["asSwitch","disabled","icon","iconColor","iconSize","iconStyle","isSelected","radioStyle"]);g=g;i=i;l=l;m=m;n=n;o=o;p=p;a=a;e[2]=f;e[3]=a;e[4]=g;e[5]=i;e[6]=l;e[7]=m;e[8]=n;e[9]=o;e[10]=p}else a=e[3],g=e[4],i=e[5],l=e[6],m=e[7],n=e[8],o=e[9],p=e[10];p===void 0?"default":p;e[11]!==g||e[12]!==o||e[13]!==f.asSwitch||e[14]!==f.primaryText?(p=f.asSwitch===!0?j.jsx(c("FDSSwitch.react"),{"aria-label":c("UNTRANSLATED_STRING_FIXME")(f.primaryText.toString()),size:"small",value:o,xstyle:k["switch"]}):o?j.jsx(c("FDSIcon.react"),{color:g===!0?"disabled":"highlight",icon:d("fbicon")._(h("531032"),24)}):j.jsx(c("FDSIcon.react"),{color:g===!0?"disabled":"secondary",icon:d("fbicon")._(h("659289"),24)}),e[11]=g,e[12]=o,e[13]=f.asSwitch,e[14]=f.primaryText,e[15]=p):p=e[15];f=p;e[16]!==i||e[17]!==l||e[18]!==m||e[19]!==n?(p=i!=null?j.jsx(c("FDSMenuItemIcon.react"),{icon:i,iconColor:l,iconSize:m,use:n}):void 0,e[16]=i,e[17]=l,e[18]=m,e[19]=n,e[20]=p):p=e[20];e[21]!==f||e[22]!==a||e[23]!==g||e[24]!==o||e[25]!==b||e[26]!==p?(i=j.jsx(c("FDSMenuItemBase.react"),babelHelpers["extends"]({},a,{"aria-checked":o,aux:f,disabled:g,iconNode:p,ref:b,role:"menuitemcheckbox"})),e[21]=f,e[22]=a,e[23]=g,e[24]=o,e[25]=b,e[26]=p,e[27]=i):i=e[27];return i}e=b;g["default"]=e}),98);
__d("KeyframesVideoUtils",["Promise"],(function(a,b,c,d,e,f){"use strict";var g,h=window.setTimeout,i=4;function a(a){var b=document.createElement("video");b.setAttribute("webkit-playsinline","");b.setAttribute("playsinline","");b.autoplay=!1;b.src=a;b.currentTime=0;a.startsWith("blob:")||(b.crossOrigin="anonymous");return b}function c(a,c){return new(g||(g=b("Promise")))(function(b,d){var e=function b(){a.pause(),a.currentTime=c,a.removeEventListener("canplaythrough",b),f()},f=function c(){a.readyState===i?b(a):h(c,10)},g=function b(c){a.removeEventListener("error",b),d(c)};a.currentTime=c;a.addEventListener("error",g);a.readyState===i?b(a):a.addEventListener("canplaythrough",e)})}f.createVideo=a;f.loadVideo=c}),66);
__d("KeyframesAssetDecoder",["BlobFactory","KeyframesPluginsLoader","KeyframesSchema","KeyframesVideoUtils","Promise","flatbuffers","promiseDone","requestIdleCallback"],(function(a,b,c,d,e,f){"use strict";var g,h=b("KeyframesSchema").Document,i="medium",j=a.URL||a.webkitURL||{};function k(a){a=new(b("flatbuffers").ByteBuffer)(a);return h.bufferHasIdentifier(a)?h.getRootAsDocument(a):null}function l(a){return new(g||(g=b("Promise")))(function(b,c){var d=new Image();d.onload=function(){return b(d)};d.onerror=function(b){return c("Decode: error requesting image uri "+a)};d.src=a})}function m(a){a=b("KeyframesVideoUtils").createVideo(a);return b("KeyframesVideoUtils").loadVideo(a,0)}function n(b,c,d){return a.createImageBitmap&&!(b instanceof VideoFrame)?b.width<c||b.height<d?p(b,c,d).then(function(b){return a.createImageBitmap(b,0,0,c,d)["catch"](function(a){return b})}):a.createImageBitmap(b,0,0,b.width,b.height,{resizeWidth:c,resizeHeight:d,rezizeQuality:i})["catch"](function(a){return p(b,c,d)}):p(b,c,d)}function o(a,c,d){a.width=c;a.height=d;return(g||(g=b("Promise"))).resolve(a)}function p(a,c,d){return new(g||(g=b("Promise")))(function(b){var e=document.createElement("canvas");e.width=c;e.height=d;var f=e.getContext("2d");f.drawImage(a,0,0,c,d);b(e)})}function q(a,b){var c=[];for(var d=0;d<a.length;d++){var e=a[d];if(e instanceof VideoFrame)continue;var f=b[d].size().width(),g=b[d].size().height();if(f!==e.width||g!==e.height){var h=document.createElement("canvas");h.width=f;h.height=g;var i=h.getContext("2d");i.drawImage(e,0,0,f,g);c.push(h)}else c.push(e)}return c}function r(a,c,d){if(!j.createObjectURL)return(g||(g=b("Promise"))).reject("URL API not supported");var e=j.createObjectURL(a);c=l(e);b("promiseDone")(c,function(){return b("requestIdleCallback")(function(){return j.revokeObjectURL(e)})});return c}function s(c){if(b("BlobFactory").isSupported()){var d=c.contentArray();if(!d)return(g||(g=b("Promise"))).reject("Decode: tried to decode a null bitmap");var e=b("BlobFactory").getBlob([d]),f=c.size().width(),h=c.size().height();return a.createImageBitmap?a.createImageBitmap(e,0,0,f,h)["catch"](function(a){return r(e,f,h)}):r(e,f,h)}return(g||(g=b("Promise"))).reject("Decode: browser does not support bitmap creation")}function t(a){if(b("BlobFactory").isSupported()){var c=a.size();a=a.contentArray();if(!a)return(g||(g=b("Promise"))).reject("Decode: tried to decode a null video");a=b("BlobFactory").getBlob([a]);if(!j.createObjectURL)return(g||(g=b("Promise"))).reject("URL API not supported");var d=j.createObjectURL(a);a=m(d).then(function(a){return o(a,c.width(),c.height())});b("promiseDone")(a,function(){b("requestIdleCallback")(function(){return j.revokeObjectURL(d)})});return a}return(g||(g=b("Promise"))).reject("Decode: browser does not support video creation")}function u(a){var b=[];for(var c=a.pluginsLength()-1;c>=0;c--)b.unshift(a.plugins(c));return b.length?b:null}function v(a){var b=[];for(var c=a.bitmapsLength()-1;c>=0;c--)b.unshift(a.bitmaps(c));return b}function w(a){var b=[];for(var c=a.videosLength()-1;c>=0;c--)b.unshift(a.videos(c));return b}function x(a){var b={};for(var c=0;c<a.length;c++){var d=a[c].name();d&&(b[d]={index:c,width:a[c].size().width(),height:a[c].size().height()})}return b}function y(a){var b={};for(var c=0;c<a.length;c++){var d=a[c].name();d&&(b[d]={index:c,width:a[c].size().width(),height:a[c].size().height()})}return b}function z(a){var b=[];for(var c,d=a.subdocumentsLength()-1;d>=0;d--)c=a.subdocuments(d),b.unshift(c);return b}function A(a){a=k(a);return!a?(g||(g=b("Promise"))).reject("Decode: could not create flatbuffer doc"):B(a)}function B(a){var c=v(a),d=y(c),e=w(a),f=x(e),h=c.filter(function(a){return a.contentLength()||!a.name()}).map(s);e=e.filter(function(a){return a.contentLength()||!a.name()}).map(t);var i=z(a).map(B),j=u(a);j=j?b("KeyframesPluginsLoader").fromPluginTable(j):(g||(g=b("Promise"))).resolve(null);return(g||(g=b("Promise"))).all([g.all(h),g.all(e),j,g.all(i)]).then(function(b){var e=b[0],g=b[1],h=b[2];b=b[3];return{bitmaps:q(e,c),bitmapNames:d,videos:g,videoNames:f,doc:a,pluginsLoader:h,subassets:b}})}function C(a){return!Uint8Array?(g||(g=b("Promise"))).reject("Decode: typed arrays not supported"):(g||(g=b("Promise"))).resolve(new Uint8Array(a))}function D(a,c,d){if(!a.bitmapNames[c]){var e=Object.keys(a.bitmapNames).join(",");return(g||(g=b("Promise"))).reject("Decode: missing replacement bitmap name "+c+", available names: "+e)}e=a.bitmapNames[c];var f=e.index;c=e.width;e=e.height;return n(d,c,e).then(function(b){a.bitmaps[f]=b})}function E(a,c,d){if(!a.videoNames[c]){var e=Object.keys(a.videoNames).join(",");return(g||(g=b("Promise"))).reject("Decode: missing replacement video name "+c+", available names: "+e)}e=a.videoNames[c];var f=e.index;c=e.width;e=e.height;return o(d,c,e).then(function(b){a.videos[f]=b})}function F(a){var b=babelHelpers["extends"]({},a);b.bitmaps=a.bitmaps.slice();return b}var G={awaitForMap:function(a,c){var d={},e=[],f=Object.entries(a);a=function(){var a=f[h],g=a[0];a=a[1];a=c(a,g);e.push(a);b("promiseDone")(a,function(a){return d[g]=a})};for(var h=0;h<f.length;h++)a();return(g||(g=b("Promise"))).all(e).then(function(){return d})},fromDocumentBytes:function(a){if(a instanceof ArrayBuffer)return C(a).then(A);else if(a instanceof Uint8Array)return A(a);return(g||(g=b("Promise"))).reject("Decode: unsupported byte container passed")},replaceBitmapsWithURIs:function(a,b){return G.awaitForMap(b,function(a){return l(a)}).then(function(b){return G.replaceBitmapsWithImageSources(a,b)})},replaceBitmapsWithImageSources:function(a,b){var c=F(a);return G.awaitForMap(b,function(a,b){return D(c,b,a)}).then(function(){return c})},replaceVideosWithURIs:function(a,b){return G.awaitForMap(b,m).then(function(b){return G.replaceVideosWithVideoSources(a,b)})},replaceVideosWithVideoSources:function(a,b){var c=F(a);return G.awaitForMap(b,function(a,b){return E(c,b,a)}).then(function(){return c})}};e.exports=G}),null);
__d("KeyframesCanvasPolyfills",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a.getTransform!==void 0)return;else a.currentTransform?a.getTransform=function(){var b=a.currentTransform;return{a:b.a,b:b.b,c:b.c,d:b.d,e:b.e,f:b.f}}:a.mozCurrentTransform!==void 0?a.getTransform=function(){var b=a.mozCurrentTransform;return{a:b[0],b:b[1],c:b[2],d:b[3],e:b[4],f:b[5]}}:a.getTransform=function(){return g}}var g={a:1,b:0,c:0,d:1,e:0,f:0};f.addGetTransformPolyfill=a}),66);
__d("KeyframesCanvasPool",["KeyframesCanvasPolyfills","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.$4=function(a){a.canvas.width=b.$1.width.physical,a.canvas.height=b.$1.height.physical,a.canvas.style.width=b.$1.width.logical+"px",a.canvas.style.height=b.$1.height.logical+"px"};this.$1=a;this.$2=[];this.$3=[]}var b=a.prototype;b.getCanvas=function(){if(this.$2.length){var a=this.$2.pop();this.$3.push(a);return a}else{a=document.createElement("canvas");var b=c("nullthrows")(a.getContext("2d"));d("KeyframesCanvasPolyfills").addGetTransformPolyfill(b);a={canvas:a,ctx:b};this.$4(a);this.$3.push(a);return a}};b.clearAllAllocated=function(){var a=this;this.$3.forEach(function(b){b=b.ctx;b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,Math.max(a.$1.width.physical,a.$1.width.intrinsic),Math.max(a.$1.height.physical,a.$1.height.intrinsic))})};b.freeAll=function(){this.$2=[].concat(this.$3,this.$2),this.$3=[]};b.resizeAll=function(){this.$2.forEach(this.$4,this),this.$3.forEach(this.$4,this)};return a}();g["default"]=a}),98);
__d("KeyframesDimensions",["invariant","cr:2680"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("cr:2680").get(),j=function(){function a(a){this.overridden=!1,this.intrinsic=a,this.$1(a)}var b=a.prototype;b.$1=function(a){this.logical=a,this.physical=Math.floor(this.logical*i)};b.scale=function(a,b){this.overridden&&h(0,1136),this.$1(a*b)};b.override=function(a){this.overridden=!0,this.$1(a)};b.reset=function(){this.overridden=!1,this.$1(this.intrinsic)};b.getPhysicalChangeRatio=function(){return this.physical/this.intrinsic};return a}();a=function(){function a(a,b){this.ratio=b?a/b:0,this.width=new j(a),this.height=new j(b)}var b=a.prototype;b.setWidth=function(a){this.width.override(a),this.height.overridden||this.height.scale(a,this.ratio?1/this.ratio:0)};b.setHeight=function(a){this.height.override(a),this.width.overridden||this.width.scale(a,this.ratio)};b.reset=function(){this.height.reset(),this.width.reset()};return a}();g["default"]=a}),98);
__d("KeyframesLoop",["Run","TimeSlice","emptyFunction","gkx","performanceNow","requestAnimationFramePolyfill"],(function(a,b,c,d,e,f,g){"use strict";var h,i=1e3,j=new Set();function k(a){var b=(h||(h=c("performanceNow")))();a.callback(Math.min(b-(a.previousTime||b),i));a.previousTime=b;a.framesRemaining-=1;a.framesRemaining<=0&&a.cancel()}function l(a){j.size>0&&(j.forEach(k),c("requestAnimationFramePolyfill")(l))}c("gkx")("20935")||d("Run").onLeave(function(){j.forEach(function(a){return a.cancel()})});window.addEventListener("focus",function(){j.forEach(function(a){return a.previousTime=(h||(h=c("performanceNow")))()-16.67})});a=function(){function a(a){this.framesRemaining=Infinity,this.callback=a,this.previousTime=0}var b=a.prototype;b.start=function(a){a===void 0&&(a=Infinity),this.framesRemaining=a,this.$1||(j.size===0&&c("requestAnimationFramePolyfill")(l),j.add(this),this.previousTime=(h||(h=c("performanceNow")))(),this.$1=c("TimeSlice").getGuardedContinuation("KeyframesLoop"))};b.cancel=function(){this.$1&&(this.$1(c("emptyFunction")),this.$1=null,j["delete"](this))};b.isRunning=function(){return!!this.$1};return a}();g["default"]=a}),98);
__d("KeyframesVideoManager",["KeyframesVideoUtils","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g,h=.2,i=100,j=[.85,1.15];e.exports=function(){function a(a){this.$1=a,this.$3=1/a.doc.frameRate(),this.$2=m(a.doc.rootLayer(),a),this.$4=this.$5()}var c=a.prototype;c.getVideos=function(){return this.$1.videos};c.getTimeWindows=function(){return this.$2};c.forEach=function(a){this.getVideos().forEach(a)};c.pause=function(){this.forEach(function(a){a.pause()})};c.mute=function(){this.forEach(function(a){a.muted=!0})};c.unMute=function(){this.forEach(function(a){a.muted=!1})};c.renderProgress=function(a){var b=this;this.$2.forEach(function(c,d){var e=c.video,f=l(c,a),g=k(c,a);g=b.$1.doc.duration()*g;var i=Math.abs(g-e.currentTime);c=b.$1.doc.duration()*(c.toProgress-c.fromProgress);if(i>h&&e.currentTime<c&&g<c){i=(c-e.currentTime)/(c-g);i>=j[0]&&i<=j[1]&&b.changeVideoPlaybackRate(d,i)}f&&e.paused?e.play():f==!1&&e.paused==!1&&(e.pause(),e.currentTime=0)})};c.$5=function(){return this.$2.map(function(a){var b=a.video;return o(function(a){b.playbackRate=a},i,!0)})};c.changeVideoPlaybackRate=function(a,b){this.$4[a](b)};c.seekToProgress=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this,d=this.$2.map(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d){var e=d.video,f=0;if(l(d,a)){d=k(d,a);f=n(c.$1.doc.duration()*d)}e.pause();e.currentTime=f;yield b("KeyframesVideoUtils").loadVideo(e,f)});return function(a){return d.apply(this,arguments)}}());yield (g||(g=b("Promise"))).all(d)});function c(b){return a.apply(this,arguments)}return c}();return a}();function k(a,b){return b-a.fromProgress}function l(a,b){return b>=a.fromProgress&&b<=a.toProgress}function m(a,b){var c=[],d=a.videoIndex();if(d!=-1){var e=b.videos[d];d=b.doc.videos(d);e!=null&&c.push({fromProgress:a.fromProgress(),toProgress:a.toProgress(),name:d!=null?d.name():null,video:e})}for(d=0;d<a.sublayersLength();d++)c=c.concat(m(a.sublayers(d),b));return c}function n(a){return Math.round(a*100)/100}function o(a,b,c){b===void 0&&(b=100);c===void 0&&(c=!1);var d;return function(){for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];var h=function(){d=null,c||a.apply(void 0,f)},i=c&&!d;clearTimeout(d);d=setTimeout(h,b);i&&a.apply(void 0,f)}}}),null);
__d("KeyframesRenderer",["invariant","ErrorGuard","KFLoaderUtils","KeyframesCanvasPolyfills","KeyframesCanvasPool","KeyframesCanvasUtils","KeyframesDimensions","KeyframesLoop","KeyframesTrackMattes","KeyframesTween","KeyframesVideoManager","Promise","asyncToGeneratorRuntime","gkx","nullthrows","performanceNow","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=1,n={ERROR_FRAMEDROP:"ERROR_FRAMEDROP"};a=60;var o=1e3/a,p=1,q="source-over";function r(a,b){return c("gkx")("21037")?(k||(k=c("ErrorGuard"))).guard(a,{name:b}):a}var s=function(){function a(a,b){b===void 0&&(b=100),this.$3=!1,this.$4=0,this.$1=a,this.$2=b}var b=a.prototype;b.callOrIgnoreThrottled=function(){if((l||(l=c("performanceNow")))()>=this.$4){for(var a=arguments.length,b=new Array(a),d=0;d<a;d++)b[d]=arguments[d];this.$5(b)}else this.$3=!0};b.callIfIgnored=function(){if(this.$3){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.$5(b)}};b.callImmediately=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.$5(b)};b.resetThrottling=function(){this.$4=0};b.$5=function(a){this.$3=!1,this.$4=(l||(l=c("performanceNow")))()+this.$2,this.$1.apply(null,a)};return a}();function t(a,b){if(a.pluginsLoader){a.pluginsLoader.instances.forEach(b);for(var c=a.subassets.length-1;0<=c;c--)t(a.subassets[c],b)}}function u(a,b,c,d){if(a.pluginsLoader){for(var e=a.pluginsLoader.instances.length-1;0<=e;e--)a.pluginsLoader.instances[e].animationWillRenderLayer(b,c,d);for(e=a.subassets.length-1;0<=e;e--)u(a.subassets[e],b,c,d)}}function v(a,b,c,d){a.save(),a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!0),a.closePath(),a.clip(),a.clearRect(b-d,c-d,d*2,d*2),a.restore()}function w(a,b,c,e){e=(j||(j=d("KeyframesTween"))).maybeTweenPoint2(a,b.rampStart());var f=j.maybeTweenPoint2(a,b.rampEnd()),g=b.colors(),h=b.positions();g&&h?(g=(j||(j=d("KeyframesTween"))).maybeTweenColorArray(a,g),h=j.maybeTweenScalarArray(a,h)):(g=[(j||(j=d("KeyframesTween"))).maybeTweenColor(a,b.colorStart()),j.maybeTweenColor(a,b.colorEnd())],h=[0,1]);if(b.type()===m){var i=b.highlightLength();i=i!==null?(j||(j=d("KeyframesTween"))).maybeTweenScalar(a,i):0;var k=b.highlightAngle();k=k!==null?(j||(j=d("KeyframesTween"))).maybeTweenScalar(a,b.highlightAngle()):0;a=e.x;b=e.y;var l=Math.sqrt(Math.pow(e.x-f.x,2)+Math.pow(e.y-f.y,2)),n=Math.acos((f.x-a)/l),o=a+l*i*Math.cos(n-k);n=b-l*i*Math.sin(n-k);k=0;i!==0&&(c.clip(),c.fillStyle=d("KeyframesCanvasUtils").getCanvasStyle(g[g.length-1]),c.fill(),v(c,a,b,l));i=c.createRadialGradient(o,n,k,a,b,l)}else i=c.createLinearGradient(e.x,e.y,f.x,f.y);for(o=0,n=g.length;o<n;o++)i.addColorStop(h[o],d("KeyframesCanvasUtils").getCanvasStyle(g[o]));return i}function x(a,b,e,f,g,h,i,k,l){l===void 0&&(l=p);if(i<Math.max(h.fromProgress(),0)||i>Math.min(h.toProgress(),1))return;try{k&&k.maybeInstantiatePluginsForLayer(h)}catch(a){}a=a;var m,n=h.isTrackMatte(),o=h.trackMatteType();if(n||o!==0){var r=a.getTransform();m=b.getCanvas();m.ctx.setTransform(r.a,r.b,r.c,r.d,r.e,r.f);m.isTrackMatte=n;m.trackMatteType=o;m.ctx.globalCompositeOperation=q;a=m.ctx}a.save();r=h.position();if(r){n=(j||(j=d("KeyframesTween"))).tweenPointOnPath(i,r);o=n.x;r=n.y;a.translate(o,r)}else{n=h.xPosition();n&&a.translate((j||(j=d("KeyframesTween"))).maybeTweenScalar(i,n),0);o=h.yPosition();o&&a.translate(0,(j||(j=d("KeyframesTween"))).maybeTweenScalar(i,o))}r=h.rotation();r&&a.rotate((j||(j=d("KeyframesTween"))).maybeTweenScalar(i,r));n=h.scale();if(n){o=(j||(j=d("KeyframesTween"))).maybeTweenPoint2(i,n);r=o.x;n=o.y;a.scale(r,n)}o=h.anchorPoint();if(o){r=(j||(j=d("KeyframesTween"))).maybeTweenPoint2(i,o);n=r.x;o=r.y;a.translate(-n,-o)}r=h.opacity();r=r!=null?(j||(j=d("KeyframesTween"))).maybeTweenScalar(i,r):1;a.globalAlpha=r*l;n=!1;if(k){o=k.getPluginsForLayer(h.id());if(o)for(var s=0;s<o.length;s++)o[s].render(a,i),n=n||o[s].rendersLayer}h.clippingPath()&&(d("KeyframesCanvasUtils").drawPath(a,(j||(j=d("KeyframesTween"))).maybeTweenPath(i,h.clippingPath())),a.clip());if(!n&&h.path()){d("KeyframesCanvasUtils").drawPath(a,(j||(j=d("KeyframesTween"))).maybeTweenPath(i,h.path()));s=h.gradient();o=h.fillColor();n=!1;var t=!1;s?(a.fillStyle=w(i,s,a),n=!0):o&&(a.fillStyle=d("KeyframesCanvasUtils").getCanvasStyle((j||(j=d("KeyframesTween"))).maybeTweenColor(i,o)),n=!0);if(h.strokeWidth()){s=(j||(j=d("KeyframesTween"))).maybeTweenScalar(i,h.strokeWidth());s>0&&(a.strokeStyle=d("KeyframesCanvasUtils").getCanvasStyle((j||(j=d("KeyframesTween"))).maybeTweenColor(i,h.strokeColor())),a.lineJoin=d("KeyframesCanvasUtils").LINE_JOINS[h.strokeLineJoin()],a.lineCap=d("KeyframesCanvasUtils").getCanvasLineCap(h.strokeLineCap()),a.lineWidth=s,t=!0)}h.vectorCompositeOrder()===0?(n&&a.fill(),t&&a.stroke()):(t&&a.stroke(),n&&a.fill())}o=h.bitmapIndex();s=e[o];s&&s.width!==0&&s.height!==0&&a.drawImage(s,0,0);t=h.videoIndex();n=f[t];n!=null&&a.drawImage(n,0,0,n.width,n.height);o=h.subdocumentIndex();if(g[o]){s=g[o].doc.size();a.save();a.beginPath();a.rect(0,0,s.width(),s.height());a.clip();x(a,b,g[o].bitmaps,g[o].videos,g[o].subassets,g[o].doc.rootLayer(),i-h.progressOffset(),g[o].pluginsLoader,r*l);a.restore()}var u;for(t=0;t<h.sublayersLength();t++){n=x(a,b,e,f,g,h.sublayers(t),i,k,r*l);if(!u&&n&&n.trackMatteType!==void 0)u=n;else if(u&&n&&n.isTrackMatte!==void 0){s=a.getTransform();a.setTransform(1,0,0,1,0,0);u.ctx.setTransform(1,0,0,1,0,0);o=n;u.ctx.globalCompositeOperation=c("KeyframesTrackMattes")[u.trackMatteType===void 0?1:u.trackMatteType];u.ctx.drawImage(o.canvas,0,0);a.drawImage(u.canvas,0,0);a.setTransform(s.a,s.b,s.c,s.d,s.e,s.f);u=void 0;o=void 0}else u&&!n?(a.drawImage(u.canvas,0,0),u=void 0,o=void 0):n&&n.isTrackMatte!==void 0&&(u=void 0,o=void 0)}a.restore();return m}e=function(){function a(a,e){var f=this;this.$5=0;this.$6=0;this.$8=!1;this.$9=!1;this.$10=!1;this.$11=0;this.$16=!1;this.$17=0;this.$18=1;this.$19=1;this.$21=1;this.$22=0;this.$26=function(a){(f.$12||f.$15)&&f.$34(a),!f.$16?f.redrawIfNeeded():(f.$10&&f.$32(),f.$24.renderProgress(f.$11),f.$33(f.$11),f.$11+=a/f.$5,f.$14&&f.$14.callOrIgnoreThrottled(f.$17),f.$11>=f.$21&&(f.$11%=f.$21,f.$19=Math.max(0,f.$19-1),f.$15&&f.$15.finish(),f.$19===0?f.pause():(f.$24.seekToProgress(0),f.$15&&f.$15.start(),f.$11+=f.$22),f.$13&&f.$13(f.$19),f.$30()))};this.$33=r(function(a){a>=0&&a<=1||h(0,750,a),this.$3.clearRect(0,0,this.$23.width.intrinsic,this.$23.height.intrinsic),this.$1.pluginsLoader&&u(this.$1,a,this.$16,this.$8),this.$4.clearAllAllocated(),this.$4.freeAll(),x(this.$3,this.$4,this.$1.bitmaps,this.$1.videos,this.$1.subassets,this.$20,a,this.$1.pluginsLoader),this.$17=a,this.$9=!1,this.$15&&this.$15.addFrame()},"KeyframesRenderer: _renderProgress()");this.$32=r(function(){this.$2.width=this.$23.width.physical,this.$2.height=this.$23.height.physical,this.$2.style.width=this.$23.width.logical+"px",this.$2.style.height=this.$23.height.logical+"px",this.$3.setTransform(1,0,0,1,0,0),this.$3.scale(this.$23.width.getPhysicalChangeRatio(),this.$23.height.getPhysicalChangeRatio()),this.$4.resizeAll(),this.$10=!1,this.$9=!0},"KeyframesRenderer: _resize()");this.$23=new(c("KeyframesDimensions"))(a.doc.size().width(),a.doc.size().height());this.$4=new(c("KeyframesCanvasPool"))(this.$23);this.$2=document.createElement("canvas");this.$3=c("nullthrows")(this.$2.getContext("2d"));d("KeyframesCanvasPolyfills").addGetTransformPolyfill(this.$3);this.$7=new(c("KeyframesLoop"))(this.$26);this.$15=e;this.$24=new(c("KeyframesVideoManager"))(a);this.setDecodedAsset(a);this.$27();this.$25=(i||(i=b("Promise"))).resolve()}var e=a.prototype;e.play=function(){this.$16||(this.$16=!0,this.isFinished()&&(this.$19=this.$18,this.$11=this.$22),this.$15&&this.$15.start(),this.$7.start());return this};e.pause=function(){this.$16&&(this.$16=!1,this.$15&&this.$15.pause(),this.$9?this.$28():(this.$7.cancel(),this.$14&&this.$14.callIfIgnored(this.$17)));this.$24.pause();this.$29(this.$24.seekToProgress(this.$17));u(this.$1,this.$17,this.$16,this.$8);return this};e.isPlaying=function(){return this.$16};e.isFinished=function(){return this.$19===0};e.isMuted=function(){return this.$8};e.mute=function(){this.$8=!0,this.$24.mute()};e.unMute=function(){this.$8=!1,this.$24.unMute()};e.repeatCount=function(a){this.$18=this.$19=Math.max(1,a);return this};e.repeatForever=function(){return this.repeatCount(Infinity)};e.getRepeatsRemaining=function(){return this.$19};e.seekToProgress=function(a){var b=this;a>=0&&a<=1||h(0,749,a);this.$14&&this.$14.resetThrottling();this.$17=this.$11=a;this.$29(this.$24.seekToProgress(a).then(function(){return b.$28()}));a===0&&this.$30();this.$28();return this};e.setStartAndEndAt=function(a,b){if(a>=b)throw new Error("Cannot set the start time before the end time.");else if(b<=a)throw new Error("Cannot set the end time before the start time.");this.$22=a;this.$21=b;return this};e.setStartAt=function(a){if(a>=this.$21)throw new Error("Cannot set the start time before the end time.");this.$22=a;return this};e.setEndAt=function(a){if(a<=this.$22)throw new Error("Cannot set the end time before the start time.");this.$21=a;return this};e.getDuration=function(){return this.$5};e.getFrameRate=function(){return this.$6};e.getIntrinsicSize=function(){return[this.$23.width.intrinsic,this.$23.height.intrinsic]};e.getWidth=function(){return this.$23.width.logical};e.getHeight=function(){return this.$23.height.logical};e.setWidth=function(a){this.$23.setWidth(a);this.$27();return this};e.setHeight=function(a){this.$23.setHeight(a);this.$27();return this};e.getDecodedAsset=function(){return babelHelpers["extends"]({},this.$1)};e.setDecodedAsset=function(a){this.$1=a;this.$5=c("KFLoaderUtils").getDocumentDuration(a.doc);this.$6=a.doc.frameRate();this.$20=a.doc.rootLayer();this.$24=new(c("KeyframesVideoManager"))(a);this.$28();this.$31();return this};e.resetDimensions=function(){this.$23.reset();this.$27();return this};e.onError=function(a){this.$12=a;return this};e.onRepeatEnd=function(a){this.$13=a;return this};e.onProgress=function(a,b){this.$14=a&&new s(a,b);return this};e.getProgress=function(){return this.$17};e.getElement=function(){return this.$2};e.hasPerformanceLogging=function(){return!!this.$15};e.redrawIfNeeded=function(){(this.$10||this.$9)&&(this.$10&&this.$32(),this.$9&&this.$33(this.$17),this.$14&&this.$14.callImmediately(this.$17));return this};e.waitForVideoUpdate=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this.$25});function c(){return a.apply(this,arguments)}return c}();e.$29=function(a){this.$25=a,c("promiseDone")(a)};e.$27=function(){this.$10=!0,this.$28()};e.$28=function(){this.$9=!0,this.$7.isRunning()||this.$7.start(1)};e.$31=function(){t(this.$1,function(a){return a.animationDidLoad()})};e.$30=function(){var a=this;t(this.$1,function(b){return b.animationWillRepeat(a.$11,a.$19)})};e.$34=function(a){a=Math.round(a/o-1);a>0&&(this.$15&&this.$15.addFrameDrop(a),this.$12&&this.$12(n.ERROR_FRAMEDROP,a))};return a}();f.exports=e}),34);
__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[0].set("tam_thread_subtype",c.i64.cast([0,0])),d[0].set("wa_jid",void 0),d[0].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[0].set("message_product_type",void 0),d[0].set("is_message_deletion",!1),d[0].set("is_unbump",a[3]),d[1]=d[0].get("thread_key"),c.storedProcedure(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),c.i64.cast([0,389]))},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[2].set("tam_thread_subtype",c.i64.cast([0,0])),d[2].set("wa_jid",void 0),d[2].set("message_ephemeral_duration_in_sec",c.i64.cast([0,0])),d[2].set("message_product_type",void 0),d[2].set("is_message_deletion",!1),d[2].set("is_unbump",a[3]),d[3]=d[2].get("thread_key"),d[4]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[3]),c.i64.cast([0,389]),d[4],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxBumpE2EEMetadataThreadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSBumpE2EEMetadataThreadStoredProcedure",["LSBumpE2EEMetadataThread","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBumpE2EEMetadataThread"),e.threadKey,e.serverAuthoritativeTimestampMs,e.bumpedByLocalDeviceSend,e.isUnbump);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSClearMessagePlaceholderRangeStoredProcedure",["LSClearMessagePlaceholderRange","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSClearMessagePlaceholderRange"),e.threadKey,e.messageId,e.maxTimestampMs);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSDataUseConsentState",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSET:0,CONSENTED:1,WITHDRAWN:2,NOT_APPLICABLE:3,SEEN:4});f["default"]=a}),66);
__d("LSEncryptedBackupsOnboardingDecision",[],(function(a,b,c,d,e,f){a=Object.freeze({FAILURE:-1,NO_DECISION_MADE:0,BACKUP_CREATED:1,STORE_ON_DEVICE_ONLY:2});f["default"]=a}),66);
__d("LSEncryptedBackupsVirtualDeviceType",[],(function(a,b,c,d,e,f){a=Object.freeze({OFFLINE:1,HSM:2,BLOCK_STORE:3,KEYCHAIN:5,ICLOUD_KVS:6,GOOGLE_DRIVE:7,CLOUDKIT:8,ICLOUD_DRIVE:9,PASSKEY:10,ICLOUD_KEYCHAIN:11,GOOGLE_ONE_AUTO_BACKUP:12,SECURITY_QUESTION_HSM:13,TRUSTED_CONTACT:14});f["default"]=a}),66);
__d("LSFetchAccountSyncedFields",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return d[0]=new c.Map(),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"fetch_account_synced_fields",c.i64.cast([0,160021]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAccountSettingsFetchAccountSyncedFieldsStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSFetchAccountSyncedFieldsStoredProcedure",["LSFetchAccountSyncedFields","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a){a=a.storedProcedure(c("LSFetchAccountSyncedFields"));return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSFetchBackupsMetadata",["LSAppendDataTraceAddon","LSFlushDataTrace.nop","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","gkx","justknobx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(a){return d.sequence([function(a){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] Beginning execution."),(c("gkx")("23657")||c("gkx")("26375"))&&c("justknobx")._("1101")?d.sequence([function(a){return d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,1478]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[9]=a[0],a})},function(a){return e[9]?e[10]=!0:e[10]=!1,e[10]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[12]="LSDataTraceMciTraceLog native op not supported",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",e[12]].join("")),e[11]=d.createArray(),void 0!==void 0?e[13]=(e[11].push(void 0),e[11]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",e[12],e[11],d.i64.cast([0,3]))):d.resolve()}])},function(a){return d.forEach(d.db.table(196).fetch(),function(a){return a["delete"]()})},function(a){return d.db.table(172).fetch([[[d.i64.cast([0,1])]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?e[7]=void 0:(b=a.item,e[7]=b.backupId)})},function(a){return d.i64.neq(e[7],void 0)?d.sequence([function(a){return d.forEach(d.filter(d.db.table(196).fetch([[[e[7]]]]),function(a){return d.i64.eq(a.backupId,e[7])&&d.i64.lt(a.authorityLevel,d.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return d.db.table(196).add({backupId:e[7],authorityLevel:d.i64.cast([0,20]),backupSize:d.i64.cast([0,0]),creationTime:d.i64.cast([0,0]),lastSyncTime:d.i64.cast([0,0])})},function(a){return e[9]=new d.Map(),e[9].set("trace_id",void 0),e[10]=d.toJSON(e[9]),d.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",d.i64.cast([0,50022]),e[10],d.i64.cast([0,0]),d.i64.cast([0,93]),d.i64.cast([0,0]),void 0,d.i64.cast([0,0])).then(function(a){return a=a,e[11]=a[0],a})}]):d.sequence([function(a){return e[9]="Backup is not initialized",e[9]!==void 0?d.sequence([function(a){return e[11]=["[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] ","",e[9]].join(""),function(a){d.logger(a).mustfix(a)}(e[11]),e[10]=d.createArray(),void 0!==void 0?e[12]=(e[10].push(void 0),e[10]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupsMetadataStoredProcedure",e[9],e[10],d.i64.cast([0,3]))},function(a){return d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),e[11],void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[14]=a[0],a})},function(a){return e[14]?e[15]=!0:e[15]=!1,e[15]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[17]="LSDataTraceMciTraceLog native op not supported",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",e[17]].join("")),e[16]=d.createArray(),void 0!==void 0?e[18]=(e[16].push(void 0),e[16]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",e[17],e[16],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[12]=a[0],a})},function(a){return e[12]?e[13]=!0:e[13]=!1,e[13]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[15]="LSDataTraceMciTraceLog native op not supported",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",e[15]].join("")),e[14]=d.createArray(),void 0!==void 0?e[16]=(e[14].push(void 0),e[14]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",e[15],e[14],d.i64.cast([0,3]))):d.resolve()}])}]):d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] ","",""].join(""),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[12]=a[0],a})},function(a){return e[12]?e[13]=!0:e[13]=!1,e[13]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[15]="LSDataTraceMciTraceLog native op not supported",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",e[15]].join("")),e[14]=d.createArray(),void 0!==void 0?e[16]=(e[14].push(void 0),e[14]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",e[15],e[14],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[10]=a[0],a})},function(a){return e[10]?e[11]=!0:e[11]=!1,e[11]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[13]="LSDataTraceMciTraceLog native op not supported",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",e[13]].join("")),e[12]=d.createArray(),void 0!==void 0?e[14]=(e[12].push(void 0),e[12]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",e[13],e[12],d.i64.cast([0,3]))):d.resolve()}])},function(a){return d.forEach(d.db.table(196).fetch(),function(a){return a["delete"]()})},function(a){return d.forEach(d.filter(d.db.table(196).fetch([[[d.i64.cast([-1,4294967295])]]]),function(a){return d.i64.eq(a.backupId,d.i64.cast([-1,4294967295]))&&d.i64.lt(a.authorityLevel,d.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(a){return d.db.table(196).add({backupId:d.i64.cast([-1,4294967295]),authorityLevel:d.i64.cast([0,80]),backupSize:d.i64.cast([-1,4294967295]),creationTime:d.i64.cast([-1,4294967295]),lastSyncTime:d.i64.cast([-1,4294967295])})}])}]):d.resolve(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] is_backup_metadata_enabled is disabled"))},function(a){return e[1]=d.i64.of_float(Date.now()),e[2]=d.i64.random(),e[4]="Finishing execution. Execution time: ",e[5]=d.i64.to_string(d.i64.sub(e[1],e[0])),e[6]=" ms",e[3]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsFetchBackupsMetadataStoredProcedure] ",e[3],e[4],e[3],e[5],e[3],e[6]].join("")),d.i64.eq(d.i64.mod_(e[2],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[7]=",",e[8]=d.createArray(),void 0!==void 0?e[9]=(e[8].push(void 0),e[8]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupsMetadataStoredProcedure",[e[4],e[7],e[5],e[7],e[6]].join(""),e[8],d.i64.cast([0,4]))):d.resolve()}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsFetchBackupsMetadataStoredProcedure";a.__tables__=["encrypted_backups_metadata","encrypted_backups"];d=a;g["default"]=d}),98);
__d("LSFetchBackupsMetadataStoredProcedure",["LSFetchBackupsMetadata","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){e===void 0&&(e={});a=a.storedProcedure(c("LSFetchBackupsMetadata"),e.traceId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSInsertNewMessageRangeStoredProcedure",["LSInsertNewMessageRange","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSInsertNewMessageRange"),e.threadKey,e.newMinTs,e.newMaxTs,e.newMinMid,e.newMaxMid,e.lowerOverlap,e.upperOverlap,e.hasMoreBefore,e.hasMoreAfter,e.requestedMessageId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSIssueThreadRemove",["LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][issueThreadRemove] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[15]=new c.Map(),d[15].set("error_msg","Expected a nonempty query result"),d[15].set("code",c.i64.cast([0,3])),d[15].set("src_line","MEBClientStateUtils.php:244 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[16]=c.createArray(),d[17]=(d[16].push(d[15]),d[16]),e=[void 0,d[16]],d[2]=e[0],d[3]=e[1],e):(b=a.item,d[15]=new c.Map(),d[15].set("backup_id",b.backupId),d[15].set("device_public_key_blob",b.devicePublicKeyBlob),d[15].set("device_private_key_blob",b.devicePrivateKeyBlob),d[15].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[15].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[15].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[15].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[15].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[15].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[15].set("orf_client_state_v2_blob",void 0),d[15].set("orf_v2_authority_level",void 0),d[15].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[15].set("device_id",b.deviceId),d[15].set("backup_tenancy",b.backupTenancy),d[15].set("encryption_version",b.encryptionVersion),d[15].set("revision_version",b.revisionVersion),d[15].set("initialize_restore_result",void 0),d[15].set("authority_level",b.authorityLevel),e=[d[15],void 0],d[2]=e[0],d[3]=e[1],e)})},function(e){return d[5]=new c.Map(),d[5].set("value",d[2]),d[5].set("errors",d[3]),d[6]=d[5].get("value"),d[6]!==void 0?c.sequence([function(e){return d[15]=d[6].get("backup_id"),d[16]=d[6].get("device_public_key_blob"),d[17]=d[6].get("device_private_key_blob"),d[18]=d[6].get("epoch_storage_public_key_blob"),d[19]=d[6].get("epoch_storage_private_key_blob"),d[20]=d[6].get("epoch_auth_public_key_blob"),d[21]=d[6].get("epoch_auth_private_key_blob"),d[22]=d[6].get("mailbox_root_key_blob"),d[23]=d[6].get("ocmf_client_state_blob"),d[24]=d[6].get("orf_client_state_v2_blob"),d[25]=d[6].get("orf_v2_authority_level"),d[26]=d[6].get("oblivious_validation_token_blob"),d[27]=d[6].get("device_id"),d[28]=d[6].get("backup_tenancy"),d[29]=d[6].get("encryption_version"),d[30]=d[6].get("revision_version"),d[31]=d[6].get("initialize_restore_result"),d[32]=d[6].get("authority_level"),c.i64.neq(d[27],void 0)?c.sequence([function(a){return d[35]=void 0,c.i64.neq(d[35],void 0)?c.resolve(d[36]=d[35]):c.sequence([function(a){return d[42]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[52]=(d[42].push(c.i64.cast([0,0])),d[42]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]?d[52]=(d[42].push(c.i64.cast([0,2])),d[42]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[52]=(d[42].push(c.i64.cast([0,3])),d[42]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]?d[52]=(d[42].push(c.i64.cast([0,4])),d[42]):0,d[47]=c.createArray(),d[48]=c.i64.of_int32(d[42].length),c.i64.gt(d[48],c.i64.cast([0,0]))?c.loopAsync(d[48],function(a){return d[52]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[42],d[52]).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[55]=(d[47].push(d[53]),d[47])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[52]=c.createArray(),d[53]=c.i64.of_int32(d[47].length),c.i64.gt(d[53],c.i64.cast([0,0]))?c.loopAsync(d[53],function(a){return d[55]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[47],d[55]).then(function(a){return a=a,d[56]=a[0],d[57]=a[1],a})},function(a){return d[58]=(d[52].push(c.i64.to_string(d[56])),d[52])}])}):c.resolve()},function(a){return d[54]=d[52].join(","),d[49]=d[54]}])},function(a){return d[47].some(function(a){return c.i64.eq(d[29],a)})?d[50]=d[29]:d[50]=void 0,c.i64.neq(d[50],void 0)?d[51]=d[50]:d[51]=void 0,d[36]=d[51]}])},function(e){return c.i64.neq(d[36],void 0)?d[37]=d[36]:d[37]=c.i64.cast([0,0]),c.i64.neq(d[28],void 0)?d[38]=d[28]:d[38]=c.i64.cast([0,1]),d[39]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["eb_upload",":",a[0]].join(""),c.i64.cast([0,50026]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,93]),void 0,c.i64.le(c.i64.cast([0,0]),c.i64.cast([0,0]))?c.i64.cast([0,0]):c.i64.add(d[39],c.i64.sub(c.i64.cast([0,0]),c.i64.mod_(d[39],c.i64.cast([0,0])))),c.i64.cast([0,0])).then(function(a){return a=a,d[40]=a[0],a})},function(b){return c.db.table(177).add({pk:void 0,pendingBackupTaskId:d[40],actionType:c.i64.cast([0,2]),contentType:c.i64.cast([0,2]),backupStatus:c.i64.cast([0,1]),listKey:a[0],uniqueKey:a[0],sortKey:a[1],persistentId:"",isInstamadillo:!1,lsTraceId:a[3],error:a[4]})},function(b){return c.i64.eq(c.i64.cast([0,2]),c.i64.cast([0,1]))?c.i64.eq(c.i64.cast([0,2]),c.i64.cast([0,1]))?(d[42]=c.createArray(),d[44]=(d[42].push("Successfully issued message backup task. act thread id = "),d[42]),d[44]=(d[42].push(a[0]),d[42]),d[44]=(d[42].push(", otid = "),d[42]),d[44]=(d[42].push(a[0]),d[42]),d[43]=d[42].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ","",d[43]].join("")),c.resolve()):(d[42]=c.createArray(),d[44]=(d[42].push("Successfully issued message remove task. act thread id = "),d[42]),d[44]=(d[42].push(a[0]),d[42]),d[44]=(d[42].push(", otid = "),d[42]),d[44]=(d[42].push(a[0]),d[42]),d[43]=d[42].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ","",d[43]].join("")),c.resolve()):(d[42]=c.createArray(),d[44]=(d[42].push("Successfully issued thread remove task. act thread id = "),d[42]),d[44]=(d[42].push(a[0]),d[42]),d[43]=d[42].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ","",d[43]].join("")),c.resolve())},function(a){return d[41]=new c.Map(),d[41].set("task_id",d[40]),a=[d[41],void 0],d[33]=a[0],d[34]=a[1],a}]):c.sequence([function(b){return d[35]=c.createArray(),d[38]=(d[35].push("Skipping thread remove since EB is disabled. act thread id = "),d[35]),d[38]=(d[35].push(a[0]),d[35]),d[36]=d[35].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ","",d[36]].join("")),c.resolve()},function(a){return d[37]=new c.Map(),d[37].set("error_code",c.i64.cast([0,24])),d[37].set("stored_procedure","LSEncryptedBackupsIssueThreadRemoveStoredProcedure"),d[37].set("error_message",""),a=[void 0,d[37]],d[33]=a[0],d[34]=a[1],a}])},function(a){return a=[d[33],d[34]],d[7]=a[0],d[8]=a[1],a}]):c.sequence([function(b){return d[15]=d[5].get("errors"),d[16]=d[5].get("errors"),d[17]=c.createArray(),d[20]=(d[17].push("Skipping thread remove since EB is disabled. act thread id = "),d[17]),d[20]=(d[17].push(a[0]),d[17]),d[18]=d[17].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ","",d[18]].join("")),c.resolve()},function(a){return d[19]=new c.Map(),d[19].set("error_code",c.i64.cast([0,1])),d[19].set("stored_procedure","LSEncryptedBackupsIssueThreadRemoveStoredProcedure"),d[19].set("error_message",""),a=[void 0,d[19]],d[7]=a[0],d[8]=a[1],a}])},function(a){return d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueThreadRemove] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"issueThreadRemove",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[7],d[8]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueThreadRemoveStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","pending_backups_context_v2"];e.exports=a}),null);
__d("LSIssueThreadRemoveStoredProcedure",["LSIssueThreadRemove","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueThreadRemove"),e.actThreadId,e.sortKey,e.source,e.traceId,e.error);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUpdateBackupsTableStoredProcedure",["LSSynchronousPromise","LSUpdateBackupsTable","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSUpdateBackupsTable"),e.isSuccess,e.backupIds,e.virtualDevices,e.deviceIds,e.backupMetadata,e.traceId,e.isUserOptedOut,e.hasOtcEligibleDevices,e.encryptionManagementDelegatorId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("user_self_remove",!1),d[1]=d[0].get("thread_key"),d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,394]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxUpdateE2EEMetadataParticipantsStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipantsStoredProcedure",["LSSynchronousPromise","LSUpdateE2EEMetadataParticipants","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSUpdateE2EEMetadataParticipants"),e.threadKey);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUpdateE2eeXmaPreviewSettings",["LSGetViewerFBID","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.forEach(c.db.table(288).fetch([[[d[0]]]]),function(b){var c=b.update;b.item;return c({e2eeXmaPreviewsDisabled:a[0]})})},function(e){return d[1]=new c.Map(),d[1].set("xma_previews_disabled",a[0]),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"toggle_e2ee_xma_previews_settings",c.i64.cast([0,789]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSOmnistoreSettingsUpdateE2eeXmaPreviewSettingsStoredProcedure";a.__tables__=["messaging_privacy_settings"];e.exports=a}),null);
__d("LSUpsertAttachmentRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.db.table(17).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(c){return b.db.table(17).add({threadKey:a[0],mediaGroup:a[1],minTimestampMs:a[2],maxTimestampMs:b.i64.cast([2328,1316134911]),hasMoreBefore:a[3],hasMoreAfter:!1,isLoadingBefore:!1,isLoadingAfter:!1,lastLoadedMessageId:a[4]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpsertAttachmentRangeStoredProcedure";a.__tables__=["attachments_ranges_v2__generated"];e.exports=a}),null);
__d("LSUpsertAttachmentRangeStoredProcedure",["LSSynchronousPromise","LSUpsertAttachmentRange","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSUpsertAttachmentRange"),e.threadKey,e.mediaGroup,e.newMinTs,e.hasMoreBefore,e.newLastLoadedMessageId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUserVisibleErrorsUtil",["LSFactory","LSRemoveErrorStoredProcedure","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("promiseDone")(a.runInTransaction(function(a){return c("LSRemoveErrorStoredProcedure")(c("LSFactory")(a),{errorId:b})},"readwrite",void 0,void 0,f.id+":24"))}g.removeUserVisibleErrorFromTable=a}),98);
__d("MAWBridgeAddMessageSearchResultHandler",["I64","LSIntEnum","LSMessageSearchType","MAWCurrentUser","MAWFTSRawStringMatcher","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime","cr:17064","cr:17065","emptyFunction","gkx","isMAWUniversalSearchWithEBEnabled","promiseDone","waitForMiActMappingForUniversalSearch"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageSearchType").MESSAGE),l=j.ofNumber(c("LSMessageSearchType").THREAD);function a(a,d,e){return e.length===0?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).all([o(a,d,e),q(a,d,e)]).then(c("emptyFunction"))}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("MAWFTSRawStringMatcher").load());return b.filter(function(b){b=(b=b.msg)==null?void 0:b.content;return b==null?!1:c(a,b)})});return n.apply(this,arguments)}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(e.message_search_queries).getKeyRange(k)));if(g.length===0)return;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(e,f[0].chatJid,"MAWBridgeAddMessageSearchResultHandler",function(e,h){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=g.filter(function(a){return(i||(i=d("I64"))).equal(a.threadKeyV2,h)})[0];if(c==null)return;var j=c.query;if(j==null||j.length<2)return;var k=(i||(i=d("I64"))).to_int32(c.resultCount);j=(yield m(j,f));if(j.length===0)return;yield b("cr:17064").addBridgeSearchMsgsToSearchResult(a,e,c.query,j,k+j.length,i.of_string(d("MAWCurrentUser").getID()))})().then(c("emptyFunction"))})});return p.apply(this,arguments)}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){if(!c("isMAWUniversalSearchWithEBEnabled")())return;var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.message_search_queries).getKeyRange(l).filter(function(a){return(i||(i=d("I64"))).equal(a.threadKeyV2,i.one)})));if(g==null)return;var h=g.query;if(h==null||h.length<2)return;var j=(yield m(h,f));if(j.length===0)return;if(c("gkx")("11537"))c("promiseDone")(c("waitForMiActMappingForUniversalSearch")(a,f[0].chatJid),function(c){if(c!=null)return b("cr:17065")(a,void 0,c.serverThreadKey,h,j,g)});else{yield c("waitForMiActMappingForUniversalSearch")(a,f[0].chatJid);return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(e,f[0].chatJid,"MAWBridgeAddMessageSearchResultHandler",function(c,d){return b("cr:17065")(a,c,d,h,j,g)})}});return r.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeCallRestoreNativeOpHandler",["I64","Promise","WAJids","WALogger","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to call restore native op - echo and protobuf messages are both null"]);j=function(){return a};return a}var k=c("requireDeferred")("LSProtobufRestoreHandler").__setRef("MAWBridgeCallRestoreNativeOpHandler"),l=c("requireDeferred")("LSRestoreEchoBlobs.nop").__setRef("MAWBridgeCallRestoreNativeOpHandler");function a(a,c){var e=c.chatJid,f=c.decryptedMessagesProtobufs,g=c.echoMessages,m=c.hasMoreAfter,n=c.hasMoreBefore,o=c.isPointQuery,p=c.nextMessageTimestampMsAfter,q=c.nextMessageTimestampMsBefore,r=c.referenceTimestamp,s=c.requestId,t=c.taskSource;if(f!=null)return k.load().then(function(a){return a.handleProtobufRestoreHelper(d("WAJids").threadIdForChatJid(e),{convertedProtobufs:f,type:"convertedProtobufs"},n,q,m,p,o,s,r,void 0,void 0,t,e)});else if(g!=null)return l.load().then(function(c){return c(a,0,(i||(i=d("I64"))).zero,g,n,q,m,p,o,d("WAJids").threadIdForChatJid(e),s,r,t,e).then(function(){return(h||(h=b("Promise"))).resolve()})});else d("WALogger").ERROR(j());return(h||(h=b("Promise"))).resolve()}g.call=a}),98);
__d("MAWBridgeCentralizedThreadUpdateHandler",["FBLogger","I64","LSAuthorityLevel","LSBumpE2EEMetadataThreadStoredProcedure","LSDatabaseSingleton","LSFactory","LSIntEnum","MAWBridgeBuildThreadSnippet","MAWBridgeFireAndForget","MAWChatJid","MAWLoggerDeferred","MAWMiActGetThreadLifecycleState","MAWODSProxy","MAWThreadBumpType","MAWThreadUpdateMiddlewareGatingUtil","MAWThreadUpdateType","ODS","ReQL","WAJids","WAOdsEnums","WATimeUtils","asyncToGeneratorRuntime","getMAWLastMessageCtaType","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo][Middleware] Starting Thread Update on "," via middleware. threadKey: ",", authorityLevel: ",", lastActivityTimestampMs: ",", bumpTimestampMs: ",", bumpedByLocalDeviceSend: ",", bumpType: ",", threadUpdateType: ",", isUnbump: ",", isThrottled: "," from ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo][Middleware] Updated thread via middleware. threadKey: ",", bumpTimestampMs: ",",\n    original lastActivityTimestampMs: ","\n    , bumpedByLocalDeviceSend: ",", bumpType: ",", threadUpdateType: ",",  from ",""]);m=function(){return a};return a}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("MAWChatJid").toThreadMaybe(a,b.jid));if(e==null){var f=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByJid(a,d("MAWChatJid").toIntegerJid(b.jid),"MAWBridgeCentralizedThreadUpdateHandler"));c("FBLogger")("CentralizedThreadUpdate").mustfix("[Occamadillo][Middleware] missing thread for bumping jid: %s with thread state: %s",b.jid,f.type);return}return(h||(h=d("I64"))).lt(e.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))&&!b.bumpedByLocalDeviceSend?B(e,b):o(a,e,b)});return n.apply(this,arguments)}function o(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=b;b=f;b=b.threadKey;var g=e.author,i=e.bumpedByLocalDeviceSend,k=e.bumpTimestampMs,l=e.threadUpdateType;if(l===d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE)return;var m=f.lastActivityTimestampMs;x(e,f,"Local",e.isUnbump,e.threadBumpType);if((h||(h=d("I64"))).equal(m,(h||(h=d("I64"))).zero)){var n;E("zero_last_activity_timestamp");var o=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.messages).getKeyRange(f.threadKey).take(5))),p=o.length;o=o.map(function(a){return(h||(h=d("I64"))).to_string(a.displayedContentTypes)}).join(",");c("FBLogger")("CentralizedThreadUpdate").warn("[Occamadillo][Middleware] Encountered lastActivityTs == 0 for thread jid : %s with authority level: %s, threadType : %s, threadStatus : %s, folderType : %s, numMsgs (limit 5): %s and msgContentTypes: [%s]",e.jid,(h||(h=d("I64"))).to_string(f.authorityLevel),h.to_string(f.threadType),h.to_string((n=f.threadStatus)!=null?n:(h||(h=d("I64"))).neg_one),f.folderName,p,o)}n=y(e,m);p=n.isUnbump;o=n.threadBumpType;if(l===d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD||l===d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD||p){E("bump_on_local");p&&(f=s(p,k,f),l!==d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD&&(f=u(k,f,p)));n=z(g,i,o,k,m,f.threadKey);if(n){l={bumpedByLocalDeviceSend:i,isUnbump:p,serverAuthoritativeTimestampMs:k,threadKey:b};(j||(j=d("ODS"))).bumpEntityKey(3185,"maw_tc_server_thread_bump",""+((g=e.centralizedThreadSnippetData.snippetType)!=null?g:"undefined"));x(e,f,"Server",p,o);yield q(c("LSFactory")(a),l)}}var r=v(e.centralizedThreadSnippetData,f);return a.threads.put(r).then(function(){f!=null&&w(e,m,r)})});return p.apply(this,arguments)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){E("bump_on_server");return c("LSBumpE2EEMetadataThreadStoredProcedure")(a,b)});return r.apply(this,arguments)}function s(a,b,c){return!t(a,b,c)?c:babelHelpers["extends"]({},c,{lastActivityTimestampMs:b})}function t(a,b,c){return a?(h||(h=d("I64"))).lt(b,c.lastActivityTimestampMs):(h||(h=d("I64"))).gt(b,c.lastActivityTimestampMs)}function u(a,b,c){return!c&&(h||(h=d("I64"))).lt(a,b.lastReadWatermarkTimestampMs)?b:babelHelpers["extends"]({},b,{lastReadWatermarkTimestampMs:a})}function v(a,b){var e=a.snippetSenderContactId!=null?(h||(h=d("I64"))).of_string(a.snippetSenderContactId):(h||(h=d("I64"))).zero,f=c("getMAWLastMessageCtaType")(a.snippetType);a=d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b.snippet);return babelHelpers["extends"]({},b,{lastMessageCtaType:f,snippet:a,snippetSenderContactId:e})}function w(a,b,e){c("promiseDone")(d("MAWLoggerDeferred").LOG(m(),(h||(h=d("I64"))).to_string(e.threadKey),h.to_string(e.lastActivityTimestampMs),h.to_string(b),a.bumpedByLocalDeviceSend,a.threadBumpType,a.threadUpdateType,a.description))}function x(a,b,e,f,g){e=[e,(h||(h=d("I64"))).to_string(b.threadKey),h.to_string(b.authorityLevel),h.to_string(b.lastActivityTimestampMs),h.to_string(a.bumpTimestampMs),a.bumpedByLocalDeviceSend,g,a.threadUpdateType,f,a.isThrottled,a.description];c("promiseDone")(d("MAWLoggerDeferred").LOG(l(),e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10]))}function y(a,b){var e=c("justknobx")._("3068");if(e)return{isUnbump:a.isUnbump,threadBumpType:a.threadBumpType};e=(h||(h=d("I64"))).lt(a.bumpTimestampMs,b);if(a.isThrottled&&e){switch(a.tableName){case"messages":E("unbump_from_message_in_throttle");break;case"reactions":E("unbump_from_reaction_in_throttle");break;default:E("unbump_from_throttle")}e=a.tableName==="reactions";e&&d("MAWThreadUpdateMiddlewareGatingUtil").isPeristedUnbumpEnabled()&&d("MAWBridgeFireAndForget").fireAndForget("backend","unbumpThread",{incomingUnbumpFromTs:d("WATimeUtils").castToMillisTime((h||(h=d("I64"))).to_float(b)),threadJid:a.jid});return{isUnbump:!0,threadBumpType:d("MAWThreadBumpType").THREAD_BUMP_TYPE.LOCAL_ONLY}}return{isUnbump:a.isUnbump,threadBumpType:a.threadBumpType}}function z(a,b,e,f,g,i){if(e!==d("MAWThreadBumpType").THREAD_BUMP_TYPE.LOCAL_AND_SERVER)return!1;if(A(a,b)){c("FBLogger")("CentralizedThreadUpdate").info("[Occamadillo][Middleware] Skipping receiver bump for own message on thread %s",(h||(h=d("I64"))).to_string(i));return!1}E("check_if_bump_is_newer_than_current_activity");e=(h||(h=d("I64"))).gt(f,g);e||E("server_bump_prevented");return e}function A(a,b){return a!=null&&d("WAJids").isAuthorMe(a)&&b===!1}function B(a,b){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton);E("wait_for_authoritative_thread_start");D(a.threadKey,e,function(a){E("wait_for_authoritative_thread_end");var g=(h||(h=d("I64"))).to_float(a.lastActivityTimestampMs);E("ts_of_authoritative_thread_after_wait_"+(g>0?"gt_0":"eq_0"));c("promiseDone")(e.runInTransaction(function(c){return o(c,a,b)},"readwrite",void 0,void 0,f.id+":497"))});return});return C.apply(this,arguments)}function D(a,b,e){var f=d("ReQL").fromTableAscending(b.tables.threads).getKeyRange(a).subscribe(function(a,b){if(b.operation==="delete")return;a=b.value;if((h||(h=d("I64"))).lt(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)))return;e(a);return f()})}function E(a){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_UPDATE_MIDDLEWARE,key:a})}g.call=a}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["LSThreadBitOffset","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeDeleteGroupInviteHandler",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,f){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(e.group_invites).getKeyRange(f)));return(h||(h=b("Promise"))).all(g.map(function(a){return e.group_invites["delete"](a.threadKey,a.inviterId,a.inviteeId)})).then(function(){if(!c("justknobx")._("1162"))return;c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)),function(b){if(b==null)return;var c=d("LSThreadBitOffset").clear([105],b.capabilities,b.capabilities2,b.capabilities3,b.capabilities4,b.capabilities5),e=c[0],f=c[1],g=c[2],h=c[3];c=c[4];return a.threads.put(babelHelpers["extends"]({},b,{capabilities:e,capabilities2:f,capabilities3:g,capabilities4:h,capabilities5:c,snippet:void 0}))})})});return function(a,b){return e.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeDeleteMessageRangesV2Handler",["I64","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeDeleteMessageRangesV2Handler",function(a,c){return a.messages_ranges_v2__generated["delete"](c,(h||(h=d("I64"))).of_float(b.minTimestampMs),b.minMsgId)})}g.call=a}),98);
__d("MAWBridgeDeleteMessagesOfThreadHandler",["EBIsEbEnabled","LSFactory","LSIntEnum","LSIssueThreadRemoveStoredProcedure","LSMEBTaskCreationSource","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.actionType===2){if(!(yield d("EBIsEbEnabled").isEbEnabledLS(a)))return;yield c("LSIssueThreadRemoveStoredProcedure")(c("LSFactory")(a),{actThreadId:b.threadId,sortKey:b.ts.toString(),source:(h||(h=d("LSIntEnum"))).ofNumber(c("LSMEBTaskCreationSource").TAM_WEB)})}});return i.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeDeleteMessagesOfThreadHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeDeleteMessagesOfThreadHandler").__setRef("MAWBridgeDeleteMessagesOfThreadHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeFulfillRestorePromisePayloadHandler",["MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","Promise","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a.success?(d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(a.value.traceId),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a.value.traceId)):(d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(a.error.traceId,c("err")(a.error.message)),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(a.error.traceId));return(h||(h=b("Promise"))).resolve()}g.call=a}),98);
__d("MAWBridgeGQLUploadUtils",["JSResourceForInteraction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,d){var a=(yield c("JSResourceForInteraction")("MAWEncryptedBackupsMessageUploadMutation").__setRef("MAWBridgeGQLUploadUtils").load());return a.uploadMessageOverGQL(b,d)});return h.apply(this,arguments)}g.uploadMessageOverGQL=a}),98);
__d("MAWBridgeGroupInfoUpdatedHandler",["I64","MAWLoggerDeferred","MAWMiActOnMiThreadReadyForJid","ODS","ReQL","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["\n            [Occamadillo] missing thread for updating group\n            with threadKey: ",""]);j=function(){return a};return a}function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.chatJid,"MAWBridgeGroupInfoUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f;f=(f=e.threadName)!=null?f:void 0;a=a.threads;var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(b)));if(g==null){(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_group_info_update","missing_thread");c("promiseDone")(d("MAWLoggerDeferred").WARN(j(),(i||(i=d("I64"))).to_string(b)));return}b=e.memberAddMode!=="all_member_add";yield a.put(babelHelpers["extends"]({},g,{needsAdminApprovalForNewParticipant:b,threadName:f}))});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeGroupInviteLoadedHandler",["fbt","I64","LSMessagingThreadTypeUtil","MAWMiActOnMiThreadReadyForJid","ReQL","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=a.threads,g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(f).getKeyRange(e)));if(g==null)return;var j=d("LSMessagingThreadTypeUtil").isGroup(g.threadType);if(!j)return;j=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.group_invites).getKeyRange(e)));if(j==null){c("justknobx")._("1162")&&(yield f.put(babelHelpers["extends"]({},g,{additionalThreadContext:void 0})));return}e=(i||(i=d("I64"))).equal((i||(i=d("I64"))).of_string(b.actorId),j.inviterId)?null:yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts,["name"]).getKeyRange(j.inviterId));if(e==null)return;b=h._(/*BTDS*/"__JHASH__UJFQkCMRFkv__JHASH__",[h._param("Inviter Name",e.name)]).toString();a=g.folderName==="inbox"?h._(/*BTDS*/"__JHASH__4F6x7gUU1-S__JHASH__").toString():g.additionalThreadContext;yield f.put(babelHelpers["extends"]({},g,{additionalThreadContext:a,snippet:b}))});return k.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeGroupInviteLoadedHandler",function(a,c){return j(a,b,c)})}g.callWithoutWaitingForAnything=j;g.call=a}),226);
__d("MAWBridgeGroupInviteUpdateHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWUpdateLSThreadCapabilities","Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeGroupInviteUpdateHandler",function(a,f){var g=(i||(i=d("I64"))).of_string(e.inviterId);return(h||(h=b("Promise"))).all([d("MAWUpdateLSThreadCapabilities").setGroupInviteTxn(a,f,g)]).then(c("emptyFunction"))})}g.call=a}),98);
__d("MAWBridgeHandleCOPDigest",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("MAWBridgeIssuePointQueryHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeIssuePointQueryHandler").__setRef("MAWBridgeIssuePointQueryHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeMediaExpiredHandler",["MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeMediaExpiredHandler.bs",function(a,c){return a.attachments["delete"](c,b.msgId,String(b.plaintextHash))})}g.call=a}),98);
__d("MAWBridgeMsgRangeLoadedHandler",["I64","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","Promise","WALogger","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["No messages found for thread "," with message id ",""]);j=function(){return a};return a}function a(a,e){if(e.rangeExtensionType==null){d("WALogger").ERROR(j(),e.threadJid,e.offsetMsgId);return(i||(i=b("Promise"))).resolve()}return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeMsgRangeLoadedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g,i,j,k,l;f=((f=e.rangeExtensionType)==null?void 0:f.minMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((g=e.rangeExtensionType)==null?void 0:g.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(e.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(i=(i=e.rangeExtensionType)==null?void 0:i.minMsgId)!=null?i:"";j=(j=(j=e.rangeExtensionType)==null?void 0:j.maxMsgId)!=null?j:"";k=(k=(k=e.rangeExtensionType)==null?void 0:k.hasMoreBefore)!=null?k:!1;l=(l=(l=e.rangeExtensionType)==null?void 0:l.hasMoreAfter)!=null?l:!1;var m=e.offsetMsgId;yield c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:l,hasMoreBefore:k,lowerOverlap:f,newMaxMid:j,newMaxTs:g,newMinMid:i,newMinTs:f,requestedMessageId:m,threadKey:b,upperOverlap:g})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeMsgUpdatedHandler",["FBLogger","MAWAdminMsgCTA","MAWMiActOnMiThreadReadyForJid","MAWMsgReplySnippet","MAWUpdateMsg","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.chatJid,"MAWBridgeMsgUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g=(yield (f=d("ReQL")).firstAsync(f.fromTableAscending(a.messages.index("messageId")).getKeyRange(e.msgId)));f=(yield f.firstAsync(f.fromTableAscending(a.attachments).getKeyRange(b,e.msgId)));if(g==null){c("FBLogger")("messenger_e2ee_web").info("existing message is null for type %s, and attachment is null: %s",e.type_,f==null);return}f=(yield d("MAWAdminMsgCTA").getAdminMsgCtaStep(a,b,e));b=(yield d("MAWMsgReplySnippet").getReplySnippet(e));return d("MAWUpdateMsg").call(a,e,g,f,b)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeMsgsLoadedHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.chatJid,"MAWBridgeMsgsLoadedHandler",function(a,e){return c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:e}).then(function(){if(c("gkx")("23927")){var f,g,i,j,k,l,m,n;f=(f=(f=b.rangeExtensionType)==null?void 0:f.hasMoreBefore)!=null?f:!1;g=(g=(g=b.rangeExtensionType)==null?void 0:g.hasMoreAfter)!=null?g:!1;i=f&&((i=b.rangeExtensionType)==null?void 0:i.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;j=g&&((j=b.rangeExtensionType)==null?void 0:j.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;k=(k=(k=b.rangeExtensionType)==null?void 0:k.minMsgId)!=null?k:"";l=(l=(l=b.rangeExtensionType)==null?void 0:l.maxMsgId)!=null?l:"";m=((m=b.rangeExtensionType)==null?void 0:m.rangeKind)==="before"?i:d("MAWTimeUtils").MIN_TIMESTAMP_MS;n=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="after"?j:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:g,hasMoreBefore:f,lowerOverlap:m,newMaxMid:l,newMaxTs:j,newMinMid:k,newMinTs:i,threadKey:e,upperOverlap:n})}else{f=((g=b.rangeExtensionType)==null?void 0:g.minMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.minMsgTs):d("MAWTimeUtils").MIN_TIMESTAMP_MS;l=((m=b.rangeExtensionType)==null?void 0:m.maxMsgTs)!=null?(h||(h=d("I64"))).of_float(b.rangeExtensionType.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS;i=(k=(j=b.rangeExtensionType)==null?void 0:j.minMsgId)!=null?k:"";m=(g=(n=b.rangeExtensionType)==null?void 0:n.maxMsgId)!=null?g:"";k=((j=b.rangeExtensionType)==null?void 0:j.rangeKind)==="extensionBefore"?f:d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=((n=b.rangeExtensionType)==null?void 0:n.rangeKind)==="extensionAfter"?l:d("MAWTimeUtils").MAX_TIMESTAMP_MS;j=(n=(j=b.rangeExtensionType)==null?void 0:j.hasMoreBefore)!=null?n:!1;n=(n=(n=b.rangeExtensionType)==null?void 0:n.hasMoreAfter)!=null?n:!1;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:n,hasMoreBefore:j,lowerOverlap:k,newMaxMid:m,newMaxTs:l,newMinMid:i,newMinTs:f,threadKey:e,upperOverlap:g})}})})}g.call=a}),98);
__d("MAWBridgeNewMediaRangeHandler",["I64","LSFactory","LSIntEnum","LSUpsertAttachmentRangeStoredProcedure","MAWMediaGalleryEBTaggingUtils","MAWMiActOnMiThreadReadyForJid","cr:14184","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeNewMediaRangeHandler",function(a,f){var g=(h||(h=d("I64"))).of_float(e.earliestLoadedMediaTs),j=e.mediaGalleryGroup,k=b("cr:14184")!=null?b("cr:14184").getMediaRestoreEBRange().getRange(f):null;k=Boolean(k==null?void 0:k.hasMoreBefore)&&d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(j);k=e.hasMoreBefore||k;return c("LSUpsertAttachmentRangeStoredProcedure")(c("LSFactory")(a),{hasMoreBefore:k,mediaGroup:(i||(i=d("LSIntEnum"))).ofNumber(j),newLastLoadedMessageId:e.lastLoadedMessageId,newMinTs:g,threadKey:f})})}function a(a,b){return j(a,b).then(c("emptyFunction"))}g.call=a}),98);
__d("MAWBridgeOccamadilloCreateE2EEMetadataThreadHandler",["FBLogger","I64","LSAuthorityLevel","LSCreateE2EEMetadataThreadStoredProcedure","LSFactory","LSIntEnum","MAWChatJid","MAWCreateOptimisticThread","MAWFolderUtils","MAWThreadUpdateMiddlewareGatingUtil","MAWThreadUtils","Promise","WALogger","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="[Occamadillo][CreateE2EEMetadataThreadHandler]";function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){d("WALogger").LOG([k+" Handler called from "+e.creationSource+" for "+("jid: "+e.jid)]);if(!d("MAWThreadUpdateMiddlewareGatingUtil").isNewMiThreadCreationFlowEnabled("exposure_logging_disabled")){d("WALogger").LOG([k+" Early return due to failed eligibility check"]);return(j||(j=b("Promise"))).resolve()}var f=e.bumpTimestampMs,g=e.creationSource,i=e.folderId,l=e.jid;e=e.threadKeys;var n=(yield m(a,e));if(!s(g,n)){d("WALogger").LOG([k+" Early return due to no SPROC call required: jid: "+l+", "+("threadKey: "+((n==null?void 0:n.threadKey)?(h||(h=d("I64"))).to_string(n==null?void 0:n.threadKey):"null"))]);return(j||(j=b("Promise"))).resolve()}g=t(g);i=d("MAWFolderUtils").systemFolderToLSCoreClientFolder(i);n=(yield q(a,n,e,l));e=d("MAWThreadUtils").getLSThreadTypeFromJid(l);u({bumpTimestampMs:f,createdByLocalDevice:g,folderType:i,jid:l,offlineThreadKeyDetails:n,threadType:e});return c("LSCreateE2EEMetadataThreadStoredProcedure")(c("LSFactory")(a),{bumpTimestampMs:f,createdByLocalDevice:g,folderType:i,offlineThreadKey:n.offlineThreadKey,threadType:e,waJid:d("MAWChatJid").toIntegerJid(l)})});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=(yield (j||(j=b("Promise"))).all([yield o(a,c.authoritative),yield o(a,c.optimistic)]));c=a[0];a=a[1];return(c=c)!=null?c:a});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c==null)return(j||(j=b("Promise"))).resolve();a=(yield a.threads.get((h||(h=d("I64"))).of_string(c)));return a});return p.apply(this,arguments)}function q(a,b,c,d){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(e!=null)return{offlineThreadKey:e.threadKey,source:"Pre-existing LSDB Thread"};e=null;var i=null;f.authoritative!=null?(e=(h||(h=d("I64"))).of_string(f.authoritative),i="MAW: authoritative"):f.optimistic!=null?(e=(h||(h=d("I64"))).of_string(f.optimistic),i="MAW: optimistic"):(e=(yield d("MAWCreateOptimisticThread").createOfflineThreadingId(a)),i="New Offline Threading ID");yield (j||(j=b("Promise"))).all([d("MAWCreateOptimisticThread").createOptimisticThreadWithThreadKey(a,e),a.mi_act_mapping_table.put({clientThreadPk:d("MAWChatJid").toIntegerJid(g),jid:d("MAWChatJid").toIntegerJid(g),serverThreadKey:e})]);c("FBLogger")("messenger_e2ee_web").info(k.concat(" Created new optimistic thread in LSDB with threadKey: ",(h||(h=d("I64"))).to_string(e),", threadKey source: ",i,", for jid: ",g));return{offlineThreadKey:e,source:i}});return r.apply(this,arguments)}function s(a,b){var e=b!=null?(i||(i=d("LSIntEnum"))).unwrapIntEnum(b.authorityLevel):null;switch(a){case"incoming_message":return b==null;case"outgoing_message":switch(e){case null:case void 0:case c("LSAuthorityLevel").CLIENT_PARTIAL:case c("LSAuthorityLevel").OPTIMISTIC:case c("LSAuthorityLevel").SERVER_PARTIAL:return!0;case c("LSAuthorityLevel").AUTHORITATIVE:case c("LSAuthorityLevel").AUTHORITATIVE_PENDING_REPLACEMENT:case c("LSAuthorityLevel").CLIENT_AUTHORITATIVE_DELETE:return!1;default:e;throw c("err")("Unknown authority level")}default:a;throw c("err")("Unknown creation source")}}function t(a){switch(a){case"incoming_message":return!1;case"outgoing_message":return!0;default:a;throw c("err")("Unknown creation source")}}function u(a){var b=a.bumpTimestampMs,e=a.createdByLocalDevice,f=a.folderType,g=a.jid,j=a.offlineThreadKeyDetails;a=a.threadType;c("FBLogger")("messenger_e2ee_web").info(k.concat(" Calling LSCreateE2EEMetadataThreadStoredProcedure with params: ","bumpTimestampMs: ",(h||(h=d("I64"))).to_float(b).toString(),", createdByLocalDevice: ",e.toString(),", folderType: ",(i||(i=d("LSIntEnum"))).toNumber(f).toString(),", offlineThreadKey: ",h.to_string(j.offlineThreadKey),", offlineThreadKeySource: ",j.source,", threadType: ",i.toNumber(a).toString(),", waJid: ",g))}g.call=a}),98);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler",["fbt","FBLogger","I64","LSAuthorityLevel","LSIntEnum","LSMessagingThreadTypeUtil","LSThreadBitOffset","MAWContactRelationshipType","MAWMessageRequestUtil","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","WADbContact","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeOneToOneMessageRequestLoadedHandler",function(a,f){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)).then(function(c){if(c==null)return(k||(k=b("Promise"))).resolve([void 0,void 0,void 0,!1]);var f=d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).getKeyRange((i||(i=d("I64"))).of_string(e.fbid)));return(k||(k=b("Promise"))).all([k.resolve(c),f,k.resolve(d("LSMessagingThreadTypeUtil").isOneToOne(c.threadType))])}).then(function(e){var f=e[0];if(f==null)return(k||(k=b("Promise"))).resolve();var g=e[1];if(g==null)return(k||(k=b("Promise"))).resolve();e=e[2];if(e===!1||e==null)return(k||(k=b("Promise"))).resolve();e=d("MAWContactRelationshipType").getContactRelationshipType(g);e=f.folderName==="inbox"&&e===d("WADbContact").REVERSED_ONE_WAY_CONTACT&&!(i||(i=d("I64"))).equal(f.lastActivityTimestampMs,(i||(i=d("I64"))).zero);e&&(i||(i=d("I64"))).lt(g.authorityLevel,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))&&(c("FBLogger")("messenger_web_product").mustfix("[MAW] Message Request loaded before contact is fully loaded"),e=!1);if(f.folderName==="pending"||f.folderName==="other"||f.folderName==="spam"||e){g=d("LSThreadBitOffset").clear(d("MAWMessageRequestUtil").disabledThreadCapabilitiesForIncomingRequest,f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4,f.capabilities5);e=g[0];var l=g[1],m=g[2],n=g[3];g=g[4];var o=void 0;f.folderName==="inbox"&&(o=h._(/*BTDS*/"__JHASH__4F6x7gUU1-S__JHASH__").toString());e=[d("LSThreadBitOffset").set(d("MAWMessageRequestUtil").enabledThreadCapabilitiesForIncomingRequest,e,l,m,n,g),o]}else e=[[f.capabilities,f.capabilities2,f.capabilities3,f.capabilities4],void 0];l=e[0];m=e[1];n=babelHelpers["extends"]({},f,{additionalThreadContext:m,capabilities:l[0],capabilities2:l[1],capabilities3:l[2],capabilities4:l[3]});return a.threads.put(n).then(c("emptyFunction"))})})}g.call=a}),226);
__d("MAWBridgeParticipantRemovedHandler",["I64","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeParticipantRemovedHandler",function(a,c){return a.participants["delete"](c,(h||(h=d("I64"))).of_string(b.userId))})}g.call=a}),98);
__d("MAWBridgeParticipantUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(j||(j=d("I64"))).of_string(l);function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(j||(j=d("I64"))).of_string(b.fbid),g=d("MAWTimeUtils").toTimestamp(b.readWatermarkTs),i=d("MAWTimeUtils").toTimestamp(b.deliveredWatermarkTs),n=d("MAWTimeUtils").toTimestamp(b.lastReadActionTs),o=b.isSuperAdmin?h._(/*BTDS*/"__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,p=(yield a.participants.get(e,f));p!=null?yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:p.authorityLevel,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:b.isInvited?(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:b.isAdmin,isModerator:!1,isSuperAdmin:p.isSuperAdmin,nickname:p.nickname,normalizedSearchTerms:p.normalizedSearchTerms,participantCapabilities:p.participantCapabilities,readActionTimestampMs:n,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:e},"MAWBridgeParticipantUpdatedHandler.put")):yield a.participants.add(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:(j||(j=d("I64"))).zero,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:b.isInvited?(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(k||(k=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:b.isAdmin,isModerator:!1,isSuperAdmin:b.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:j.zero,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:e},"MAWBridgeParticipantUpdatedHandler.add"));yield d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,e);n=b.isAdmin;(j||(j=d("I64"))).equal(m,f)&&(n?yield d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,e):yield d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,e));p==null&&(yield c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(k||(k=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:k.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:k.ofNumber(c("LSContactIdType").FBID),contactType:k.ofNumber(c("LSContactType").USER),contactViewerRelationship:k.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:k.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:l===b.fbid,workForeignEntityType:k.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)}))});return o.apply(this,arguments)}function a(a,c){return c.fbid.startsWith("shadow_")?(i||(i=b("Promise"))).resolve():d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,c.threadJid,"MAWBridgeParticipantUpdatedHandler",function(a,b){return n(a,c,b)})}g.callWithoutWaitingForAnything=n;g.call=a}),226);
__d("MAWBridgeParticipantsUpdatedHandler",["fbt","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSGroupParticipantJoinState","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","MAWCurrentUser","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","MAWUpdateLSThreadCapabilities","Promise","ReQLTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("MAWCurrentUser").getID(),m=(k||(k=d("I64"))).of_string(l);function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.participants.filter(function(a){return!a.fbid.startsWith("shadow_")});yield (i||(i=b("Promise"))).all(e.map(function(e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeParticipantsUpdatedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f=(k||(k=d("I64"))).of_string(e.fbid),g=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),i=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),n=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),o=e.isSuperAdmin?h._(/*BTDS*/"__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,p=!1,q=!1;yield d("ReQLTable").update(a.participants,[b,f],function(a){if(a!=null){q=!0;return{authorityLevel:a.authorityLevel,contactId:f,deliveredWatermarkTimestampMs:(k||(k=d("I64"))).equal(i,(k||(k=d("I64"))).zero)?a.deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:(k||(k=d("I64"))).equal(n,(k||(k=d("I64"))).zero)?a.readActionTimestampMs:n,readWatermarkTimestampMs:(k||(k=d("I64"))).equal(g,(k||(k=d("I64"))).zero)?a.readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}else{q=!0;p=!0;return{authorityLevel:(k||(k=d("I64"))).zero,contactId:f,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:e.isInvited?(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").INVITED):(j||(j=d("LSIntEnum"))).ofNumber(c("LSGroupParticipantJoinState").MEMBER),isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:k.zero,readWatermarkTimestampMs:g,subscribeSource:o,threadKey:b}}});q&&(yield d("MAWUpdateLSThreadCapabilities").disableBlockerCapabilitiesTxn(a,b),(k||(k=d("I64"))).equal(m,f)&&(e.isAdmin?yield d("MAWUpdateLSThreadCapabilities").enableAddMembersTxn(a,b):yield d("MAWUpdateLSThreadCapabilities").disableAddMembersTxn(a,b)));p&&(yield c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:l===e.fbid,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)}))});return function(b,c){return a.apply(this,arguments)}}())}))});return n.apply(this,arguments)}g.call=a}),226);
__d("MAWBridgeRavenActionMsgForUIHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWMsg","MAWRavenUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,c.threadJid,"MAWBridgeRavenActionMsgForUIHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=a.attachments;e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a).getKeyRange(e,c.ravenMsgId)));if(e==null)return(i||(i=b("Promise"))).resolve();if(e.ephemeralMediaState==null)return(i||(i=b("Promise"))).resolve();var f=(h||(h=d("I64"))).to_int32(e.ephemeralMediaState);if(e.ephemeralMediaViewMode==null)return(i||(i=b("Promise"))).resolve();var g=h.to_int32(e.ephemeralMediaViewMode);f=d("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(f);g=d("MAWMsg").MAWRavenMsgEphemeralType.cast(g);if(f==null||g==null)return(i||(i=b("Promise"))).resolve();f=d("MAWRavenUtils").getNextRavenMessageEphemeralState(f,g);if(f==null)return(i||(i=b("Promise"))).resolve();e.ephemeralMediaState;g=babelHelpers.objectWithoutPropertiesLoose(e,["ephemeralMediaState"]);e=babelHelpers["extends"]({ephemeralMediaState:h.of_int32(f)},g,{transportKey:"WhatsApp"});f=[g.threadKey,g.messageId,g.attachmentFbid];return a.upsert(f,e)});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeReceivedReceiptHandler",["I64","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(h||(h=d("I64"))).of_string(b.fbid),f=d("MAWTimeUtils").toTimestamp(b.lastReadWatermarkTs),g=d("MAWTimeUtils").toTimestamp(b.deliveredWatermarkTs);b=d("MAWTimeUtils").toTimestamp(b.lastReadActionTs);c=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(c,e)));c!=null&&(yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:(h||(h=d("I64"))).equal(g,(h||(h=d("I64"))).zero)?c.deliveredWatermarkTimestampMs:g,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:(h||(h=d("I64"))).equal(b,(h||(h=d("I64"))).zero)?c.readActionTimestampMs:b,readWatermarkTimestampMs:(h||(h=d("I64"))).equal(f,(h||(h=d("I64"))).zero)?c.readWatermarkTimestampMs:f,subscribeSource:c.subscribeSource,threadKey:c.threadKey,threadRoles:(h||(h=d("I64"))).zero},"MAWBridgeReceivedReceiptHandler")))});return j.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.chatJid,"MAWBridgeReceivedReceiptHandler",function(a,c){return i(a,b,c)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeRefreshContactHandler",["LSFactory","LSRefetchContactRowIfExistsStoredProcedure"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return c("LSRefetchContactRowIfExistsStoredProcedure")(c("LSFactory")(a),{id:b})}g.call=a}),98);
__d("MAWBridgeRemoveMessageSearchResultHandler",["Promise","ReQL","asyncToGeneratorRuntime","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.message_search_results).filter(function(a){return e.includes(a.messageOtid)})));yield (h||(h=b("Promise"))).all(c.map(function(b){return a.message_search_results["delete"](b.type_,b.query,b.threadKey,b.globalIndex)}))})().then(c("emptyFunction"))}g.call=a}),98);
__d("MAWBridgeTraceUtils",["I64","Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,c,e){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.data_trace_meta).filter(function(a){var b=a.contextThree;if(b!=null&&c===b&&(i||(i=d("I64"))).equal(a.traceType,e))return a.shouldFlush===!1;else return!1})).then(function(a){if(a.length!==0)return(h||(h=b("Promise"))).resolve(a[0].traceId);else return(h||(h=b("Promise"))).resolve()})}g.getTraceId=a}),98);
__d("MAWBridgeStartTraceHandler",["ArmadilloDataTraceCheckPoint","ArmadilloDataTraceType","I64","LSAppendDataTraceAddonStoredProcedure","LSDataTraceTag","LSFactory","LSRequestId","MAWAckLevel","MAWBridgeTraceUtils","MAWMsg","MAWTimeUtils","Promise","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e){return a.data_trace_meta.add({contextOne:void 0,contextThree:b.externalId,contextTwo:void 0,foregroundTimestampMs:(i||(i=d("I64"))).zero,initTimestampMs:d("MAWTimeUtils").toTimestamp(b.ts),predefinedId:void 0,shouldFlush:!1,traceId:e,traceType:b.traceType}).then(function(){return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:d("ArmadilloDataTraceCheckPoint").traceCreated,dataTraceId:e,syncChannel:(i||(i=d("I64"))).neg_one})}).then(function(){var f;if(b.threadKey==null||!c("gkx")("23995"))return;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:d("ArmadilloDataTraceCheckPoint").armadilloTlcControlOpenThread,dataTraceId:e,syncChannel:(i||(i=d("I64"))).neg_one,tags:(f=b.threadKey)!=null?f:void 0})})}function a(a,e){var f=e.ack,g=e.traceType;return f===d("MAWAckLevel").ACK.clock?d("MAWBridgeTraceUtils").getTraceId(a,e.externalId,e.traceType).then(function(f){if(f!=null)return;var k=c("LSRequestId").generate();if((i||(i=d("I64"))).equal(g,d("ArmadilloDataTraceType").armadilloMessageSend))return j(a,e,k).then(function(){var b=e.threadType;if(b==="User")return;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:d("ArmadilloDataTraceCheckPoint").traceGroupMessage,dataTraceId:k,syncChannel:(i||(i=d("I64"))).neg_one})}).then(function(){if(e.isFirstMsg)return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:d("ArmadilloDataTraceCheckPoint").armadilloActMessageSend,dataTraceId:k,syncChannel:(i||(i=d("I64"))).neg_one,tags:"first_msg=1"})}).then(function(){var f=e.type_;f=f===d("MAWMsg").text?d("ArmadilloDataTraceCheckPoint").traceTextMessage:f===d("MAWMsg").ptt||f===d("MAWMsg").image||f===d("MAWMsg").video||f===d("MAWMsg").gif?d("ArmadilloDataTraceCheckPoint").traceMediaMessage:void 0;if(f==null)return(h||(h=b("Promise"))).resolve(f);c("promiseDone")(c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:f,dataTraceId:k,syncChannel:(i||(i=d("I64"))).neg_one}));return(h||(h=b("Promise"))).resolve(f)}).then(function(b){if(b==null)return;if(!(i||(i=d("I64"))).equal(b,d("ArmadilloDataTraceCheckPoint").traceMediaMessage))return;b=e.type_;b=b===d("MAWMsg").image?d("LSDataTraceTag").image:b===d("MAWMsg").ptt?d("LSDataTraceTag").audio:b===d("MAWMsg").video?d("LSDataTraceTag").video:b===d("MAWMsg").gif?d("LSDataTraceTag").animatedImage:d("LSDataTraceTag").none;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:d("ArmadilloDataTraceCheckPoint").richMediaMediaSendAttachmentType,dataTraceId:k,syncChannel:(i||(i=d("I64"))).neg_one,tags:String(b)})});else return j(a,e,k)}):(h||(h=b("Promise"))).resolve()}g.call=a}),98);
__d("MAWBridgeStartTraceHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeStartTraceHandler").__setRef("MAWBridgeStartTraceHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeStartTraceWithTraceIdHandler",["MAWMainTraceUtils","MAWTimeUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMainTraceUtils").startTraceWithTxn(a,d("MAWTimeUtils").toTimestamp(d("WATimeUtils").unixTime()),b.traceId,b.traceType,void 0,void 0,b.traceContext)}g.call=a}),98);
__d("MAWBridgeStartTraceWithTraceIdHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeStartTraceWithTraceIdHandler").__setRef("MAWBridgeStartTraceWithTraceIdHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeSyncContacts",["CurrentMessengerUser","I64","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSFactory","LSIntEnum","LSVerifyContactRowExistsStoredProcedure","Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("CurrentMessengerUser").getID();function a(a,e){return e.reduce(function(b,e){var f=(i||(i=d("I64"))).of_string(e);return b.then(function(){return c("LSVerifyContactRowExistsStoredProcedure")(c("LSFactory")(a),{authorityLevel:(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),blockedByViewerStatus:j.ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contactIdType:j.ofNumber(c("LSContactIdType").FBID),contactType:j.ofNumber(c("LSContactType").USER),contactViewerRelationship:j.ofNumber(c("LSContactViewerRelationship").UNKNOWN),gender:j.ofNumber(c("LSContactGender").UNKNOWN),id:f,isBlocked:!1,isMemorialized:!1,isSelf:k===e,workForeignEntityType:j.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)})}).then(c("emptyFunction"))},(h||(h=b("Promise"))).resolve())}g.call=a}),98);
__d("MAWBridgeThreadHiddenV2Handler",["LSFactory","LSIntEnum","LSOptimisticRemoveThreadStoredProcedure","LSThreadRemoveType","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b,"MAWBridgeThreadHiddenV2Handler",function(a,b){a=c("LSFactory")(a);return c("LSOptimisticRemoveThreadStoredProcedure")(a,{removeType:(h||(h=d("LSIntEnum"))).ofNumber(c("LSThreadRemoveType").DELETE_THREAD),threadKey:b})})}g.call=a}),98);
__d("MAWBridgeThreadTimestampsHandler",["CurrentMessengerUser","I64","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","TemporaryLoggingUtilsForS406998Only","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs),f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b)));if(f==null||c.markUnread!==null&&c.markUnread===!1&&(h||(h=d("I64"))).ge(f.lastReadWatermarkTimestampMs,e))return;e=babelHelpers["extends"]({},f,{lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)});yield a.threads.put(e);f=(h||(h=d("I64"))).of_string(d("CurrentMessengerUser").getID());e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.participants).getKeyRange(b,f)));e!=null&&(yield a.participants.put(d("TemporaryLoggingUtilsForS406998Only").logIfInvalidParticipantAndReturnForS406998Only(babelHelpers["extends"]({},e,{readActionTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastActivityTimestampMs),readWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)}),"MAWBridgeThreadTimestampsHandler")))});return j.apply(this,arguments)}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeThreadTimestampsHandler",function(a,c){return i(a,c,b)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeThreadUpdatedHandler",["MAWBridgeBuildThreadSnippet","MAWBridgeUIEventDataValidation","MAWFolderUtils","MAWMiActOnMiThreadReadyForJid","ReQL","asyncToGeneratorRuntime","getMAWLastMessageCtaType"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=b.folder!=null?d("MAWFolderUtils").getMessagingFolderTag(b.folder):a.folderName;return(b=b.cannotReplyReason)!=null?b:c==="inbox"?void 0:a.cannotReplyReason}function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(e)));if(e==null)return;var f=d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(b,e.snippet),g=h(e,b),i=c("getMAWLastMessageCtaType")(b.snippetType);g=babelHelpers["extends"]({},e,{cannotReplyReason:g,folderName:e.folderName,lastMessageCtaType:i,parentThreadKey:e.parentThreadKey,snippet:f,snippetSenderContactId:b.snippetSenderContactId==null?e.snippetSenderContactId:d("MAWBridgeUIEventDataValidation").stringToI64Opt(b.snippetSenderContactId)});yield a.threads.put(g)});return j.apply(this,arguments)}function a(a,b){var c=b.threadJid;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,c,"MAWBridgeThreadUpdatedHandler",function(a,c){return i(a,b,c)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeTraceRecordCheckpointHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeTraceRecordCheckpointHandler").__setRef("MAWBridgeTraceRecordCheckpointHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeUIEventQueueQPLLogger",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("QPLUserFlow").start(c("qpl")._(1056849266,"1765"),{annotations:{string_array:{events:b}},instanceKey:a})}function b(a,b){c("QPLUserFlow").addAnnotations(c("qpl")._(1056849266,"1765"),b,{instanceKey:a})}function d(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056849266,"1765"),{instanceKey:a})}function e(a,b){c("QPLUserFlow").endFailure(c("qpl")._(1056849266,"1765"),"MAWBridgeUIEventHandlerFailure",{annotations:{string:{failedEventTag:b}},instanceKey:a})}g.start=a;g.addAnnotations=b;g.endSuccess=d;g.endFailure=e}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,c){return(g||(g=b("Promise"))).resolve()}f.call=a}),66);
__d("MAWBridgeUnbumpOnThreadLoadHandler",["FBLogger","I64","MAWChatJid","MAWMiActGetThreadLifecycleState","MAWODSProxy","WAOdsEnums","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Set();function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.jid,f=b.unbumpFromTs;b=b.unbumpToTs;var g=(yield d("MAWChatJid").toThreadMaybe(a,e));if(g==null){var j=(yield d("MAWMiActGetThreadLifecycleState").getThreadLifecycleStateByJid(a,d("MAWChatJid").toIntegerJid(e),"MAWBridgeCentralizedThreadUpdateHandler"));c("FBLogger")("UnbumpOnRefresh").mustfix("[UnbumpOnRefresh] missing thread for unbumping jid: %s with thread state: %s",e,j.type);return}if(i.has(e)){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_UPDATE_MIDDLEWARE,key:"unbump_already_processed"});return}i.add(e);if(!(h||(h=d("I64"))).equal(g.lastActivityTimestampMs,f))return;d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_UPDATE_MIDDLEWARE,key:"unbump_on_thread_load"});j=babelHelpers["extends"]({},g,{lastActivityTimestampMs:b});yield a.threads.put(j)});return j.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUpdateContactAsConnectedHandler",["FBLogger","I64","LSAddMessengerContactStoredProcedure","LSContactViewerRelationship","LSFactory","LSIntEnum","LSOptimisticAcceptMessageRequestStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWUpdateLSThreadCapabilities","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=e.contactUserId;e=e.threadJid;var g=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.contacts).getKeyRange((i||(i=d("I64"))).of_string(f))));if(g==null){c("FBLogger")("maw_bridge").warn("Missing contact in MAWBridgeUpdateContactAsConnectedHandler");return}var k=babelHelpers["extends"]({},g,{contactViewerRelationship:(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactViewerRelationship").CONTACT_OF_VIEWER)});return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e,"MAWBridgeUpdateContactAsConnectedHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){yield (h||(h=b("Promise"))).allSettled([a.contacts.upsert([g.id],k),c("LSAddMessengerContactStoredProcedure")(c("LSFactory")(a),{contactId:g.id}),d("MAWUpdateLSThreadCapabilities").updateNonMessageRequestThreadTxn(a,e),c("LSOptimisticAcceptMessageRequestStoredProcedure")(c("LSFactory")(a),{threadKey:e})])});return function(b,c){return a.apply(this,arguments)}}())});return k.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler",["LSFactory","LSUpdateE2EEMetadataParticipantsStoredProcedure","MAWMiActOnMiThreadReadyForJid"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeThreadsLoadedHandler",function(a,b){return c("LSUpdateE2EEMetadataParticipantsStoredProcedure")(c("LSFactory")(a),{threadKey:b})})}g.call=a}),98);
__d("MAWBridgeUpdateMessageRangeHandler",["I64","LSClearMessagePlaceholderRangeStoredProcedure","LSFactory","LSInsertNewMessageRangeStoredProcedure","MAWMiActOnMiThreadReadyForJid","MAWTimeUtils","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeUpdateMessageRangeHandler",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f,g;yield c("LSClearMessagePlaceholderRangeStoredProcedure")(c("LSFactory")(a),{maxTimestampMs:d("MAWTimeUtils").MAX_TIMESTAMP_MS,messageId:"",threadKey:b});var i=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages_ranges_v2__generated).getKeyRange(b)));i!=null&&(yield a.messages_ranges_v2__generated["delete"](i.threadKey,i.minTimestampMs,i.minMessageId));var j=e.hasMoreAfter,k=e.hasMoreBefore,l=e.maxMsgId,m=e.minMsgId;f=k&&e.minMsgTs!=null?(h||(h=d("I64"))).of_float(e.minMsgTs):(f=i==null?void 0:i.minTimestampMs)!=null?f:d("MAWTimeUtils").MIN_TIMESTAMP_MS;var n=(i==null?void 0:i.minTimestampMs)!=null&&(h||(h=d("I64"))).lt(i==null?void 0:i.minTimestampMs,f),o=j&&e.maxMsgTs!=null?(h||(h=d("I64"))).of_float(e.maxMsgTs):d("MAWTimeUtils").MAX_TIMESTAMP_MS,p=d("MAWTimeUtils").MIN_TIMESTAMP_MS;g=(g=o)!=null?g:d("MAWTimeUtils").MAX_TIMESTAMP_MS;return c("LSInsertNewMessageRangeStoredProcedure")(c("LSFactory")(a),{hasMoreAfter:j,hasMoreBefore:n?(a=i==null?void 0:i.hasMoreBefore)!=null?a:!0:k,lowerOverlap:p,newMaxMid:(j=l)!=null?j:"",newMaxTs:o,newMinMid:n?(a=i==null?void 0:i.minMessageId)!=null?a:"":(k=m)!=null?k:"",newMinTs:n?(p=i==null?void 0:i.minTimestampMs)!=null?p:d("MAWTimeUtils").MIN_TIMESTAMP_MS:f,threadKey:b,upperOverlap:g})});return function(b,c){return a.apply(this,arguments)}}())}g.call=a}),98);
__d("MAWBridgeUpdateMinMessageHandler",["I64","MAWMiActOnMiThreadReadyForJid","ReQL","ReQLTable","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=(h||(h=d("I64"))).of_float(b.minTimestampMs),f=b.minMessageId;return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeUpdateMinMessageHandler",function(a,g){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(g)).then(function(h){if(h==null)return;var i=b.hasMoreBefore,j=i!=null?i:h.hasMoreBefore;return d("ReQLTable").update(a.messages_ranges_v2__generated,[g,h.minTimestampMs,h.minMessageId],function(a){if(a!=null)return{hasMoreAfter:a.hasMoreAfter,hasMoreBefore:j,isLoadingAfter:a.isLoadingAfter,isLoadingBefore:a.isLoadingBefore,maxMessageId:a.maxMessageId,maxTimestampMs:a.maxTimestampMs,minMessageId:f,minTimestampMs:e,threadKey:a.threadKey};throw c("unrecoverableViolation")("Thread is missing in updating the min message in message range","maw_threads")})})})}g.call=a}),98);
__d("MAWBridgeXMAShareExpiredHandler",["MAWMiActOnMiThreadReadyForJid","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,c,d){var e=String(d.xmaId);return a.attachments.get(c,d.msgId,e).then(function(f){if(f==null)return(h||(h=b("Promise"))).resolve();f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(Boolean);f=f.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(f).then(function(){return a.attachments["delete"](c,d.msgId,e)})})}function a(a,b){return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,b.threadJid,"MAWBridgeXMAShareExpiredHandler",function(a,c){return i(a,c,b)})}g.callWithoutWaitingForAnything=i;g.call=a}),98);
__d("MAWBridgeXMAShareTombstonedHandler",["FBLogger","MAWMiActOnMiThreadReadyForJid","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=String(e.xmaId);return d("MAWMiActOnMiThreadReadyForJid").onMiThreadReadyForJidNoThrow(a,e.threadJid,"MAWBridgeXMAShareTombstonedHandler",function(a,g){return a.attachments.get(g,e.msgId,f).then(function(i){if(i==null)return(h||(h=b("Promise"))).resolve();i=[i.defaultCtaId,i.attachmentCta1Id,i.attachmentCta2Id,i.attachmentCta3Id].filter(Boolean);i=i.map(function(b){return a.attachment_ctas["delete"](b)});return(h||(h=b("Promise"))).all(i).then(function(){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(g,e.msgId,f)).then(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d){if(d!=null){d=babelHelpers["extends"]({},d,{attachmentCta1Id:void 0,attachmentCta2Id:void 0,attachmentCta3Id:void 0,cta1Title:void 0,cta1Type:void 0,cta2Title:void 0,cta2Type:void 0,cta3Title:void 0,cta3Type:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,previewHeight:void 0,previewHeightLarge:void 0,previewWidth:void 0,previewWidthLarge:void 0,subtitleText:void 0,titleText:void 0});yield a.attachments.put(d)}c("FBLogger")("messenger_web_sharing").blameToPreviousFrame().mustfix("Trying to tombstone a secure xma attachment but no existing attachment");return(h||(h=b("Promise"))).resolve()});return function(a){return d.apply(this,arguments)}}())})})})}g.call=a}),98);
__d("isInstamadilloDYI",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("665")===!0}g["default"]=a}),98);
__d("MAWBridgeUIEventHandler",["FBLogger","MAWAbPropsClient","MAWBridgeAddMessageSearchResultHandler","MAWBridgeCallRestoreNativeOpHandler","MAWBridgeCentralizedThreadUpdateHandler","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessageRangesV2Handler","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteReactionHandler","MAWBridgeDropAllSecureThreadsHandler","MAWBridgeEditMsgHistoryAddedHandler","MAWBridgeFulfillRestorePromisePayloadHandler","MAWBridgeGroupInfoUpdatedHandler","MAWBridgeGroupInviteLoadedHandler","MAWBridgeGroupInviteUpdateHandler","MAWBridgeHandleCOPDigest","MAWBridgeMediaExpiredHandler","MAWBridgeMsgRangeLoadedHandler","MAWBridgeMsgUpdatedHandler","MAWBridgeMsgsLoadedHandler","MAWBridgeMsgsStartCountdownHandler","MAWBridgeNewMediaHandler","MAWBridgeNewMediaRangeHandler","MAWBridgeNewMsgHandler","MAWBridgeNewPollHandler","MAWBridgeNewReceiverFetchInfoHandler","MAWBridgeNewXMAHandler","MAWBridgeOccamadilloCreateE2EEMetadataThreadHandler","MAWBridgeOccamadilloVerifyThreadExistsHandler","MAWBridgeOneToOneMessageRequestLoadedHandler","MAWBridgeParticipantRemovedHandler","MAWBridgeParticipantUpdatedHandler","MAWBridgeParticipantsUpdatedHandler","MAWBridgeRavenActionMsgForUIHandler","MAWBridgeReactionUpsertHandler","MAWBridgeReceivedChatStateHandler","MAWBridgeReceivedReceiptHandler","MAWBridgeRefreshContactHandler","MAWBridgeRemoveMessageSearchResultHandler","MAWBridgeSyncContacts","MAWBridgeThreadHiddenV2Handler","MAWBridgeThreadTimestampsHandler","MAWBridgeThreadUpdatedHandler","MAWBridgeUIEventQueueQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUnbumpOnThreadLoadHandler","MAWBridgeUpdateClientRestoreStatus","MAWBridgeUpdateContactAsConnectedHandler","MAWBridgeUpdateE2EEMetadataParticipantsHandler","MAWBridgeUpdateMessageRangeHandler","MAWBridgeUpdateMinMessageHandler","MAWBridgeXMAShareExpiredHandler","MAWBridgeXMAShareTombstonedHandler","MAWEphemeralMessageExpirationStorage","MAWLoggerUtils","Promise","WAResultOrError","WATagsLogger","WATimeUtils","asyncToGeneratorRuntime","cr:15985","cr:15986","cr:15987","cr:16021","cr:16022","cr:16023","cr:16024","cr:16025","cr:16026","cr:16027","cr:16028","emptyFunction","getErrorSafe","isArmadillo","isInstamadilloDYI","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Handle UI Events: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Attempted to call the old DYI V1 flow"]);k=function(){return a};return a}function l(a,e,f){switch(f.tag){case"NewMsg":return d("MAWBridgeNewMsgHandler").call(e,f.value);case"MsgsStartCountdown":return d("MAWBridgeMsgsStartCountdownHandler").call(e,f.value);case"MsgClearCountdown":return(h||(h=b("Promise"))).resolve(d("MAWEphemeralMessageExpirationStorage").clearMessageFromExpiration(f.value));case"DropAllSecureThreads":return d("MAWBridgeDropAllSecureThreadsHandler").call(e);case"VerifyThreadExists":var g=f.value;return d("MAWBridgeOccamadilloVerifyThreadExistsHandler").call(e,g);case"CreateE2EEMetadataThread":return d("MAWBridgeOccamadilloCreateE2EEMetadataThreadHandler").call(e,f.value);case"EditMsgHistoryAdded":return d("MAWBridgeEditMsgHistoryAddedHandler").call(a,e,f.value);case"MsgUpdated":return d("MAWBridgeMsgUpdatedHandler").call(e,f.value);case"NewMedia":return d("MAWBridgeNewMediaHandler").call(e,f.value);case"NewMediaRange":return d("MAWBridgeNewMediaRangeHandler").call(e,f.value);case"MediaExpired":return d("MAWBridgeMediaExpiredHandler").call(e,f.value);case"XMAShareExpired":return d("MAWBridgeXMAShareExpiredHandler").call(e,f.value);case"NewXMA":return d("MAWBridgeNewXMAHandler").call(e,f.value);case"XMAShareTombstoned":return d("MAWBridgeXMAShareTombstonedHandler").call(e,f.value);case"ParticipantUpdated":return d("MAWBridgeParticipantUpdatedHandler").call(e,f.value);case"ParticipantRemoved":return d("MAWBridgeParticipantRemovedHandler").call(e,f.value);case"UpdateE2EEMetadataParticipants":return d("MAWBridgeUpdateE2EEMetadataParticipantsHandler").call(e,f.value);case"ReceivedReceipt":return d("MAWBridgeReceivedReceiptHandler").call(e,f.value);case"ThreadUpdated":return d("MAWBridgeThreadUpdatedHandler").call(e,f.value);case"GroupInfoUpdated":return d("MAWBridgeGroupInfoUpdatedHandler").call(e,f.value);case"CentralizedThreadUpdate":return d("MAWBridgeCentralizedThreadUpdateHandler").call(e,f.value);case"UnbumpOnThreadLoad":return d("MAWBridgeUnbumpOnThreadLoadHandler").call(e,f.value);case"ThreadTimestampsUpdated":return d("MAWBridgeThreadTimestampsHandler").call(e,f.value);case"MsgsLoaded":return d("MAWBridgeMsgsLoadedHandler").call(e,f.value);case"MsgRangeLoaded":return d("MAWBridgeMsgRangeLoadedHandler").call(e,f.value);case"StartTrace":return b("cr:16023").call(e,f.value);case"UpdateTrace":return b("cr:16026").call(e,f.value);case"ThreadHiddenV2":return d("MAWBridgeThreadHiddenV2Handler").call(e,f.value);case"SyncContacts":return d("MAWBridgeSyncContacts").call(e,f.value);case"ReceivedChatState":return d("MAWBridgeReceivedChatStateHandler").call(e,f.value);case"ClockSkewUpdated":return(h||(h=b("Promise"))).resolve(d("WATimeUtils").setClockSkew(f.value));case"ABPropsUpdated":c("FBLogger")("messenger_e2ee_web").warn("[messenger_e2ee_web] ABPropsUpdated has been deprecated. Please use the bridge with ABPropsUpdated");return(h||(h=b("Promise"))).resolve(d("MAWAbPropsClient").rewrite(f.value));case"COPDigestReceived":return d("MAWBridgeHandleCOPDigest").call(e,f.value);case"UpsertReaction":return d("MAWBridgeReactionUpsertHandler").call(e,f.value);case"DeleteReaction":return d("MAWBridgeDeleteReactionHandler").call(e,f.value);case"UploadMessage":return b("cr:16028").call(e,f.value);case"UploadMessageByBatch":return b("cr:16027").call(e,f.value);case"DeleteMessagesOfThread":return b("cr:16021").call(e,f.value);case"UploadAttachment":return b("cr:15987").call(e,f.value);case"ResignAttachmentCDNUrl":return b("cr:15986").call(e,f.value);case"DeleteMessages":return d("MAWBridgeDeleteMessagesHandler").call(e,f.value);case"RestoreMessageBatch":d("WATagsLogger").TAGS(["labyrinth_web","labyrinth_dyi"]).WARN(k());return(h||(h=b("Promise"))).resolve();case"OneToOneMessageRequestLoaded":return d("MAWBridgeOneToOneMessageRequestLoadedHandler").call(e,f.value);case"GroupInviteUpdate":return d("MAWBridgeGroupInviteUpdateHandler").call(e,f.value);case"UpdateDyiStatus":d("WATagsLogger").TAGS(["labyrinth_web","labyrinth_dyi"]).WARN(j());return(h||(h=b("Promise"))).resolve();case"DeleteGroupInvite":return d("MAWBridgeDeleteGroupInviteHandler").call(e,f.value);case"TraceRecordCheckpoint":return b("cr:16025").call(e,f.value);case"DeleteMessageRangesV2":return d("MAWBridgeDeleteMessageRangesV2Handler").call(e,f.value);case"UpdateMinMessage":return d("MAWBridgeUpdateMinMessageHandler").call(e,f.value);case"IssuePointQuery":return b("cr:16022").call(e,f.value);case"ParticipantsUpdated":return d("MAWBridgeParticipantsUpdatedHandler").call(e,f.value);case"StartTraceWithTraceId":return b("cr:16024").call(e,f.value);case"UpdateClientRestoreStatus":return d("MAWBridgeUpdateClientRestoreStatus").call(e,f.value);case"NewMsgs":return d("MAWBridgeNewMsgHandler").bulkCall(e,f.value.msgs);case"UnArchivedSelfDeviceChangeAlerts":return d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(e,f.value);case"EphemeralSettingsUpdatedForUI":return b("cr:15985").call(e,f.value);case"RavenActionUpdate":return d("MAWBridgeRavenActionMsgForUIHandler").call(e,f.value);case"GroupInviteLoaded":return d("MAWBridgeGroupInviteLoadedHandler").call(e,f.value);case"UpdateMessageRange":return d("MAWBridgeUpdateMessageRangeHandler").call(e,f.value);case"RemoveMessageSearchResult":return d("MAWBridgeRemoveMessageSearchResultHandler").call(e,f.value);case"AddMessageSearchResult":return d("MAWBridgeAddMessageSearchResultHandler").call(a,e,f.value);case"FulfillRestorePromise":return d("MAWBridgeFulfillRestorePromisePayloadHandler").call(f.value);case"UpdateContactAsConnected":return d("MAWBridgeUpdateContactAsConnectedHandler").call(e,f.value);case"RefreshContact":return d("MAWBridgeRefreshContactHandler").call(e,f.value);case"NewReceiverFetchInfo":return d("MAWBridgeNewReceiverFetchInfoHandler").call(e,f.value);case"RestoreNativeOp":return d("MAWBridgeCallRestoreNativeOpHandler").call(e,f.value);case"NewPoll":return d("MAWBridgeNewPollHandler").call(e,f.value);default:return(h||(h=b("Promise"))).resolve()}}function a(a,b){if(!c("isArmadillo")()&&!c("isInstamadilloDYI")()){c("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","maw_worker");return}if(!(b.length===1&&b[0].tag==="TraceRecordCheckpoint")){var e={};e=b.reduce(function(a,b){a[b.tag]=((b=a[b.tag])!=null?b:0)+1;return a},e);d("WATagsLogger").TAGS(["MAWBridgeUIEvent"]).LOG(i(),e)}c("promiseDone")(m(a,b),c("emptyFunction"),function(a){c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[MAWBridgeUIEventHandler] Failed to handle UI events: %s",b.map(function(a){return a.tag}).join(", "))})}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var g=(yield a);a=d("MAWLoggerUtils").getInstanceKey();var h=e.map(function(a){return a.tag}),i="";d("MAWBridgeUIEventQueueQPLLogger").start(a,h);d("MAWBridgeUIEventQueueQPLLogger").addAnnotations(a,{"int":{queue_size:e.length}});var j;try{j=(yield g.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){for(var b=0;b<e.length;b++){var f=e[b];try{yield l(g,a,f)}catch(a){i=f.tag;return d("WAResultOrError").makeError(c("getErrorSafe")(a))}}return d("WAResultOrError").makeResult(!0)});return function(b){return a.apply(this,arguments)}}(),"readwrite","background",{events:e,type:"maw_ui_bridge"},f.id+":315"))}catch(a){j=d("WAResultOrError").makeError(c("getErrorSafe")(a))}!j.success?(d("MAWBridgeUIEventQueueQPLLogger").endFailure(a,i),c("FBLogger")("messenger_e2ee_web").catching(j.error).mustfix("MAWBridgeUIEventHandler] Did not commit UI events to DB: %s",h.toString())):d("MAWBridgeUIEventQueueQPLLogger").endSuccess(a)});return n.apply(this,arguments)}function e(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){try{yield l(a,b,d)}catch(b){a=c("getErrorSafe")(b);c("FBLogger")("messenger_e2ee_web").catching(a).mustfix("[handleShimEvent] Failed to handle UI event: %s",d.tag);throw b}});return o.apply(this,arguments)}g.handleEvents=a;g.handleShimEvent=e}),98);
__d("MAWBridgeUpdateDYIStatusV2",["EncryptedBackupdDYIFileSaver","EncryptedBackupsDYIFileUtils","EncryptedBackupsDYITypes","FBLogger","QPLUserFlow","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("EncryptedBackupdDYIFileSaver").saveFile(a,b),window.setTimeout(function(){c("promiseDone")(e())},1e3)});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.qplEvent,f=a.qplInstanceKeyE2E;a=a.status;var g=c("FBLogger")("[labyrinth_web][dyi]");if(a===d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Completed)try{if(navigator.storage==null)throw g.mustfixThrow("Storage management API is not supported. Please try one of the supported browsers.");var i=d("EncryptedBackupsDYIFileUtils").DyiArchiveFilename,j=(yield d("EncryptedBackupsDYIFileUtils").getRootFolderHandle()),k=(yield d("EncryptedBackupsDYIFileUtils").readFile(j,i));yield h(i,k,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield j.removeEntry(i)}));g.info("Saving file with filename ",i);e!=null&&f!=null&&c("QPLUserFlow").endSuccess(e,{instanceKey:f});g.info("DYI Complete")}catch(a){g.mustfix("Failed to download the DYI archive: %s",a);e!=null&&f!=null&&c("QPLUserFlow").endFailure(e,a.message,{instanceKey:f});return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed}a===d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed&&(e!=null&&f!=null&&c("QPLUserFlow").endFailure(e,"Unknown error",{instanceKey:f}));return a});return j.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUpdateTraceHandler",["ArmadilloDataTraceCheckPoint","I64","LSAppendDataTraceAddonStoredProcedure","LSDataTraceCheckPoint","LSFactory","LSIntEnum","MAWBridgeTraceEvent","Promise","ReQL","emptyFunction","updateAndFlushLSDataTrace"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,e,f){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.data_trace_meta).filter(function(a){var b=a.contextThree;if(b!=null&&e.externalIds.includes(b)&&(j||(j=d("I64"))).equal(a.traceType,e.traceType))return a.shouldFlush===!1;else return!1})).then(function(g){var i=[];return g.reduce(function(b,g){return b.then(function(){i.push(g.traceId);var b=e.errorMessage;if(b!=null)return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:f,dataTraceId:g.traceId,errorMessage:b,syncChannel:(j||(j=d("I64"))).neg_one});else return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:f,dataTraceId:g.traceId,syncChannel:(j||(j=d("I64"))).neg_one})})},(h||(h=b("Promise"))).resolve()).then(function(){return i})})}function l(a,d){return d.reduce(function(b,d){return b.then(function(){return c("updateAndFlushLSDataTrace")(a,d)})},(h||(h=b("Promise"))).resolve())}function a(a,e){var f=e.event;if(f===c("MAWBridgeTraceEvent").ReceivedReceipt)return k(a,e,d("ArmadilloDataTraceCheckPoint").deliveryReceiptReceived).then(function(b){return l(a,b)});else if(f===c("MAWBridgeTraceEvent").ReceivedSent)return k(a,e,d("ArmadilloDataTraceCheckPoint").advancedCryptoMEMSendTaskComplete).then(c("emptyFunction"));else if(f===c("MAWBridgeTraceEvent").FlowEndForFailure)return k(a,e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE)).then(function(b){return l(a,b)});else if(f===c("MAWBridgeTraceEvent").FlowEndForSuccess)return k(a,e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH)).then(function(b){return l(a,b)});else return(h||(h=b("Promise"))).resolve()}g.call=a}),98);
__d("MAWBridgeUpdateTraceHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeUpdateTraceHandler").__setRef("MAWBridgeUpdateTraceHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeUploadMessageByBatchGQLHandler",["FBLogger","MAWBridgeSafeActionsWorkerAndUI","MAWEBFrontendQPLLogger","WAResultOrError","asyncToGeneratorRuntime","cr:8110"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e.messages,"upload_tracking_bridge_batch_handler_gql");var f=(yield b("cr:8110").call(a,e.messages));if(f.success){a=e.messages.map(function(a){if(a.uploadTrackingInstanceKey!=null)return{instanceKey:a.traceId,success:!0};else return null}).filter(Boolean);d("MAWBridgeSafeActionsWorkerAndUI").fireAndForgetBackendWorkerAndUIShared("ackWithInstanceKeyBatched",{instancesWithOutcomes:a});c("FBLogger")("labyrinth_web").info("Successfully completed GQL upload batch of size %s",e.messages.length);return d("WAResultOrError").makeResult()}e.messages.forEach(function(a){a.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").failEBUploadTracking(a.uploadTrackingInstanceKey,"gql_upload_failed",{string:{error:f.error}})});return d("WAResultOrError").makeError(f.error)});return h.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUploadMessageByBatchHandler",["MAWBridgeTraceRecordCheckpointHandler","MAWBridgeUploadMessageHandler","MAWEBFrontendQPLLogger","Promise","QPLUserFlow","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){a.forEach(function(a){a.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(a.uploadTrackingInstanceKey,b)})}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){i(e.messages,"upload_tracking_bridge_batch_handler");e.qpl.forEach(function(a){return c("QPLUserFlow").addPoint(a.event,a.action.name,{instanceKey:a.instanceKey,timestamp:a.timestamp})});e.checkPoint.forEach(function(b){return c("promiseDone")(d("MAWBridgeTraceRecordCheckpointHandler").call(a,b))});for(e of e.messages)yield d("MAWBridgeUploadMessageHandler").call(a,e);return(h||(h=b("Promise"))).resolve()});return j.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUploadMessageByBatchHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeUploadMessageByBatchHandler").__setRef("MAWBridgeUploadMessageByBatchHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MAWBridgeUploadMessageGQLHandlerSingleTxn",["EBIsEbEnabled","EncryptedBackupsWriteToMPSTables","MAWBridgeGQLUploadUtils","MAWEBFalcoLoggerUtils","MAWEBFrontendQPLLogger","MWEBODSCategory","MWEBODSEntityName.enum","MWEBODSUtils","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","ODS","Promise","WAResultOrError","asyncToGeneratorRuntime","gkx","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){try{if(c("isInstamadilloEB")()){d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_cancelled_instamadillo");e.forEach(function(a){var b=a.echoDocument!=null?"dual_upload":"protobuf_only";d("MAWEBFalcoLoggerUtils").logEBFalcoTaskFailure(a,b,"gql_cancelled_instamadillo")});return d("WAResultOrError").makeError("gql_cancelled_instamadillo")}d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_handler_single_txn_start");var g="mps_write_failure",h=(yield a.runInTransaction(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(!(yield d("EBIsEbEnabled").isEbEnabledLS(a.tables))){e.forEach(function(a){if(a.uploadTrackingInstanceKey!=null){var b,e=a.uploadTrackingInstanceKey;d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e,"user_device_not_enrolled_invalid_gql_request");var f=d("MWEBUseLocalStorage").mwEBGetIsLocalStorageEntryValuePresent(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b=(b=d("MWEBUseLocalStorage").mwEBGetLocalStorageEntryValue(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE))!=null?b:"no";f={bool:{wasEBEnabledPreviously:f},string:{wasEBSMWiped:b}};b=a.echoDocument!=null?"dual_upload":"protobuf_only";d("MAWEBFalcoLoggerUtils").logEBFalcoTaskSkipped(a,b,"user_device_not_enrolled");d("MAWEBFrontendQPLLogger").endEBUploadTracking(e,f)}});var f=[];g="user_device_not_enrolled";return f}else{d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_handler_mps_write_start");f=(yield k(b,e));d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_handler_mps_write_end");return f}});return function(a){return f.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":83"));h=h.filter(Boolean);if(h.length===0)return d("WAResultOrError").makeError(g);(i||(i=d("ODS"))).bumpEntityKey(c("MWEBODSCategory"),c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,"graphql.batch.size."+h.length);i.bumpEntityKey(c("MWEBODSCategory"),c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,"graphql.batch.bucket"+d("MWEBODSUtils").getBucketName(h.length));d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_handler_upload_start");h.forEach(function(a){var b=a.echoDocument!=null?"dual_upload":"protobuf_only";d("MAWEBFalcoLoggerUtils").logEBFalcoTaskIssued(a,b)});var j=(yield d("MAWBridgeGQLUploadUtils").uploadMessageOverGQL(a,h));d("MAWEBFrontendQPLLogger").addPointForUploadMessageArray(e,"upload_tracking_gql_handler_single_txn_end");!j.success?h.forEach(function(a){var b=a.echoDocument!=null?"dual_upload":"protobuf_only";d("MAWEBFalcoLoggerUtils").logEBFalcoTaskFailure(a,b,j.error)}):h.forEach(function(a){d("MAWEBFalcoLoggerUtils").logEBFalcoEncryptedBackupUploadSuccess(a)});return j}catch(a){e.forEach(function(b){var c=b.echoDocument!=null?"dual_upload":"protobuf_only";d("MAWEBFalcoLoggerUtils").logEBFalcoTaskFailure(b,c,a.message);b.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").failEBUploadTracking(b.uploadTrackingInstanceKey,"gql_upload_runtime_error",a instanceof Error?{string:{runtime_error:a.message}}:void 0)});return d("WAResultOrError").makeError("gql_upload_runtime_error")}});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e.protoMsg;if(c("gkx")("23966")&&f!=null){f=f.backupActionType===1?(h||(h=b("Promise"))).all([d("EncryptedBackupsWriteToMPSTables").writeToMPSTables(a,f,e.threadId,!1),d("EncryptedBackupsWriteToMPSTables").writeTagsToMPSTables(a,f,e.threadId)]):d("EncryptedBackupsWriteToMPSTables").writeToMPSTables(a,f,e.threadId,!1);f=(yield f.then(function(){return e},function(a){e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").failEBUploadTracking(e.uploadTrackingInstanceKey,"upload_tracking_gql_handler_failed_mps_write",{string:{error:a.message,errorMsgType:e.messageType}});return null}));return f}return e});return function(a){return e.apply(this,arguments)}}());e=(yield (h||(h=b("Promise"))).all(e));return e.filter(Boolean)});return l.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUploadMessageHandlerDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeUploadMessageHandler").__setRef("MAWBridgeUploadMessageHandlerDeferred");function a(a,b){return h.load().then(function(c){return c.call(a,b)})}g.call=a}),98);
__d("MWXIconMenuItemHouseKeyhole",["MWXSvgIcon","SVGIcon","cr:12821","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12821")),c("gkx")("23219"));g["default"]=a}),98);
__d("MAWSecurityAlertsBadgeMenuItem.react",["fbt","ARIA_LABEL_PLACEHOLDER_FIXME","FDSNumberedBadge.react","JSResourceForInteraction","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWXIconMenuItemHouseKeyhole","MWXMenuItem.react","gkx","react","react-compiler-runtime","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=c("JSResourceForInteraction")("MAWSecurityAlertsDialog.react").__setRef("MAWSecurityAlertsBadgeMenuItem.react");function a(a){var b=d("react-compiler-runtime").c(9);a=a.count;var e=c("useMWXLazyDialog")(l),f=e[0];e=k(c("MWJewelPopoverDialogContext.react"));var g=e.setIsOpenForDialog;e=c("gkx")("23219");var i;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"__JHASH__UwQqfUGZ3gt__JHASH__"),b[0]=i):i=b[0];i=i;b[1]!==a?(e={badge:j.jsx(c("FDSNumberedBadge.react"),{accessibilityText:c("ARIA_LABEL_PLACEHOLDER_FIXME"),color:e?"red":"lightBlue",value:a}),type:"numberedBadge"},b[1]=a,b[2]=e):e=b[2];b[3]!==g||b[4]!==f?(a=function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","security_alerts"),g(!0),f({})},b[3]=g,b[4]=f,b[5]=a):a=b[5];b[6]!==e||b[7]!==a?(i=j.jsx(c("MWXMenuItem.react"),{auxItem:e,icon:c("MWXIconMenuItemHouseKeyhole"),id:"security_alerts_badge_menu_item",onClick:a,primaryText:i}),b[6]=e,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MAWSecurityAlertsBadgeMenuItemWrapper.react",["MAWSecurityAlertsBadgeMenuItem.react","react","react-compiler-runtime","useMAWSecurityAlertsPreferences"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;function a(a){var b=d("react-compiler-runtime").c(3);a=a.value;var e=c("useMAWSecurityAlertsPreferences")();e=e.securityAlertsPreferences;e==null?void 0:e.allowSecurityAlertForSelf;var f;b[0]!==(e==null?void 0:e.allowSecurityAlertForSelf)||b[1]!==a?(f=(e==null?void 0:e.allowSecurityAlertForSelf)?i.jsx(c("MAWSecurityAlertsBadgeMenuItem.react"),{count:a}):null,b[0]=e==null?void 0:e.allowSecurityAlertForSelf,b[1]=a,b[2]=f):f=b[2];e=f;return e}g["default"]=a}),98);
__d("MAWSecurityAlertsMenuItem.react",["fbt","JSResourceForInteraction","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWXMenuItem.react","react","react-compiler-runtime","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=c("JSResourceForInteraction")("MAWSecurityAlertsDialog.react").__setRef("MAWSecurityAlertsMenuItem.react");function a(){var a=d("react-compiler-runtime").c(7),b=c("useMWXLazyDialog")(l),e=b[0];b=k(c("MWJewelPopoverDialogContext.react"));var f=b.setIsOpenForDialog;a[0]!==f||a[1]!==e?(b=function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","security_alerts"),f(!0),e({})},a[0]=f,a[1]=e,a[2]=b):b=a[2];var g,i;a[3]===Symbol["for"]("react.memo_cache_sentinel")?(g=h._(/*BTDS*/"__JHASH__J377dyVYOvt__JHASH__"),i=h._(/*BTDS*/"__JHASH__UTcDai7d8DF__JHASH__"),a[3]=g,a[4]=i):(g=a[3],i=a[4]);a[5]!==b?(g=j.jsx(c("MWXMenuItem.react"),{onClick:b,primaryText:g,secondaryText:i,testid:void 0}),a[5]=b,a[6]=g):g=a[6];return g}g["default"]=a}),226);
__d("getE2EEPreviewsHelpCenterArticleLink",["XFacebookHelpCenterContentControllerRouteBuilder","XMessengerHelpCenterContentControllerRouteBuilder","gkx"],(function(a,b,c,d,e,f,g){"use strict";b="820841429347610";d=c("gkx")("23433");e=d?c("XMessengerHelpCenterContentControllerRouteBuilder"):c("XFacebookHelpCenterContentControllerRouteBuilder");var h=e.buildUri({cms_id:b,ref:"nux"}).toString();function a(){return h}g["default"]=a}),98);
__d("useToggleXMAPreviewSettingsState",["LSFactory","LSUpdateE2eeXmaPreviewSettings","promiseDone","react","react-compiler-runtime","useAsyncReStore","useXMAPreviewsDisabledSetting"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(6),b=c("useAsyncReStore")(),e=c("useXMAPreviewsDisabledSetting")(),g;a[0]!==b||a[1]!==e?(g=function(){c("promiseDone")(b,function(a){c("promiseDone")(a.runInTransaction(function(a){return c("LSUpdateE2eeXmaPreviewSettings")(!e,c("LSFactory")(a))},"readwrite",void 0,void 0,f.id+":26"))})},a[0]=b,a[1]=e,a[2]=g):g=a[2];g=g;var h;a[3]!==g||a[4]!==e?(h=[e,g],a[3]=g,a[4]=e,a[5]=h):h=a[5];return h}g["default"]=a}),98);
__d("MAWXMAPreviewsSettingsMenuItem.react",["fbt","FDSMenuItemCheckbox.react","JSResourceForInteraction","MWXLink.react","MWXMenuItem.react","MWXMenuItemWithSubmenu.react","MWXText.react","getE2EEPreviewsHelpCenterArticleLink","justknobx","react","react-compiler-runtime","useMWXLazyDialog","useToggleXMAPreviewSettingsState","useXMAPreviewsDisabledSetting"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._(/*BTDS*/"__JHASH__JWbFdA1Rx6I__JHASH__"),l=h._(/*BTDS*/"__JHASH__kWP0qUys9Dw__JHASH__");function m(){var a=d("react-compiler-runtime").c(9),b=c("useToggleXMAPreviewSettingsState")(),e=b[0],f=b[1];b=!e;a[0]!==f?(e=function(){f()},a[0]=f,a[1]=e):e=a[1];var g;a[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=h._(/*BTDS*/"__JHASH__M9Dqysg6PV6__JHASH__"),a[2]=g):g=a[2];var i;a[3]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"__JHASH__mhkvcFa46YK__JHASH__"),a[3]=i):i=a[3];var k;a[4]===Symbol["for"]("react.memo_cache_sentinel")?(k=c("getE2EEPreviewsHelpCenterArticleLink")(),a[4]=k):k=a[4];a[5]===Symbol["for"]("react.memo_cache_sentinel")?(i=j.jsxs(c("MWXText.react"),{color:"secondary",type:"body4",children:[i,j.jsxs(c("MWXLink.react"),{display_DEPRECATED:"inline",href:k,rel:"noreferrer",target:"_blank",children:[" ",h._(/*BTDS*/"__JHASH__R4ScHt7aueT__JHASH__")]})]}),a[5]=i):i=a[5];a[6]!==b||a[7]!==e?(k=j.jsx(c("FDSMenuItemCheckbox.react"),{asSwitch:!0,isSelected:b,onClick:e,preventClosingMenuOnSelect:!0,primaryText:g,secondaryText:i}),a[6]=b,a[7]=e,a[8]=k):k=a[8];return k}var n=c("JSResourceForInteraction")("MAWXMAPreviewSettingsDialog.react").__setRef("MAWXMAPreviewsSettingsMenuItem.react");function a(){var a=d("react-compiler-runtime").c(3),b=c("useXMAPreviewsDisabledSetting")(),e=c("useMWXLazyDialog")(n),f=e[0];a[0]!==f||a[1]!==b?(e=c("justknobx")._("3913")?j.jsx(c("MWXMenuItem.react"),{auxItem:{auxText:b?h._(/*BTDS*/"__JHASH__OV_Z0FbKms9__JHASH__"):h._(/*BTDS*/"__JHASH__1G8IbFn5AD___JHASH__"),type:"text"},onClick:function(){return f({})},primaryText:k,secondaryText:l}):j.jsx(c("MWXMenuItemWithSubmenu.react"),{primaryText:k,secondaryText:l,submenu:{header:{title:k},items:[j.jsx(m,{},"xma-previews")]}}),a[0]=f,a[1]=b,a[2]=e):e=a[2];return e}g["default"]=a}),226);
__d("MWChatEncryptedBackupsAddDeviceWithEBKeys",["EBSMAPI","EBWorkerODSEntityName.enum","cr:17162","cr:17321"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var d=a.backupId,e=a.db,f=a.newDeviceRegistrationId,g=a.previousDeviceId;return c("EBSMAPI").addDeviceWithEBKeys({backupId:d,db:e,newDeviceRegistrationId:f,odsEntityName:c("EBWorkerODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH_MAIN_THREAD,previousDeviceId:g,trackAddingDevice:function(a){void (b("cr:17162")==null?void 0:b("cr:17162").trackAddingDevice({deviceId:a}))}}).then(function(){return b("cr:17321")==null?void 0:b("cr:17321").fireAndForget("backend","addDeviceWithKeysInWorker",{backupId:d,deviceRegistrationId:f,isAutoRestore:!0,previousDeviceId:g})})}g.addDeviceWithEBKeys=a}),98);
__d("MWChatEncryptedBackupsHandleRestoreWrapper.react",["cr:6736","cr:8598","cr:8599","cr:8601"],(function(a,b,c,d,e,f,g){"use strict";function a(){b("cr:8598")==null?void 0:b("cr:8598")();b("cr:8599")==null?void 0:b("cr:8599")();b("cr:8601")==null?void 0:b("cr:8601")();b("cr:6736")==null?void 0:b("cr:6736")();return null}g["default"]=a}),98);
__d("MWChatSidebarEncryptedBackupsMenuItem.react",["fbt","MAWEncryptedBackupsStateManager","MWChatEncryptedBackupsSettingsDialog.entrypoint","MWEBEntrypointsKillswitch.enum","MWJewelPopoverDialogContext.react","MWXMenuItem.react","promiseDone","react","react-compiler-runtime","requireDeferred","useMWEBBackupState","useMWXEntryPointDialog","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react")),l=j.useContext,m=c("requireDeferred")("MWEncryptedBackupsFetchBackupMetadata").__setRef("MWChatSidebarEncryptedBackupsMenuItem.react"),n=h._(/*BTDS*/"__JHASH__poOqZsY43mp__JHASH__"),o=h._(/*BTDS*/"__JHASH__XgMTfStFEIw__JHASH__");function a(){var a=d("react-compiler-runtime").c(13),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b={},a[0]=b):b=a[0];b=c("useMWXEntryPointDialog")(c("MWChatEncryptedBackupsSettingsDialog.entrypoint"),b);var e=b[0];b=l(c("MWJewelPopoverDialogContext.react"));var f=b.setIsOpenForDialog,g=(i||(i=c("useReStore")))();a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b={entrypoint:c("MWEBEntrypointsKillswitch.enum").EB_SETTINGS},a[1]=b):b=a[1];var j=c("useMWEBBackupState")(b);a[2]!==j||a[3]!==f||a[4]!==e||a[5]!==g?(b=function(){d("MAWEncryptedBackupsStateManager").eligibleForEBUX(j)&&m.onReady(function(a){a=a.fetchBackupMetadata;c("promiseDone")(a(g))}),f(!0),e({})},a[2]=j,a[3]=f,a[4]=e,a[5]=g,a[6]=b):b=a[6];b=b;var p=j===-1||j===1,q;a[7]!==j||a[8]!==p?(q=p?void 0:{auxText:j===3?h._(/*BTDS*/"__JHASH__zuHjNmdQ8AD__JHASH__"):h._(/*BTDS*/"__JHASH__YsrKpzbN1OC__JHASH__"),type:"text"},a[7]=j,a[8]=p,a[9]=q):q=a[9];a[10]!==b||a[11]!==q?(p=k.jsx(c("MWXMenuItem.react"),{auxItem:q,onClick:b,primaryText:n,role:"button",secondaryText:o,testid:void 0}),a[10]=b,a[11]=q,a[12]=p):p=a[12];return p}g["default"]=a}),226);
__d("MWChatSidebarSettingsE2EEChatsMenu.react",["fbt","MAWSecurityAlertsMenuItem.react","MAWXMAPreviewsSettingsMenuItem.react","MWXDivider.react","MWXMenuItemWithSubmenu.react","cr:3079","cr:6692","cr:6733","cr:7398","cr:8596","cr:8597","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k={divider:{marginTop:"x1gslohp",marginBottom:"x12nagc",marginStart:"x1d52u69",marginEnd:"xktsk01",marginLeft:null,marginRight:null,$$css:!0}},l=h._(/*BTDS*/"__JHASH__r6kzKoNm-ho__JHASH__"),m=h._(/*BTDS*/"__JHASH__dUg668z9Ul0__JHASH__"),n=(f=(e=b("cr:8596"))!=null?e:b("cr:8597"))!=null?f:b("cr:6733");function a(){var a=d("react-compiler-runtime").c(4),e,f,g;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e={title:l},f=n!=null?j.jsx(n,{},"encrypted-backups-comet"):null,g=j.jsx(c("MAWSecurityAlertsMenuItem.react"),{},"security-alerts-after-redesign"),a[0]=e,a[1]=f,a[2]=g):(e=a[0],f=a[1],g=a[2]);a[3]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("MWXMenuItemWithSubmenu.react"),{primaryText:l,secondaryText:m,submenu:{header:e,items:[f,g,j.jsxs(j.Fragment,{children:[j.jsx(c("MWXDivider.react"),{xstyle:k.divider}),j.jsx(c("MAWXMAPreviewsSettingsMenuItem.react"),{})]},"settings-xma-previews"),b("cr:3079")!=null?j.jsx(b("cr:3079"),{},"encrypted-backups-dev-options"):null,b("cr:6692")&&j.jsx(b("cr:6692"),{},"persisted-eb-state-menu"),b("cr:7398")!=null?j.jsx(b("cr:7398"),{},"reset-menu"):null]},testid:void 0}),a[3]=e):e=a[3];return e}g["default"]=a}),226);
__d("MWSupportInboxDialogQuery$Parameters",["MWSupportInboxDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWSupportInboxDialogQuery_facebookRelayOperation"),metadata:{},name:"MWSupportInboxDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWSupportInboxDialog.entrypoint",["JSResourceForInteraction","MWSupportInboxDialogQuery$Parameters","WebPixelRatio"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{options:{fetchPolicy:"network-only"},parameters:c("MWSupportInboxDialogQuery$Parameters"),variables:{scale:d("WebPixelRatio").get()}}}}},root:c("JSResourceForInteraction")("MWSupportInboxDialog.react").__setRef("MWSupportInboxDialog.entrypoint")};g["default"]=a}),98);
__d("XSupportInboxControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/support/",Object.freeze({second:!1,shimmed_in_item:!1}),void 0);b=a;g["default"]=b}),98);
__d("MWSupportInboxMenuItem.react",["fbt","MWJewelPopoverDialogContext.react","MWPBumpEntityKey","MWSupportInboxDialog.entrypoint","MWXMenuItem.react","MessengerWebUXLogger","QPLUserFlow","XSupportInboxControllerRouteBuilder","gkx","qpl","react","react-compiler-runtime","useMWXEntryPointDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext;function a(){var a=d("react-compiler-runtime").c(12),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b={},a[0]=b):b=a[0];b=c("useMWXEntryPointDialog")(c("MWSupportInboxDialog.entrypoint"),b);var e=b[0];b=k(c("MWJewelPopoverDialogContext.react"));var f=b.setIsOpenForDialog,g=c("MessengerWebUXLogger").useInteractionLogger();a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b={eventName:"support_inbox_entrypoint_impression"},a[1]=b):b=a[1];b=c("MessengerWebUXLogger").useImpressionLoggerRef(b);var i;a[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=c("gkx")("23433")?void 0:c("XSupportInboxControllerRouteBuilder").buildURL({}),a[2]=i):i=a[2];var l;a[3]!==g||a[4]!==f||a[5]!==e?(l=function(){g==null?void 0:g({eventName:"support_inbox_entrypoint_click"}),c("gkx")("23433")&&(c("QPLUserFlow").start(c("qpl")._(25305734,"469")),d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","support_inbox"),f(!0),e({}))},a[3]=g,a[4]=f,a[5]=e,a[6]=l):l=a[6];var m;a[7]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"__JHASH___0xVSXtnNxF__JHASH__"),a[7]=m):m=a[7];var n;a[8]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._(/*BTDS*/"__JHASH__8gcPg_VjQag__JHASH__"),a[8]=n):n=a[8];a[9]!==b||a[10]!==l?(i=j.jsx(c("MWXMenuItem.react"),{href:i,onClick:l,primaryText:m,ref:b,secondaryText:n}),a[9]=b,a[10]=l,a[11]=i):i=a[11];return i}g["default"]=a}),226);
__d("MWChatSidebarSettingsPrivacyMenu.react",["fbt","MWPBumpEntityKey","MWSupportInboxMenuItem.react","MWXIconMenuItemHouseKeyhole","MWXMenuItemWithSubmenu.react","cr:13902","cr:7253","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(2),e;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=[],b("cr:7253")!=null&&e.push(j.jsx(b("cr:7253"),{},"settings-e2ee-chats")),b("cr:13902")!=null&&e.push(j.jsx(b("cr:13902"),{},"settings-read-receipts")),e.push(j.jsx(c("MWSupportInboxMenuItem.react"),{},"settings-support-inbox")),a[0]=e):e=a[0];a[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("MWXMenuItemWithSubmenu.react"),{icon:c("MWXIconMenuItemHouseKeyhole"),onClick:k,primaryText:h._(/*BTDS*/"__JHASH__pWg6bFBFRzx__JHASH__"),submenu:{items:e},testid:void 0}),a[1]=e):e=a[1];return e}function k(){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","privacy_submenu")}g["default"]=a}),226);
__d("useMWDropEBDbMenuDialog",["fbt","MAWEncryptedBackupsPersistedDB","asyncToGeneratorRuntime","promiseDone","react-compiler-runtime","setTimeout","useMWXConfirmationDialog"],(function(a,b,c,d,e,f,g,h){"use strict";function a(){var a=d("react-compiler-runtime").c(3),e=c("useMWXConfirmationDialog")(),f;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("MAWEncryptedBackupsPersistedDB").deleteEBIDB()});function a(){return c.apply(this,arguments)}return a}(),a[0]=f):f=a[0];var g=f;a[1]!==e?(f=function(){return e({body:h._(/*BTDS*/"__JHASH__DcM8TCyeV5W__JHASH__"),cancel:h._(/*BTDS*/"__JHASH__m8lIvy2pF-q__JHASH__"),confirm:h._(/*BTDS*/"__JHASH__pOCM-0rZl3___JHASH__"),title:h._(/*BTDS*/"__JHASH__icqZlIIHBX0__JHASH__")},function(){c("promiseDone")(g().then(i))})},a[1]=e,a[2]=f):f=a[2];return f}function i(){c("setTimeout")(j,500)}function j(){window.location.reload()}g["default"]=a}),226);
__d("MWDropEBDbMenu.react",["cr:5086","react","react-compiler-runtime","useMWDropEBDbMenuDialog"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){var a=d("react-compiler-runtime").c(2),e=c("useMWDropEBDbMenuDialog")(),f;a[0]!==e?(f=b("cr:5086")!=null?i.jsx(b("cr:5086"),{onClick:e,primaryText:"[Fb-only] Clear persisted EB DB"}):null,a[0]=e,a[1]=f):f=a[1];return f}g["default"]=a}),98);
__d("MWEncryptedBackupsFetchBackupMetadata",["LSFactory","LSFetchBackupsMetadataStoredProcedure"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.runInTransaction(function(a){return c("LSFetchBackupsMetadataStoredProcedure")(c("LSFactory")(a))},"readwrite",void 0,void 0,f.id+":17")}g.fetchBackupMetadata=a}),98);
__d("MWXIconMenuItemFriends",["MWXSvgIcon","SVGIcon","cr:12805","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12805")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWFamilyCenterSuppervisionMenuItem.react",["fbt","MWXIconMenuItemFriends","MWXMenuItem.react","XMessengerFamilyCenterHomeControllerRouteBuilder","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(2),b=c("gkx")("6418");a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=b?h._(/*BTDS*/"__JHASH__tx7uyhhjgzg__JHASH__"):h._(/*BTDS*/"__JHASH__lM007x7UQKh__JHASH__"),a[0]=b):b=a[0];b=b;if(a[1]===Symbol["for"]("react.memo_cache_sentinel")){var e;e=j.jsx(c("MWXMenuItem.react"),{href:(e=c("XMessengerFamilyCenterHomeControllerRouteBuilder").buildUri({}).setSubDomain("familycenter"))==null?void 0:e.toString(),icon:c("MWXIconMenuItemFriends"),primaryText:b,target:"_blank",testid:void 0});a[1]=e}else e=a[1];return e}g["default"]=a}),226);
__d("MWInboxAccessibilitySettingsDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9470562229723769"}),null);
__d("MWInboxAccessibilitySettingsDialogQuery$Parameters",["MWInboxAccessibilitySettingsDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWInboxAccessibilitySettingsDialogQuery_facebookRelayOperation"),metadata:{},name:"MWInboxAccessibilitySettingsDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWInboxAccessibilitySettingsDialog.entrypoint",["JSResourceForInteraction","MWInboxAccessibilitySettingsDialogQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{parameters:c("MWInboxAccessibilitySettingsDialogQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("MWInboxAccessibilitySettingsDialog.react").__setRef("MWInboxAccessibilitySettingsDialog.entrypoint")};g["default"]=a}),98);
__d("MWInboxInfoFRXOverflowMenu.react",["fbt","ARIA_LABEL_PLACEHOLDER_FIXME","MWPBumpEntityKey","MWXIconMenuItemAppFacebook","MWXIconMenuItemShieldStar","MWXMenu.react","MWXMenuItem.react","emptyFunction","react","react-compiler-runtime","useMWInboxInfoFRX"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(19),e=a.onClose;a=a.thread;var f;b[0]!==a?(f={entryPoint:"groups_report_to_admin",messagingEntrypoint:"thread_details",onPress:c("emptyFunction"),thread:a},b[0]=a,b[1]=f):f=b[1];var g=c("useMWInboxInfoFRX")(f);b[2]!==a?(f={entryPoint:"report_button",messagingEntrypoint:"thread_details",onPress:c("emptyFunction"),thread:a},b[2]=a,b[3]=f):f=b[3];var i=c("useMWInboxInfoFRX")(f);b[4]!==e||b[5]!==g?(a=function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","privacy_support_section_something_wrong"),g(),e==null?void 0:e(a)},b[4]=e,b[5]=g,b[6]=a):a=b[6];b[7]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"__JHASH__ZBWFHBYdv28__JHASH__"),b[7]=f):f=b[7];b[8]!==a?(f=j.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemShieldStar"),onClick:a,primaryText:f}),b[8]=a,b[9]=f):f=b[9];b[10]!==e||b[11]!==i?(a=function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","privacy_support_section_something_wrong"),i(),e==null?void 0:e(a)},b[10]=e,b[11]=i,b[12]=a):a=b[12];var k;b[13]===Symbol["for"]("react.memo_cache_sentinel")?(k=h._(/*BTDS*/"__JHASH__jtx35QWIxS3__JHASH__"),b[13]=k):k=b[13];b[14]!==a?(k=j.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemAppFacebook"),onClick:a,primaryText:k}),b[14]=a,b[15]=k):k=b[15];b[16]!==f||b[17]!==k?(a=j.jsxs(c("MWXMenu.react"),{"aria-label":c("ARIA_LABEL_PLACEHOLDER_FIXME"),withArrow:!0,children:[f,k]}),b[16]=f,b[17]=k,b[18]=a):a=b[18];return a}g["default"]=a}),226);
__d("MWInboxMediaGalleryEBRestoreSyncBanner.react",["fbt","MWXCard.react","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k={files:"files",links:"links",media:"media"};function a(a){var b=d("react-compiler-runtime").c(3);a=a.contentType;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXSpinner.react"),{color:"blue",size:20})}),b[0]=e):e=b[0];b[1]!==a?(e=j.jsx(c("MWXCard.react"),{background:"card-flat",children:j.jsxs(c("MWXRow.react"),{align:"center",paddingHorizontal:12,paddingVertical:12,verticalAlign:"center",children:[e,j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXText.react"),{align:"center",color:"primary",type:"body4",children:h._(/*BTDS*/"__JHASH__qsj_NN7HBOy__JHASH__",[h._enum(k[a],{media:"media",files:"files",links:"links"})])})})]})}),b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),226);
__d("MWInboxMediaGalleryEBRestoreUpsell.react",["fbt","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreUpsellTrigger.react","MWXCard.react","MWXLink.react","MWXText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k={files:"files may be",links:"links may be",media:"media may be"};function a(a){var b=d("react-compiler-runtime").c(2),e=a.contentType;b[0]!==e?(a=j.jsx(c("MWEBRestoreUpsellTrigger.react"),{markerPrefix:"MEDIA_GALLERY_RESTORE",qplSource:c("MWChatEncryptedBackupsQPLSource.enum").MEDIA_GALLERY_RESTORE,children:function(a,b){return j.jsx(c("MWXCard.react"),{background:"card-flat",children:j.jsx("div",babelHelpers["extends"]({className:"xyamay9 x1l90r2v x1ye3gou xn6708d"},{ref:b,children:j.jsxs(c("MWXText.react"),{align:"center",color:"primary",type:"body4",children:[h._(/*BTDS*/"__JHASH__F8T32CBQRfW__JHASH__",[h._enum(k[e],{"files may be":"files may be","links may be":"links may be","media may be":"media may be"})])," ",j.jsx(c("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:j.jsx(c("MWXLink.react"),{onClick:a,children:h._(/*BTDS*/"__JHASH__LQMCgf275AT__JHASH__")})})]})}))})}}),b[0]=e,b[1]=a):a=b[1];return a}g["default"]=a}),226);
__d("MessengerClientEventMinorSurface",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({MUSIC_PLAYER:"music_player",LYRICS_SELECTOR:"lyrics_selector",CHANNELS_FOLDER_SUGGESTED_BROADCAST_CHANNELS_SECTION:"channels_folder_suggested_broadcast_channels_section",CHANNELS_FOLDER_SUGGESTED_BROADCAST_CHANNELS_SEE_MORE_LIST:"channels_folder_suggested_broadcast_channels_see_more_list",COMMUNITIES_ALL_COMMUNITIES_LIST_VIEW:"communities_all_communities_list_view",COMMUNITIES_CHANNEL_LIST_VIEW:"communities_channel_list_view",COMMUNITIES_CHAT_PREVIEW:"communities_chat_preview",COMMUNITIES_COMMUNITY_PREVIEW:"communities_community_preview",COMMUNITIES_MAIN_VIEW_CONNECTED_COMMUNITIES_SECTION:"communities_main_view_connected_communities_section",COMMUNITIES_MAIN_VIEW_CONNECTED_CHANNELS_SECTION:"communities_main_view_connected_channels_section",COMMUNITIES_MAIN_VIEW_TO_REVIEW_SECTION:"communities_main_view_to_review_section",COMMUNITIES_MAIN_VIEW_UNCONNECTED_COMMUNITIES_SECTION:"communities_main_view_unconnected_communities_section",COMMUNITIES_TO_REVIEW_LIST_VIEW:"communities_to_review_list_view",CONTEXT_MENU:"context_menu",NOTE_CREATION_SETTINGS:"note_creation_settings",HIGHLIGHTS_FEED:"highlights_feed",HIGHLIGHTS_TAB_FOOTER:"highlights_tab_footer",HIGHLIGHTS_TAB_IMMERSIVE_VIEW:"highlights_tab_immersive_view",HIGHLIGHTS_TAB_NUX:"highlights_tab_nux",HIGHLIGHTS_TAB_TRAY:"highlights_tab_tray",HIGHLIGHTS_TRAY:"highlights_tray",HOLIDAY_CARD_EDITOR:"holiday_card_editor",JEWEL_FOCUS_VIEW:"jewel_focus_view",LEFT_DRAWER_DISCOVER_CHANNELS_LIST:"left_drawer_discover_channels_list",LEFT_NAV:"left_nav",MAIN_VIEW:"main_view",MEDIA_VIEW:"media_view",MSGR_TAB:"msgr_tab",PYMK_VIEW:"pymk_view",PYMK_FULL_PAGE:"pymk_full_page",THREAD_VIEW:"thread_view",INBOX_BANNER:"inbox_banner",INBOX_COMMUNITIES:"inbox_communities",INBOX_COMMUNITIES_LONG_PRESS_PAGE:"inbox_communities_long_press_page",INBOX_MESSAGES:"inbox_messages",INBOX_MESSAGES_BULK_ACTION_PAGE:"inbox_messages_bulk_action_page",INBOX_TRAY:"inbox_tray",INBOX_TREP:"inbox_trep",INBOX_FILTER_ALL:"inbox_filter_all",INBOX_FILTER_UNREAD:"inbox_filter_unread",INBOX_FILTER_GROUPS:"inbox_filter_groups",LEFT_NAV_COMMUNITIES:"left_nav_communities",LEFT_NAV_STANDALONE_COMMUNITIES:"left_nav_standalone_communities",LEFT_NAV_FB_GROUPS:"left_nav_fb_groups",COMMUNITIES_GROUPS_EDIT_SHEET:"communities_groups_edit_sheet",FIND_CONTACTS_PAGE:"find_contacts_page",CONTACTS_ACCESS_PROMPT:"contacts_access_prompt",STORY_COMPOSER_RMC_CAROUSEL:"story_composer_rmc_carousel",STORY_COMPOSER_CREATION_MODE:"story_composer_creation_mode",READY_MADE_CONTENT_MIMICRY:"ready_made_content_mimicry",STORY_RING:"story_ring",STORY_CARD:"story_card",COMBINED_VIEWER:"combined_viewer",PROFILE:"profile",THREAD_LIST:"thread_list",ACTIONS_VIEW_STORY:"actions_view_story",PYMK_VIEW_INFO:"pymk_view_info",PYMK_CONTAINER:"pymk_container",PYMK_CONTAINER_HIGHLGHTS_TAB:"pymk_container_highlights_tab",PYMK_CONTAINER_INBOX:"pymk_container_inbox",PYMK_CONTAINER_INBOX_ALL_COUNT:"pymk_container_inbox_all_count",PYMK_CONTAINER_JEWEL:"pymk_container_messenger_jewel",PYMK_CONTAINER_LEFT_NAV:"pymk_container_left_nav",PYMK_CONTAINER_SEARCH:"pymk_container_search",PYMK_CONTAINER_STORY_VIEWER:"pymk_container_story_viewer",FRIENDS_GROUP_MEMBERS_SECTION:"friends_group_members_section",GROUP_MEMBERS_RESPOND_SHEET:"group_members_respond_sheet",IMMERSIVE_PROFILE_VIEW_HEADER:"immersive_profile_view_header",IMMERSIVE_PROFILE_RESPOND_SHEET:"immersive_profile_respond_sheet",IMMERSIVE_PROFILE_UNFRIEND_RESPOND_SHEET:"immersive_profile_unfriend_respond_sheet",THREAD_VIEW_ADD_MEMBER_ADMIN_TEXT:"thread_view_add_member_admin_text",THREAD_VIEW_DETAILS_HEADER:"thread_view_details_header",THREAD_VIEW_DETAILS_UNFRIEND_RESPOND_SHEET:"thread_view_details_unfriend_respond_sheet",THREAD_VIEW_HEADER:"thread_view_header",THREAD_VIEW_TITLE:"thread_view_title",THREAD_VIEW_RESPOND_SHEET:"thread_view_respond_sheet",THREAD_VIEW_UNFRIEND_RESPOND_SHEET:"thread_view_unfriend_respond_sheet",UNCONNECTED_GROUP_MEMBERS_SECTION:"unconnected_group_members_section",URL_PREVIEW:"url_preview",THREAD_VIEW_DETAILS_RESPOND_SHEET:"thread_view_details_respond_sheet",THREAD_VIEW_XMA_LINK:"thread_view_xma_link",THREAD_VIEW_XMA_REPLY:"thread_view_xma_reply",THREAD_VIEW_XMA_SHARE:"thread_view_xma_share",IMMERSIVE_PROFILE_VIEW_ABOUT_SECTION:"immersive_profile_view_about_section",IMMERSIVE_PROFILE_VIEW_CHAT_ACTIONS_SECTION:"immersive_profile_view_chat_actions_section",IMMERSIVE_PROFILE_VIEW_COMMON_CHATS_SECTION:"immersive_profile_view_common_chats_section",IMMERSIVE_PROFILE_VIEW_MUTUAL_FRIENDS_SECTION:"immersive_profile_view_mutual_friends_section",IMMERSIVE_PROFILE_VIEW_PRIVACY_SECTION:"immersive_profile_view_privacy_section",FRIEND_REQUEST_PUSH_NOTIFICATION:"friend_request_push_notification",STORY_PUSH_NOTIFICATION:"story_push_notification",FRIEND_REQUESTS_CONTAINER:"friend_requests_container",FRIEND_REQUESTS_VIEW:"friend_requests_view",STORY_MUSIC_EDITOR:"story_music_editor",UNIVERSAL_SEARCH_NULL_STATE:"universal_search_null_state",UNIVERSAL_SEARCH_QUERY_STATE:"universal_search_query_state",NOTE_CREATION_HEADER:"note_creation_header",NOTE_CREATION_CENTER:"note_creation_center",MUSIC_SELECTOR:"music_selector",GAME_SELECTOR:"game_selector",COMBINED_VIEWER_HEADER:"combined_viewer_header",NOTE_CLICKABLE_CONTENT:"note_clickable_content",COMBINED_VIEWER_CONTENT:"combined_viewer_content",COMBINED_VIEWER_FOOTER:"combined_viewer_footer",PARTICIPATION_VIEWER:"participation_viewer",STORY_CREATION_HOMEBASE_HEADER:"story_creation_homebase_header",CONTENT_CREATION_ALBUM_LIST:"content_creation_album_list",STORY_CREATION_HOMEBASE_MODES:"story_creation_homebase_modes",STORY_CREATION_HOMEBASE_ALBUM_PHOTOS:"story_creation_homebase_album_photos",STORY_CREATION_COMPOSER_TOOLBAR:"story_creation_composer_toolbar",STORY_CREATION_COMPOSER_BRUSH_EDITOR:"story_creation_composer_brush_editor",STORY_CREATION_COMPOSER_TEXT_TOOL:"story_creation_composer_text_tool",STORY_CREATION_COMPOSER_STICKER_SELECTOR:"story_creation_composer_sticker_selector",STORY_CREATION_COMPOSER_SETTINGS:"story_creation_composer_settings",STORY_CREATION_COMPOSER_MUSIC_SELECTOR:"story_creation_composer_music_selector",STORY_CREATION_COMPOSER_VIDEO_TOOL:"story_creation_composer_video_tool",NA:"NA",QP:"qp",COMMUNITIES_IN_COMMON_SHEET:"communities_in_common_sheet",FRIENDS_IN_COMMON_SHEET:"friends_in_common_sheet",GROUPCHATS_IN_COMMON_SHEET:"groupchats_in_common_sheet",FRIENDS_IN_COMMON_SEE_ALL:"friends_in_common_see_all",SIDEBAR_ONE_ON_ONE_CHATS:"sidebar_one_on_one_chats",SIDEBAR_GROUP_CHATS:"sidebar_group_chats",SIDEBAR_COMMUNITY_CHATS:"sidebar_community_chats",SIDEBAR_BROADCAST_CHANNELS:"sidebar_broadcast_channels",GROUP_MEMBERS_FILTER_ALL:"group_members_filter_all",GROUP_MEMBERS_FILTER_ADMINS:"group_members_filter_admins",GROUP_MEMBERS_FILTER_HOSTS:"group_members_filter_hosts",READ_RECEIPT:"read_receipt"});c=a;f["default"]=c}),66);
__d("MessengerClientEventTargetType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ASSET:"asset",BANNER:"banner",BUTTON:"button",BROADCAST_CHANNEL:"broadcast_channel",COMMUNITY:"community",EVENT:"event",FOLDER:"folder",GROUP:"group",JEWEL_NOTIFICATION:"jewel_notification",PUSH_NOTIFICATION:"push_notification",MESSAGE_THREAD:"message_thread",NOTE:"note",POLL:"poll",POST:"post",STORY:"story",TAB:"tab",USER:"user",MUSIC:"music",STICKER:"sticker",AVATAR_STICKER:"avatar_sticker",EMOJI:"emoji",REEL:"reel",LINK:"link",PHOTO:"photo",VIDEO:"video",ALBUM:"album",GIF:"gif",GAME:"game",LOCATION:"location",AI_GENERATED_STICKER:"ai_generated_sticker",ADD_YOURS:"add_yours",FACE_PILE:"face_pile",CONTEXT_MENU:"context_menu",PARTICIPATION_VIEWER:"participation_viewer",UPLOAD_STATUS:"upload_status",READY_MADE_CONTENT:"ready_made_content",INBOX_FILTER:"inbox_filter",THREAD_LIST_CONTAINER:"thread_list_container",MEDIA:"media",LOCATION_STICKER:"location_sticker",TIME_STICKER:"time_sticker",DATE_STICKER:"date_sticker",BATTERY_STICKER:"battery_sticker",WEATHER_STICKER:"weather_sticker",USER_NOTE:"user_note",USER_STORY:"user_story",USER_NOTE_STORY:"user_note_story",FRIEND_REQUEST_VIEW:"friend_request_view",JEWEL_PAGE:"jewel_page",MSGR_SETTINGS_PAGE:"msgr_settings_page",PYMK_VIEW:"pymk_view",STORY_COMPOSER_EDITOR_PAGE:"story_composer_editor",STORY_COMPOSER_HOMEBASE_PAGE:"story_composer_homebase_page",FB_GROUPS_CONTAINER:"fb_groups_container",INBOX_TRAY_CONTAINER:"inbox_tray_container",PYMK_CONTAINER:"pymk_container",STANDALONE_COMMUNITIES_CONTAINER:"standalone_communities_container",FRIEND_REQUESTS_CONTAINER:"friend_requests_container",STORY_TRAY_CONTAINER:"story_tray_container",CHAT_WITH_FRIENDS_CONTAINER:"chat_with_friends_container",PARTICIPATION_VIEWER_CONTAINER:"participation_viewer_container",FRIENDS_LIST_CONTAINER:"friends_list_container",NON_FRIENDS_LIST_CONTAINER:"non_friends_list_container",INVITED_LIST_CONTAINER:"invited_group_members_container",ACTIVE_NOW_LIST_CONTAINER:"active_now_list_container",COMMUNITIES_GROUPS_EDIT_SHEET:"communities_groups_edit_sheet",FRIEND_REQUEST_RESPONSE_SHEET:"friend_request_response_sheet",UNFRIEND_REQUEST_RESPONSE_SHEET:"unfriend_request_response_sheet",PYMK_VIEW_BOTTOM_SHEET:"pymk_view_bottom_sheet",COMMUNITIES_IN_COMMON_SHEET:"communities_in_common_sheet",FRIENDS_IN_COMMON_SHEET:"friends_in_common_sheet",GROUPCHATS_IN_COMMON_SHEET:"groupchats_in_common_sheet"});c=a;f["default"]=c}),66);
__d("MessengerClientEventType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ONE_PX_IMPRESSION:"one_px_impression",VPVD_IMPRESSION:"vpvd_impression",SINGLE_CLICK:"single_click",LONG_PRESS:"long_press",SYSTEM:"system"});c=a;f["default"]=c}),66);
__d("MessengerSettingsActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("120");b=d("FalcoLoggerInternal").create("messenger_settings_action",a);e=b;g["default"]=e}),98);
__d("logMessengerSettingsFalcoEvent",["MessengerSettingsActionFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.majorSurface,d=a.minorSurface,e=d===void 0?"NA":d;d=a.target;var f=d===void 0?"button":d;d=a.eventType;var g=d===void 0?"single_click":d;c("MessengerSettingsActionFalcoEvent").log(function(){return{event_type:g,surface:{entry_point:void 0,major_surface:b,minor_surface:e},target:{type:f}}})}g["default"]=a}),98);
__d("useMWEditUsernameDialog",["JSResourceForInteraction","LSFactory","LSFetchAccountSyncedFieldsStoredProcedure","emptyFunction","promiseDone","react","react-compiler-runtime","useAsyncReStore","useMWXLazyDialog"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useRef,k=c("JSResourceForInteraction")("MWEditUsernameDialog.react").__setRef("useMWEditUsernameDialog");function a(){var a=d("react-compiler-runtime").c(5),b=c("useAsyncReStore")(),e=c("useMWXLazyDialog")(k),f=e[0],g=j(!1),h;a[0]!==b?(e=function(){if(g.current===!0)return;g.current=!0;c("promiseDone")(b,l)},h=[b,g],a[0]=b,a[1]=e,a[2]=h):(e=a[1],h=a[2]);i(e,h);a[3]!==f?(e=function(a,b){f({entryPoint:b,initialUsername:a},c("emptyFunction"))},a[3]=f,a[4]=e):e=a[4];return e}function l(a){c("promiseDone")(a.runInTransaction(m,"readwrite"))}function m(a){return c("LSFetchAccountSyncedFieldsStoredProcedure")(c("LSFactory")(a))}g["default"]=a}),98);
__d("MWInboxSettingEditUsernameMenuItem.react",["fbt","MWPActor.react","MWXIconMenuItemText","MWXMenuItem.react","ReQL","ReQLSuspense","logMessengerSettingsFalcoEvent","react","react-compiler-runtime","useMWEditUsernameDialog","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||c("react");function a(){var a=d("react-compiler-runtime").c(12),b=(j||(j=c("useReStore")))(),e=d("MWPActor.react").useActor(),g;a[0]!==e||a[1]!==b.tables.contacts?(g=function(){return d("ReQL").fromTableAscending(b.tables.contacts).getKeyRange(e)},a[0]=e,a[1]=b.tables.contacts,a[2]=g):g=a[2];var i;a[3]!==e||a[4]!==b?(i=[b,e],a[3]=e,a[4]=b,a[5]=i):i=a[5];var l=d("ReQLSuspense").useFirst(g,i,f.id+":29"),m=c("useMWEditUsernameDialog")();if(l==null)return null;a[6]!==l.username||a[7]!==m?(g=function(){c("logMessengerSettingsFalcoEvent")({majorSurface:"msgr_settings"}),m(l.username,"msgr_settings")},a[6]=l.username,a[7]=m,a[8]=g):g=a[8];a[9]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"__JHASH__IqleJARHzOk__JHASH__"),a[9]=i):i=a[9];a[10]!==g?(i=k.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemText"),onClick:g,primaryText:i}),a[10]=g,a[11]=i):i=a[11];return i}g["default"]=a}),226);
__d("useCometHomeChatSettingsQuery$Parameters",["useCometHomeChatSettingsQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("useCometHomeChatSettingsQuery_facebookRelayOperation"),metadata:{},name:"useCometHomeChatSettingsQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWInboxSettingsDialog.entrypoint",["JSResourceForInteraction","useCometHomeChatSettingsQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{chatSettingsQueryReference:{parameters:b("useCometHomeChatSettingsQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("MWInboxSettingsDialogEntrypoint.react").__setRef("MWInboxSettingsDialog.entrypoint")};g["default"]=a}),98);
__d("MWXIconMenuItemAccessibility",["MWXSvgIcon","SVGIcon","cr:12651","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12651")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemBox",["MWXSvgIcon","SVGIcon","cr:12707","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12707")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemDownload",["MWXSvgIcon","SVGIcon","cr:12767","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12767")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemInfoCircle",["MWXSvgIcon","SVGIcon","cr:12824","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12824")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemMessageDots",["MWXSvgIcon","SVGIcon","cr:12849","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12849")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemQuestionCircle",["MWXSvgIcon","SVGIcon","cr:12898","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12898")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemSettings",["MWXSvgIcon","SVGIcon","cr:12921","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12921")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXIconMenuItemTextAlignLeft",["MWXSvgIcon","SVGIcon","cr:12947","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:12947")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWInboxSettingsMenu.react",["fbt","CurrentEnvironment","CurrentUser","FDSMenuSeparator.react","FDSSeparatorMenuItem.react","I64","JSResourceForInteraction","LSDataUseConsentState","LSIntEnum","MWAnimatedImageControlsUtil","MWChatSidebarSettingsPrivacyMenu.react","MWFacebookUserWithoutMessengerAccess","MWInboxAccessibilitySettingsDialog.entrypoint","MWInboxRestrictedAccountsRouteBuilder","MWInboxSettingEditUsernameMenuItem.react","MWInboxSettingsDialog.entrypoint","MWPBumpEntityKey","MWSeparatorContainer.react","MWXIconMenuItemAccessibility","MWXIconMenuItemBox","MWXIconMenuItemCautionTriangle","MWXIconMenuItemDownload","MWXIconMenuItemInfoCircle","MWXIconMenuItemLeave","MWXIconMenuItemMessageCross","MWXIconMenuItemMessageDots","MWXIconMenuItemQuestionCircle","MWXIconMenuItemSettings","MWXIconMenuItemTextAlignLeft","MWXMenu.react","MWXMenuItem.react","MessageRequestsLog","MessengerMSplitFlag","MetaConfig","ODS","Promise","ReQL","ReQLSuspense","XMessengerHelpCenterHomeControllerRouteBuilder","cr:4007","cr:4021","cr:494","cr:7484","cr:8035","gkx","openMessengerLogOut","promiseDone","react","useMWXEntryPointDialog","useMWXLazyDialog","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m,n,o,p=o||d("react");function a(a){return q}function q(){return(n||(n=b("Promise"))).resolve()}var r=(i=b("cr:494"))!=null?i:a;function e(a){a.onClose;var e=a.showHidden,g=a.showMessageRequests,i=a.showRestrictedAccounts,n=(j||(j=c("useReStore")))();a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(n.tables.epd_cookie_settings)},[n],f.id+":86");var o=c("MetaConfig")._("37"),q=c("useMWXEntryPointDialog")(c("MWInboxSettingsDialog.entrypoint"),{}),s=q[0];q=c("useMWXEntryPointDialog")(c("MWInboxAccessibilitySettingsDialog.entrypoint"),{});var t=q[0];q=c("useMWXLazyDialog")(c("JSResourceForInteraction")("MWInboxBugReportDialog.react").__setRef("MWInboxSettingsMenu.react"));var u=q[0];q=p.jsx(c("MWXMenuItem.react"),{href:"https://www.facebook.com/help/cookies",icon:c("MWXIconMenuItemTextAlignLeft"),onClick:function(){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","cookie_policy")},primaryText:h._(/*BTDS*/"__JHASH__DfxWgrx2TO4__JHASH__"),target:"_blank",testid:void 0});var v=c("gkx")("24080"),w=p.jsx(c("MWXMenuItem.react"),{href:"https://accountscenter.facebook.com/info_and_permissions/cookie_settings",icon:c("MWXIconMenuItemSettings"),primaryText:h._(/*BTDS*/"__JHASH__MTNaLMBMu4i__JHASH__"),target:"_blank",testid:void 0});v=v&&a!=null&&!(k||(k=d("I64"))).equal(a.fbTrackersOnOtherCompanies,(l||(l=d("LSIntEnum"))).ofNumber(c("LSDataUseConsentState").UNSET))&&!(k||(k=d("I64"))).equal(a.otherCompanyTrackersOnFoa,(l||(l=d("LSIntEnum"))).ofNumber(c("LSDataUseConsentState").UNSET))&&!c("MessengerMSplitFlag").is_msplit_account?w:q;var x=r(!0);o?a=p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemLeave"),onClick:function(){c("promiseDone")(x().then(function(){return c("openMessengerLogOut")()}));return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","logout")},primaryText:h._(/*BTDS*/"__JHASH__Nqa13JcobKk__JHASH__"),testid:void 0}):a=null;w=d("MWFacebookUserWithoutMessengerAccess").useIsFacebookUserWithoutMessengerAccess();q=p.jsx(c("MWXMenuItem.react"),{href:o?d("MWInboxRestrictedAccountsRouteBuilder").buildURLWithoutThread():void 0,icon:c("MWXIconMenuItemMessageCross"),onClick:function(){o||i();return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","show_restricted_accounts")},primaryText:h._(/*BTDS*/"__JHASH__eJP9dpTCmG0__JHASH__"),testid:void 0});var y=d("CurrentUser").isMessengerOnlyUser()||d("CurrentUser").isDeactivatedAllowedOnMessenger()?p.jsx(c("MWXMenuItem.react"),{href:"https://www.messenger.com/dyi",icon:c("MWXIconMenuItemDownload"),primaryText:h._(/*BTDS*/"__JHASH__XDtLWcftVaB__JHASH__"),target:"_blank"}):null,z=b("cr:4007")==null?void 0:b("cr:4007")();return p.jsxs(c("MWXMenu.react"),{"aria-label":h._(/*BTDS*/"__JHASH__aBKj5dqxz8K__JHASH__"),testid:void 0,truncate:!0,withArrow:!0,children:[b("cr:4021")&&z!=null&&z>0?p.jsx(b("cr:4021"),{value:z}):null,z!=null&&z>0?p.jsx(c("FDSSeparatorMenuItem.react"),{}):null,p.jsxs(c("MWSeparatorContainer.react"),{separator:p.jsx(c("FDSMenuSeparator.react"),{}),children:[p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemSettings"),onClick:function(){s({},function(){});return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","preferences")},primaryText:h._(/*BTDS*/"__JHASH__eqYqxmQJvsj__JHASH__"),testid:void 0}),o&&c("gkx")("538")?p.jsx(c("MWInboxSettingEditUsernameMenuItem.react"),{}):null,o?q:p.jsxs("div",{children:[p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemMessageDots"),onClick:function(){d("MessageRequestsLog").logMessageRequestsView(0,-1);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","message_requests");return g()},primaryText:h._(/*BTDS*/"__JHASH__ehDyA5Bu0Ni__JHASH__"),testid:void 0}),p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemBox"),onClick:function(){e();return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","report_problem")},primaryText:h._(/*BTDS*/"__JHASH__g0xPJguoMdB__JHASH__"),testid:void 0}),q]}),p.jsxs(p.Fragment,{children:[c("MWChatSidebarSettingsPrivacyMenu.react")&&p.jsx(c("MWChatSidebarSettingsPrivacyMenu.react"),{}),o&&d("MWAnimatedImageControlsUtil").getShouldEnableGIFPlayPause()&&p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemAccessibility"),onClick:function(){return t({},function(){})},primaryText:h._(/*BTDS*/"__JHASH__nb5irYu6FCK__JHASH__"),testid:void 0})]}),b("cr:7484")&&p.jsx(b("cr:7484"),{}),p.jsxs("div",{children:[p.jsx(c("MWXMenuItem.react"),{href:c("XMessengerHelpCenterHomeControllerRouteBuilder").buildUri({}).toString(),icon:c("MWXIconMenuItemQuestionCircle"),onClick:function(){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","help")},primaryText:h._(/*BTDS*/"__JHASH__dj3Jwhr0CVf__JHASH__"),target:"_blank",testid:void 0}),c("CurrentEnvironment").messengerdotcom?p.jsx(c("MWXMenuItem.react"),{icon:c("MWXIconMenuItemCautionTriangle"),onClick:function(){u({initialProduct:"chat"},function(){});return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","report_problem")},primaryText:h._(/*BTDS*/"__JHASH__EMd2E8yTDbT__JHASH__"),testid:void 0}):null]}),o?p.jsxs(p.Fragment,{children:[p.jsx(c("MWXMenuItem.react"),{href:"https://www.facebook.com/policies",icon:c("MWXIconMenuItemTextAlignLeft"),onClick:function(){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","terms")},primaryText:h._(/*BTDS*/"__JHASH__iV2OddJlExb__JHASH__"),target:"_blank",testid:void 0}),p.jsx(c("MWXMenuItem.react"),{href:"https://www.facebook.com/privacy/policy?entry_point=messenger_settings",icon:c("MWXIconMenuItemTextAlignLeft"),onClick:function(){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","privacy_policy")},primaryText:h._(/*BTDS*/"__JHASH__dv0U-lBKZ9F__JHASH__"),target:"_blank",testid:void 0}),v,y,d("CurrentUser").isMessengerOnlyUser()?p.jsx(c("MWXMenuItem.react"),{href:"https://www.facebook.com/help/messenger-app/ipad/458908261952384?helpref=platform_switcher&rdrhc",icon:c("MWXIconMenuItemInfoCircle"),onClick:function(){(m||(m=d("ODS"))).bumpEntityKey(3185,"inbox_settings","delete_account")},primaryText:h._(/*BTDS*/"__JHASH___bB3tvo90IJ__JHASH__"),target:"_blank"}):null]}):null,w&&a==null?null:p.jsxs("div",{children:[b("cr:8035")&&p.jsx(b("cr:8035"),{}),a]})]})]})}e.displayName=e.name+" [from "+f.id+"]";g["default"]=e}),226);
__d("MWMessageSearchEBRestoreUpsell.react",["fbt","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreUpsellTrigger.react","MWXLink.react","MWXText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("MWEBRestoreUpsellTrigger.react"),{markerPrefix:"RESTORE_UNIVERSAL_MESSAGE_SEARCH",qplSource:c("MWChatEncryptedBackupsQPLSource.enum").UNIVERSAL_MESSAGE_SEARCH,children:k}),a[0]=b):b=a[0];return b}function k(a,b){return j.jsxs(c("MWXText.react"),{align:"center",ref:b,type:"meta3",children:[h._(/*BTDS*/"__JHASH__OHGlQkJYzQl__JHASH__")," ",j.jsx(c("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:j.jsx(c("MWXLink.react"),{onClick:a,children:h._(/*BTDS*/"__JHASH__LQMCgf275AT__JHASH__")})})]})}k.displayName=k.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MessengerAccessibilityFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 29c6.075 0 11-4.925 11-11S24.075 7 18 7 7 11.925 7 18s4.925 11 11 11zm0-15c-.941 0-1.75-.652-1.75-2.07 0-1.158.737-1.93 1.75-1.93s1.75.772 1.75 1.93c0 1.418-.809 2.07-1.75 2.07zm6.5 1.797a.797.797 0 0 0-.797-.797H12.297a.797.797 0 0 0-.1 1.587l2.563.32a1 1 0 0 1 .863.828l.255 1.53c.08.483.041.978-.114 1.442l-1.343 4.032a.958.958 0 0 0 1.809.631l1.535-4.207a.25.25 0 0 1 .47 0l1.535 4.207a.958.958 0 0 0 1.81-.631l-1.344-4.032a3.001 3.001 0 0 1-.114-1.442l.255-1.53a1 1 0 0 1 .863-.828l2.562-.32a.797.797 0 0 0 .698-.79z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MessengerFriendsFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{d:"M7.25 12.305C7.25 16.207 9.446 18 12 18s4.75-1.793 4.75-5.695C16.75 9.123 14.75 7 12 7s-4.75 2.123-4.75 5.305zM15.082 21.607c.39-.423.262-1.13-.296-1.269A11.576 11.576 0 0 0 12 20c-4.835 0-9 2.985-9 6.665C3 27.405 3.37 28 4.06 28h7.81c.66 0 1.13-.675 1.13-1.335 0-1.97.83-3.697 2.082-5.058zM19.25 12.305C19.25 16.207 21.446 18 24 18s4.75-1.793 4.75-5.695C28.75 9.123 26.75 7 24 7s-4.75 2.123-4.75 5.305zM33 26.665c0 .74-.37 1.335-1.06 1.335H16.06c-.69 0-1.06-.595-1.06-1.335C15 22.985 19.165 20 24 20s9 2.985 9 6.665z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MessengerHouseKeyholeFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M16.162 7.624a3 3 0 0 1 3.676 0l9.642 7.473a1.342 1.342 0 0 1-.822 2.403H27.25a.25.25 0 0 0-.25.25v8.75a2 2 0 0 1-2 2H11a2 2 0 0 1-2-2v-8.75a.25.25 0 0 0-.25-.25H7.342a1.342 1.342 0 0 1-.822-2.403l9.642-7.473zm3.532 10.852c-.203.14-.314.387-.242.622l1.514 4.932a.75.75 0 0 1-.718.97h-4.497a.75.75 0 0 1-.717-.97l1.514-4.932c.072-.235-.04-.483-.242-.622a3 3 0 1 1 3.388 0z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MessengerSettingsFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M19.842 7.526A1.5 1.5 0 0 0 18.419 6.5h-.838a1.5 1.5 0 0 0-1.423 1.026l-.352 1.056c-.157.472-.541.827-1.006 1.003a8.93 8.93 0 0 0-.487.202c-.453.204-.976.225-1.42.002l-.997-.498a1.5 1.5 0 0 0-1.732.281l-.592.592a1.5 1.5 0 0 0-.28 1.732l.497.996c.223.445.202.968-.002 1.421-.072.16-.139.323-.202.487-.176.465-.531.849-1.003 1.006l-1.056.352A1.5 1.5 0 0 0 6.5 17.581v.838a1.5 1.5 0 0 0 1.026 1.423l1.056.352c.472.157.827.541 1.003 1.006.063.164.13.327.202.487.204.453.225.976.002 1.42l-.498.997a1.5 1.5 0 0 0 .281 1.732l.593.592a1.5 1.5 0 0 0 1.73.28l.998-.497c.444-.223.967-.202 1.42.002.16.072.323.139.487.202.465.176.849.531 1.006 1.003l.352 1.056a1.5 1.5 0 0 0 1.423 1.026h.838a1.5 1.5 0 0 0 1.423-1.026l.352-1.056c.157-.472.541-.827 1.006-1.003.164-.063.327-.13.486-.202.454-.204.977-.225 1.421-.002l.997.498a1.5 1.5 0 0 0 1.732-.281l.592-.592a1.5 1.5 0 0 0 .28-1.732l-.497-.996c-.223-.445-.202-.968.002-1.421.072-.16.139-.323.202-.487.176-.465.531-.849 1.003-1.006l1.056-.352a1.5 1.5 0 0 0 1.026-1.423v-.838a1.5 1.5 0 0 0-1.026-1.423l-1.056-.352c-.472-.157-.827-.541-1.003-1.006a8.991 8.991 0 0 0-.202-.487c-.204-.453-.225-.976-.002-1.42l.498-.997a1.5 1.5 0 0 0-.281-1.732l-.593-.592a1.5 1.5 0 0 0-1.73-.28l-.998.497c-.444.223-.967.202-1.42-.002a8.938 8.938 0 0 0-.487-.202c-.465-.176-.849-.531-1.006-1.003l-.352-1.056zM18 23.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MessengerTextAlignLeftFilled.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 36 36",fill:"currentColor",width:"1em",height:"1em",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").Path,{d:"M8 10a1 1 0 0 0-1 1v.5a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V11a1 1 0 0 0-1-1H8zM7 17.75a1 1 0 0 1 1-1h20a1 1 0 0 1 1 1v.5a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1v-.5zM7 24.5a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.5a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1v-.5z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MessengerWellbeingRestrictFailedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("474");b=d("FalcoLoggerInternal").create("messenger_wellbeing_restrict_failed",a);e=b;g["default"]=e}),98);
__d("MessengerWellbeingRestrictSucceededFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("480");b=d("FalcoLoggerInternal").create("messenger_wellbeing_restrict_succeeded",a);e=b;g["default"]=e}),98);
__d("MessengerWellbeingRestrictTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("481");b=d("FalcoLoggerInternal").create("messenger_wellbeing_restrict_tapped",a);e=b;g["default"]=e}),98);
__d("MessengerWellbeingUnrestrictFailedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("482");b=d("FalcoLoggerInternal").create("messenger_wellbeing_unrestrict_failed",a);e=b;g["default"]=e}),98);
__d("MessengerWellbeingUnrestrictSucceededFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("483");b=d("FalcoLoggerInternal").create("messenger_wellbeing_unrestrict_succeeded",a);e=b;g["default"]=e}),98);
__d("MessengerWellbeingUnrestrictTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("484");b=d("FalcoLoggerInternal").create("messenger_wellbeing_unrestrict_tapped",a);e=b;g["default"]=e}),98);
__d("WebStorageManagerEstimatesFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2144");b=d("FalcoLoggerInternal").create("web_storage_manager_estimates",a);e=b;g["default"]=e}),98);
__d("YpMessengerFamilyCenterCoreClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4644");b=d("FalcoLoggerInternal").create("yp_messenger_family_center_core_client_event",a);e=b;g["default"]=e}),98);
__d("YpMessengerFamilyCenterSetupClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4648");b=d("FalcoLoggerInternal").create("yp_messenger_family_center_setup_client_event",a);e=b;g["default"]=e}),98);
__d("YpMessengerTimeLimitClientEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("6453");b=d("FalcoLoggerInternal").create("yp_messenger_time_limit_client_event",a);e=b;g["default"]=e}),98);
__d("checkIsUserOptedOutOfAutoRestore",["I64","LSAuthorityLevel","LSIntEnum","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","ReQL","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("MWEBUseLocalStorage").mwEBGetLocalStorageEntryValue(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT);if(b!=null)return;b=(yield a);a=d("ReQL").fromTableAscending(b.tables.secure_encrypted_backups_client_state).filter(function(a){a=a.authorityLevel;return(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))});var e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(b.tables.auto_restore_opt_out)));a=(yield d("ReQL").firstAsync(a));var g=c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_OPTED_OUT_OF_AUTO_RESTORE,j=d("MWEBUseLocalStorage").mwEBGetIsLocalStorageEntryValuePresent(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_SET_UP_IN_CURRENT_SESSION);e=e.filter(function(a){return a.optOutKey===g}).length>0;if(!e&&a!=null&&j==null){var k="true";c("promiseDone")(b.runInTransaction(function(a){return a.auto_restore_opt_out.upsert([g],{optOutKey:g,optOutValue:k})},"readwrite","background",void 0,f.id+":73"))}});return j.apply(this,arguments)}g["default"]=a}),98);
__d("mwEBSetBackupState",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.setBackupState;a=a.state;switch(a){case 1:break;case 2:b(2);break;case 3:b(3);break;case 4:b(4);break;case-1:b(-1);break;case 0:break}}f["default"]=a}),66);
__d("mwEBUpdateBackupsTable",["LSFactory","LSUpdateBackupsTableStoredProcedure","LSVec"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.backupIds,d=a.deviceIds,e=a.encryptionManagementDelegatorId,g=a.hasOtcEligibleDevices,h=a.isSuccess,i=a.isUserOptedOut,j=a.storage,k=a.virtualDevices;return j.runInTransaction(function(a){return c("LSUpdateBackupsTableStoredProcedure")(c("LSFactory")(a),{backupIds:b,backupMetadata:c("LSVec").ofArray([]),deviceIds:d,encryptionManagementDelegatorId:e,hasOtcEligibleDevices:g,isSuccess:h,isUserOptedOut:i,virtualDevices:k})},"readwrite",void 0,void 0,f.id+":48")}g["default"]=a}),98);
__d("mwProcessBackupIds",["I64","LSAuthorityLevel","LSIntEnum","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","QPLEvent","QPLUserFlow","WebSession"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="-1";function l(a){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,"EB_STATE_"+a+"."),d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent})}function m(a){var b=a.clientStateData;a=a.encryptedBackupData;a=a==null?void 0:a.backupId;if(a==null){l("NO_BACKUPS_PRESENT");return 2}if((h||(h=d("I64"))).to_string(a)===k){d("MWChatEncryptedBackupsLogging").endFailure({errorName:"FETCH_ERROR",event:d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent});return-1}if(b==null||!(h||(h=d("I64"))).equal(b.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))){l("DEVICE_NOT_ONBOARDED");return 4}if(!(h||(h=d("I64"))).equal(b.backupId,a)){l("DEVICE_NOT_ONBOARDED_BACKUP_ID_MISMATCH");return 4}l("DEVICE_ONBOARDED");return 3}function a(a){var b=a.clientStateData;a=a.encryptedBackupData;if(a==null)return 0;var e=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();c("QPLUserFlow").getActiveFlowIDs().includes((j||(j=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent))||c("QPLUserFlow").start(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:e,processBackupIdsVersion:"JS",sessionTabId:d("WebSession").getId()}}});if((h||(h=d("I64"))).equal(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC))){l("FETCH_IN_PROGRESS");return 1}else if((h||(h=d("I64"))).equal(a.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)))return m({clientStateData:b,encryptedBackupData:a});else{d("MWChatEncryptedBackupsLogging").endFailure({errorName:"FETCH_ERROR_WRONG_AUTHORITY_LEVEL",event:d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent});return-1}}g["default"]=a}),98);
__d("useMWChatDisplayEncryptedBackupsRestoreToast",["I64","LSEncryptedBackupsClientRestoreState","LSIntEnum","ReQL","ReQLSuspense","react","react-compiler-runtime","useMAWEncryptedBackupsRestoreToast","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useEffect,m=b.useState;function a(){var a=d("react-compiler-runtime").c(10),b=(h||(h=c("useReStore")))(),e;a[0]!==b.tables.encrypted_backups_client_restore_status?(e=function(){return d("ReQL").fromTableAscending(b.tables.encrypted_backups_client_restore_status)},a[0]=b.tables.encrypted_backups_client_restore_status,a[1]=e):e=a[1];var g;a[2]!==b?(g=[b],a[2]=b,a[3]=g):g=a[3];var i=d("ReQLSuspense").useArray(e,g,f.id+":27");e=c("useMAWEncryptedBackupsRestoreToast")();var j=e.showInProgressToast,k=e.showSuccessToast;g=m(!1);var o=g[0],p=g[1];a[4]!==o||a[5]!==i||a[6]!==j||a[7]!==k?(e=function(){var a=i.some(n);o&&!a?(p(!1),k()):!o&&a&&(p(!0),j())},g=[o,i,j,k],a[4]=o,a[5]=i,a[6]=j,a[7]=k,a[8]=e,a[9]=g):(e=a[8],g=a[9]);l(e,g)}function n(a){a=a.restoreStatus;return a!=null&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsClientRestoreState").RESTORE_IN_PROGRESS))}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsAutoRestore",["I64","LSAuthorityLevel","LSIntEnum","MWChatEncryptedBackupsAddDeviceWithEBKeys","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBEntrypointsKillswitch.enum","MWEBODSEntityName.enum","MWEBUseLocalStorage","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsSharedState","ReQL","ReQLSuspense","react","react-compiler-runtime","useLabyrinthLogging","useMWEBBackupState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useEffect,m=b.useRef,n=b.useState;function a(){var a=d("react-compiler-runtime").c(21),b=c("MWChatEncryptedBackupsQPLSource.enum").AUTO_RESTORE,e=n(!0),g=e[0],i=e[1],j=(h||(h=c("useReStore")))();e=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var k=e.startFlow,p;a[0]!==g||a[1]!==j?(e=function(){return g?d("ReQL").fromTableAscending(j.tables.secure_encrypted_backups_epochs):d("ReQL").empty()},p=[g,j],a[0]=g,a[1]=j,a[2]=e,a[3]=p):(e=a[2],p=a[3]);var q=d("ReQLSuspense").useFirst(e,p,f.id+":42");a[4]!==g||a[5]!==j?(e=function(){return g?d("ReQL").fromTableAscending(j.tables.secure_encrypted_backups_client_state).filter(o):d("ReQL").empty()},p=[g,j],a[4]=g,a[5]=j,a[6]=e,a[7]=p):(e=a[6],p=a[7]);var r=d("ReQLSuspense").useFirst(e,p,f.id+":49");a[8]===Symbol["for"]("react.memo_cache_sentinel")?(e={entrypoint:c("MWEBEntrypointsKillswitch.enum").AUTO_RESTORE},a[8]=e):e=a[8];var s=c("useMWEBBackupState")(e);a[9]!==g||a[10]!==j?(p=function(){return g?d("ReQL").fromTableAscending(j.tables.experiences_shared_state):d("ReQL").empty()},e=[g,j],a[9]=g,a[10]=j,a[11]=p,a[12]=e):(p=a[11],e=a[12]);var t=d("ReQLSuspense").useArray(p,e,f.id+":66"),u=m(!1);a[13]!==s||a[14]!==r||a[15]!==q||a[16]!==t||a[17]!==k||a[18]!==j?(p=function(){if(u.current||s===1||s===0)return;if(s===3){var a=r==null?void 0:r.deviceId,e=d("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:j,sharedStateTable:t,stateKey:"auto_restored"}),f=d("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:j,sharedStateTable:t,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}),g=d("MWEncryptedBackupsSharedState").getIsEntryPresentInSharedState({db:j,sharedStateTable:t,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_ONBOARDED_SUCCESSFULLY});e=e||f||g;f=d("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId();if(!e&&f!==""&&r!=null&&q!=null&&a!=null){d("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT);k({additionalAnnotations:{device_type:"auto_restore"},event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_AUTO_RESTORE_AUTH,source:b});g=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();k({additionalAnnotations:{eb_session_identifier:g,restore_upsell_first_impression_time:g},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:b});e={backupId:r.backupId,db:j,newDeviceRegistrationId:f,previousDeviceId:a};d("MWChatEncryptedBackupsAddDeviceWithEBKeys").addDeviceWithEBKeys(e)}}u.current=!0;i(!1)},e=[s,r,q,t,b,k,j],a[13]=s,a[14]=r,a[15]=q,a[16]=t,a[17]=k,a[18]=j,a[19]=p,a[20]=e):(p=a[19],e=a[20]);l(p,e)}function o(a){a=a.authorityLevel;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE))}g["default"]=a}),98);
__d("useMWEBListenForChangesToBackupStateXDevice",["I64","ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");var k=b.useEffect,l=b.useRef;function a(a){var b=d("react-compiler-runtime").c(8),e=(h||(h=c("useReStore")))(),g;b[0]!==e.tables.encrypted_backups_status_trigger?(g=function(){return d("ReQL").fromTableAscending(e.tables.encrypted_backups_status_trigger)},b[0]=e.tables.encrypted_backups_status_trigger,b[1]=g):g=b[1];var j;b[2]!==e?(j=[e],b[2]=e,b[3]=j):j=b[3];var m=d("ReQLSuspense").useFirst(g,j,f.id+":27"),n=l(null);b[4]!==m||b[5]!==a?(g=function(){m!=null&&n.current!==m.pk&&!(i||(i=d("I64"))).equal(m.pk,(i||(i=d("I64"))).of_float(0))&&(n.current=m.pk,a())},j=[m,a],b[4]=m,b[5]=a,b[6]=g,b[7]=j):(g=b[6],j=b[7]);k(g,j)}g["default"]=a}),98);
__d("useMWEBPropagateEbStateChangesThroughRelay",["CometRelay","FBLogger","MAWLoggerDeferred","Promise","ReQL","ReQLSuspense","promiseDone","react","requireDeferred","useMAWHasUserVisibleErrors","useMAWUnsupportedBrowserNUX","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][useMWEBPropagateEbStateChangesThroughRelay] update: ",""]);k=function(){return a};return a}e=j||d("react");var l=e.useCallback,m=e.useEffect,n=c("requireDeferred")("mwEBSetBackupState").__setRef("useMWEBPropagateEbStateChangesThroughRelay"),o=c("requireDeferred")("mwProcessBackupIds").__setRef("useMWEBPropagateEbStateChangesThroughRelay");function a(a){var e=a.listenForChangesToBackupState,g=(i||(i=c("useReStore")))(),j=d("CometRelay").useRelayEnvironment(),p=d("ReQLSuspense").useFirst(function(){return e?d("ReQL").fromTableAscending(g.tables.encrypted_backups):d("ReQL").empty()},[g,e],f.id+":42"),q=d("ReQLSuspense").useFirst(function(){return e?d("ReQL").fromTableAscending(g.tables.secure_encrypted_backups_client_state):d("ReQL").empty()},[g,e],f.id+":49"),r=l(function(a){void d("MAWLoggerDeferred").LOG(k(),a),d("CometRelay").commitLocalUpdate(j,function(b){b=b.getRoot().getLinkedRecord("viewer");if(b==null){c("FBLogger")("labyrinth_web").mustfix("[labyrinth][backup_state] A viewer record does not exist when propagating EB state.");return}b.setValue(a,"backup_state")})},[j]);a=d("useMAWUnsupportedBrowserNUX").useMAWUnsupportedBrowserNUX();a=a.shouldHideEBFlow;var s=c("useMAWHasUserVisibleErrors")(),t=a||s;m(function(){(p!=null||q!=null)&&c("promiseDone")((h||(h=b("Promise"))).all([o.load(),n.load()]),function(a){var b=a[0];a=a[1];b=t?0:b({clientStateData:q,encryptedBackupData:p});a({setBackupState:r,state:b})})},[q,g,p,j,t,r])}g["default"]=a}),98);
__d("useMWEncryptedBackupsFetchBackupIdsV2ImplQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7143386292434169"}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2ImplQuery.graphql",["useMWEncryptedBackupsFetchBackupIdsV2ImplQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEncryptedBackupsFetchBackupIdsV2ImplQuery",selections:[{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsFetchBackupIdsV2Impl_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEncryptedBackupsFetchBackupIdsV2ImplQuery",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[a],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null},a],storageKey:null}]},params:{id:b("useMWEncryptedBackupsFetchBackupIdsV2ImplQuery_facebookRelayOperation"),metadata:{},name:"useMWEncryptedBackupsFetchBackupIdsV2ImplQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2Impl_query.graphql",["useMWEncryptedBackupsFetchBackupIdsV2ImplQuery.graphql"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:b("useMWEncryptedBackupsFetchBackupIdsV2ImplQuery.graphql")}},name:"useMWEncryptedBackupsFetchBackupIdsV2Impl_query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[a],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();e.exports=a}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7376203159158541"}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2Query.graphql",["useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEncryptedBackupsFetchBackupIdsV2Query",selections:[{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsFetchBackupIdsV2Impl_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEncryptedBackupsFetchBackupIdsV2Query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"backup_tenancy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_user_opted_out",storageKey:null},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},{alias:null,args:null,kind:"ScalarField",name:"encryption_management_delegator_id",storageKey:null},{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_created_on",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"migration_status",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesConnection",kind:"LinkedField",name:"devices",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupDevicesEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEBDevice",kind:"LinkedField",name:"node",plural:!1,selections:[a],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEBUserPreferences",kind:"LinkedField",name:"xfb_eb_user_preferences",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"onboarding_decision",storageKey:null},a],storageKey:null}]},params:{id:b("useMWEncryptedBackupsFetchBackupIdsV2Query_facebookRelayOperation"),metadata:{},name:"useMWEncryptedBackupsFetchBackupIdsV2Query",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("useMWEncryptedBackupsFetchBackupIdsV2",["Base64Utils","CometRelay","FBLogger","I64","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsOnboardingDecision","LSEncryptedBackupsVirtualDeviceType","LSIntEnum","LSShape","LSVec","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsListenForChangesToBackupStateInitPath","Promise","QPLEvent","QPLUserFlow","WebSession","cr:6666","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore","useMWEBListenForChangesToBackupStateXDevice","useMWEBPropagateEbStateChangesThroughRelay","useMWEncryptedBackupsFetchBackupIdsV2Impl_query.graphql","useMWEncryptedBackupsFetchBackupIdsV2Query.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n;e=k||d("react");var o=e.useEffect,p=e.useRef,q=e.useState,r=c("requireDeferred")("mwEBUpdateBackupsTable").__setRef("useMWEncryptedBackupsFetchBackupIdsV2");function s(a){if(a!=null){a=a;a=c("LSEncryptedBackupsOnboardingDecision")[a];return a}return void 0}function t(a){if(a!=null){a=a;a=c("LSEncryptedBackupsBackupTenancy")[a];return(l||(l=d("LSIntEnum"))).ofNumber(a)}return void 0}function u(a){var e=a.data,f=a.dbPromise,g=a.isInitalLoad,h=a.setListenForChangesToBackupState,i=e.xfb_backup,k=i==null?void 0:i.id;if(i!=null&&k!=null){g.current===!0&&b("cr:6666")!=null&&c("promiseDone")(b("cr:6666")(f));var m=!1;(i==null?void 0:i.has_otc_eligible_devices)!=null?m=i==null?void 0:i.has_otc_eligible_devices:c("FBLogger")("labyrinth_web").mustfix("failed to retrieve has_otc_eligible_devices. defaulting to false");var o=c("LSVec").ofArray([d("LSShape").ofRecord({backup_id:(n||(n=d("I64"))).of_string(k),backup_tenancy:t(i.backup_tenancy)})]),p=[];i.virtual_devices.forEach(function(a){var b,e=a.client_generated_id;if(k==null||e==null||a.device_type==null){c("FBLogger")("labyrinth_web").warn("Invalid virtual device fetched in fetchBackupsIdsV2.");return}var f="REQUIRES_MIGRATION";f=a.migration_status===f;var g=a.device_type;g=c("LSEncryptedBackupsVirtualDeviceType")[g];p.push(d("LSShape").ofRecord({backup_id:(n||(n=d("I64"))).of_string(k),virtual_device_ids:c("LSVec").ofArray([d("LSShape").ofRecord({virtual_device_id:d("Base64Utils").toArrayBuffer(e)})]),virtual_devices:c("LSVec").ofArray([d("LSShape").ofRecord({creation_time:(b=a.creation_time)!=null?b:void 0,device_created_on:(b=a.device_created_on)!=null?b:void 0,requires_hsm_migration:f,virtual_device_id:d("Base64Utils").toArrayBuffer(e),virtual_device_type:(l||(l=d("LSIntEnum"))).ofNumber(g)})])}))});var q=[];(a=i.devices)==null?void 0:a.edges.forEach(function(a){var b;if(((b=a.node)==null?void 0:b.id)==null)return;q.push(d("LSShape").ofRecord({device_id:(n||(n=d("I64"))).of_string((b=a.node)==null?void 0:b.id)}))});var u=i.encryption_management_delegator_id!=null?(n||(n=d("I64"))).of_string(i.encryption_management_delegator_id):void 0;c("promiseDone")((j||(j=b("Promise"))).all([r.load(),f]),function(a){var b=a[0],d=a[1];c("promiseDone")(b({backupIds:o,deviceIds:c("LSVec").ofArray(q),encryptionManagementDelegatorId:u,hasOtcEligibleDevices:m,isSuccess:!0,isUserOptedOut:(a=i.is_user_opted_out)!=null?a:void 0,storage:d,virtualDevices:c("LSVec").ofArray(p)}),function(){h(!0),g.current===!0&&(g.current=!1,c("MWEncryptedBackupsListenForChangesToBackupStateInitPath").preloadEBData(d))})})}else{var v=s((a=e.xfb_eb_user_preferences)==null?void 0:a.onboarding_decision)===c("LSEncryptedBackupsOnboardingDecision").STORE_ON_DEVICE_ONLY;c("promiseDone")((j||(j=b("Promise"))).all([r.load(),f]),function(a){var b=a[0];a=a[1];c("promiseDone")(b({backupIds:c("LSVec").ofArray([]),deviceIds:c("LSVec").ofArray([]),hasOtcEligibleDevices:!1,isSuccess:!0,isUserOptedOut:v,storage:a,virtualDevices:c("LSVec").ofArray([])}),function(){h(!0)})})}}function v(a){var e=d("react-compiler-runtime").c(9),f=c("useAsyncReStore")(),g=p(!0),i=p(!1),j=q(!1),k=j[0],l=j[1];j=d("CometRelay").useRefetchableFragment(h!==void 0?h:h=b("useMWEncryptedBackupsFetchBackupIdsV2Impl_query.graphql"),a);var n=j[0],r=j[1];e[0]!==k?(a={listenForChangesToBackupState:k},e[0]=k,e[1]=a):a=e[1];c("useMWEBPropagateEbStateChangesThroughRelay")(a);e[2]!==n||e[3]!==r?(j=function(){var a=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();c("QPLUserFlow").getActiveFlowIDs().includes((m||(m=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))||c("QPLUserFlow").start(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:a,fetchBackupIdsVersion:"GQL",sessionTabId:d("WebSession").getId()}}});r({},{fetchPolicy:"network-only",onComplete:function(a){i.current=!1;if(c("QPLUserFlow").getActiveFlowIDs().includes((m||(m=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent)))if(a!=null)d("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{error:a.message,error_stack:a.stack}},errorName:"fetch_backup_ids_error",event:d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent});else{d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{isUserOptedOut:(a=n.xfb_backup)==null?void 0:a.is_user_opted_out},string:{backup_id:(a=(a=n.xfb_backup)==null?void 0:a.id)!=null?a:"null"}},event:d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent})}}})},e[2]=n,e[3]=r,e[4]=j):j=e[4];k=j;c("useMWEBListenForChangesToBackupStateXDevice")(k);e[5]!==n||e[6]!==f?(a=function(){if(i.current===!0)return;i.current=!0;u({data:n,dbPromise:f,isInitalLoad:g,setListenForChangesToBackupState:l})},j=[n,f],e[5]=n,e[6]=f,e[7]=a,e[8]=j):(a=e[7],j=e[8]);o(a,j)}function a(){var a=d("CometRelay").useLazyLoadQuery(i!==void 0?i:i=b("useMWEncryptedBackupsFetchBackupIdsV2Query.graphql"),{});v(a)}g["default"]=a}),98);